(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{205:function(e,t,n){e.exports=n.p+"static/media/ogImage.0619e300.png"},206:function(e,t,n){e.exports=n.p+"static/media/icon.68e274b2.png"},207:function(e,t,n){e.exports=n.p+"static/media/bridge.e53bced3.png"},208:function(e,t,n){e.exports=n.p+"static/media/airBridge.7d581a65.png"},209:function(e,t,n){e.exports=n.p+"static/media/fixation.dd261ca6.svg"},235:function(e,t,n){e.exports=n(417)},24:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"str",function(){return h}),n.d(t,"UI",function(){return y}),n.d(t,"canvas",function(){return b}),n.d(t,"img",function(){return v});var o=n(141),r=n.n(o),a=n(205),i=n.n(a),c=n(206),s=n.n(c),l=n(207),d=n.n(l),u=n(208),p=n.n(u),m=n(209),f=n.n(m),h={url:"https://web-usov.github.io/truss",title:"Truss - \u0444\u0435\u0440\u043c\u0430 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e",description:"\u0424\u0435\u0440\u043c\u0430 (farm \u0438\u043b\u0438 truss) \u2014 \u0441\u0442\u0435\u0440\u0436\u043d\u0435\u0432\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0432 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0435, \u043e\u0441\u0442\u0430\u044e\u0449\u0430\u044f\u0441\u044f \u0433\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435\u0438\u0437\u043c\u0435\u043d\u044f\u0435\u043c\u043e\u0439 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043c\u0435\u043d\u044b \u0435\u0451 \u0436\u0451\u0441\u0442\u043a\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 \u0448\u0430\u0440\u043d\u0438\u0440\u043d\u044b\u043c\u0438.",favicon:r.a.resolve(e,"favicon.ico")},y={cellSize:45,MMinCell:200,koefOfNewPos:100,nodeSize:0,beamSize:0,koefOnGrid:0,sidebarWidth:240};y.nodeSize=y.cellSize/3,y.beamSize=y.cellSize/7,y.koefOnGrid=y.MMinCell/y.cellSize;var b={width:2500,height:1500},v={ogImage:i.a,bridgeIcon_1:s.a,bridgeIcon_2:d.a,airBridge:p.a,FixationIcon:f.a}}.call(this,"/")},261:function(e,t){},262:function(e,t){},263:function(e,t){},267:function(e,t){},269:function(e,t){},304:function(e,t){},305:function(e,t){},416:function(e,t,n){},417:function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"UIModes",function(){return a}),n.d(o,"theme",function(){return y}),n.d(o,"getNodeColor",function(){return b}),n.d(o,"getNodeStorkeColor",function(){return v}),n.d(o,"getNodeStorkeWidth",function(){return g}),n.d(o,"getBeamColor",function(){return O}),n.d(o,"nodeMouseEnter",function(){return E}),n.d(o,"nodeMouseLeave",function(){return k}),n.d(o,"beamMouseEnter",function(){return j}),n.d(o,"beamMouseLeave",function(){return C});var r={};n.r(r),n.d(r,"mainBackGround",function(){return w}),n.d(r,"node",function(){return N}),n.d(r,"staticNode",function(){return x}),n.d(r,"fixedNode",function(){return S}),n.d(r,"beam",function(){return _});var a,i=n(0),c=n.n(i),s=n(22),l=n.n(s),d=n(49),u=(Object(d.a)(),n(19)),p=n(10),m=n(24),f=n(223);!function(e){e[e.none=0]="none",e[e.move=1]="move",e[e.addNode=2]="addNode",e[e.addBeam=3]="addBeam",e[e.addBeamStart=4]="addBeamStart",e[e.delete=5]="delete"}(a||(a={}));var h,y=Object(f.a)({palette:{primary:{dark:"#0A4467",main:"#1e779e",light:"#51A8D6"},secondary:{dark:"#a83e19",main:"#f15a24",light:"#F39B7C"},background:{default:"linear-gradient(35deg, #6863bf 0%, #067d93 50%, #e68a68 100%)"}},overrides:{MuiTooltip:{tooltip:{fontSize:14}}}}),b=function(e){return e.isStatic?e.fixation?r.fixedNode:r.staticNode:r.node},v=function(e,t){switch(t){case a.move:return e.isStatic?y.palette.secondary.dark:y.palette.primary.light;case a.addBeam:case a.addBeamStart:return y.palette.primary.light;default:return y.palette.secondary.main}},g=function(e,t){switch(t){case a.move:return e.isStatic?0:2;case a.addBeam:case a.addBeamStart:return 2;default:return 0}},O=function(e){return r.beam},E=function(e,t,n){var o=e.target.getStage();switch(n){case a.delete:if(t.isStatic){o.container().style.cursor="default";break}o.container().style.cursor="pointer";break;case a.none:o.container().style.cursor="pointer";break;case a.addBeam:case a.addBeamStart:o.container().style.cursor="crosshair";break;case a.move:if(t.isStatic){o.container().style.cursor="default";break}o.container().style.cursor="move"}},k=function(e){var t=e.target.getStage();t&&(t.container().style.cursor="default")},j=function(e,t,n){var o=e.target.getStage();switch(n){case a.delete:case a.none:o.container().style.cursor="pointer"}},C=function(e){var t=e.target.getStage();t&&(t.container().style.cursor="default")},w="#09B4D3",N=y.palette.secondary.main,x=y.palette.secondary.dark,S=y.palette.secondary.dark,_=y.palette.secondary.light,I=n(483),B=function(){function e(){Object(u.a)(this,e)}return Object(p.a)(e,null,[{key:"angleBePoints",value:function(e,t,n,o){return Math.atan2(-t+o,-e+n)/Math.PI}},{key:"lengthBePoints",value:function(e,t,n,o){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-o,2))}},{key:"cellX",value:function(e){return Math.round(e/m.UI.cellSize)*m.UI.cellSize}},{key:"cellY",value:function(e){return Math.round(e/m.UI.cellSize)*m.UI.cellSize}},{key:"signum",value:function(e){return e>0?1:e<0?-1:0}},{key:"multMatrxi",value:function(e,t){var n=e.length,o=t.length,r=e[0].length,a=t[0].length,i=[];if(r!==o)throw new Error("\u0420\u0430\u0437\u043c\u0435\u0440\u043d\u043e\u0441\u0442\u044c \u043c\u0430\u0442\u0440\u0438\u0446 \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0435\u0440\u0435\u0443\u043c\u043d\u043e\u0436\u0438\u0442\u044c \u0438\u0445");for(var c=0;c<n;c++){for(var s=[],l=0;l<a;l++)s.push(0);i.push(s)}for(var d=0;d<a;d++)for(var u=0;u<n;u++){for(var p=0,m=0;m<o;m++)p+=e[u][m]+t[m][d];i[u][d]=p}return i}},{key:"multMatrxiV2",value:function(e,t){var n=[];try{n=I.b(e,t)}catch(o){console.error("multMatrxiV2:",o)}return n}},{key:"getDetMatrix",value:function(e){return I.a(e)}}]),e}(),D=n(69),M=n(65),U=n(28),P=n(26),T=n(27),F=n(211),z=n.n(F),A=n(481),L=n(482),X=n(487),Y=n(6),V=n(117),W=n(442),G="/",R="/app",H=n(424),K=Object(H.a)(function(e){return Object(X.a)({root:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},logo:{width:"20%",height:"20%"},title:{padding:40},descripton:{padding:40},btn:{}})})(function(e){var t=e.classes;return i.createElement("header",{className:t.root},i.createElement("img",{src:m.img.bridgeIcon_2,alt:"logo",className:t.logo}),i.createElement(V.a,{variant:"h3",className:t.title},m.str.title),i.createElement(V.a,{variant:"subtitle1",align:"center",className:t.descripton},m.str.description),i.createElement(W.a,{component:D.b,to:R,variant:"contained",size:"large",color:"secondary"},"\u041f\u043e\u0435\u0445\u0430\u043b\u0438"))}),J=function(e){function t(){return Object(u.a)(this,t),Object(U.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.classes;return i.createElement("div",{className:e.root},i.createElement(K,null))}}]),t}(i.Component),q=Object(Y.a)(function(e){return Object(X.a)({root:{width:"100%",minHeight:"100%",display:"block",background:e.palette.background.default,padding:e.spacing(4)}})})(J),$=n(33),Q=n.n($),Z=n(55),ee=n(54),te=n(46);!function(e){e[e.None=0]="None",e[e.X=1]="X",e[e.Y=2]="Y",e[e.XY=3]="XY",e[e.YX=3]="YX"}(h||(h={}));var ne,oe,re,ae,ie,ce,se,le,de,ue,pe=n(70),me=n(41),fe=n(7),he=(n(94),n(4)),ye=n(17),be=n(216),ve=n.n(be),ge=(ne=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.coord,o=t.id,r=t.name,a=t.dCoord;Object(u.a)(this,e),this._id=void 0,Object(me.a)(this,"_coord",oe,this),Object(me.a)(this,"_name",re,this),Object(me.a)(this,"_dCoord",ae,this),this._id=o||ve()(),this._name=r||this._id,this._coord=n||{x:0,y:0},this._dCoord=a||{x:0,y:0}}return Object(p.a)(e,[{key:"id",get:function(){return this._id}},{key:"coord",get:function(){return this._coord}},{key:"name",get:function(){return this._name},set:function(e){this._name=e}},{key:"dCoord",get:function(){return this._dCoord},set:function(e){this._dCoord=e}}]),Object(p.a)(e,[{key:"moveTo",value:function(e,t){this._coord.x=e,this._coord.y=t}}]),e}(),oe=Object(fe.a)(ne.prototype,"_coord",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ne.prototype,"coord",[he.e],Object.getOwnPropertyDescriptor(ne.prototype,"coord"),ne.prototype),re=Object(fe.a)(ne.prototype,"_name",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ne.prototype,"name",[he.e],Object.getOwnPropertyDescriptor(ne.prototype,"name"),ne.prototype),ae=Object(fe.a)(ne.prototype,"_dCoord",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ne.prototype,"dCoord",[he.e],Object.getOwnPropertyDescriptor(ne.prototype,"dCoord"),ne.prototype),Object(fe.a)(ne.prototype,"moveTo",[he.d],Object.getOwnPropertyDescriptor(ne.prototype,"moveTo"),ne.prototype),ne),Oe=(ie=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(u.a)(this,t),(e=Object(U.a)(this,Object(P.a)(t).call(this,n)))._entity=void 0,Object(me.a)(e,"_startConnectedNode",ce,Object(ye.a)(e)),Object(me.a)(e,"_endConnectedNode",se,Object(ye.a)(e)),Object(me.a)(e,"_endCoord",le,Object(ye.a)(e)),Object(me.a)(e,"_startForce",de,Object(ye.a)(e)),Object(me.a)(e,"_endForce",ue,Object(ye.a)(e));var o=n.dCoord,r=n.startConnectedNode,a=n.endConnectedNode,i=n.coord,c=n.endCoord,s=n.startForce,l=n.endForce;return e._entity=Object(ee.a)({},Object(ye.a)(e),{coord:i||{x:0,y:0},dCoord:o||{x:0,y:0}}),e._startConnectedNode=r||null,e._endConnectedNode=a||null,e._endCoord=c||e.coord,e._startForce=s||0,e._endForce=l||0,e}return Object(T.a)(t,e),Object(p.a)(t,[{key:"startConnectedNode",get:function(){return this._startConnectedNode}},{key:"endConnectedNode",get:function(){return this._endConnectedNode}},{key:"coord",get:function(){return this._startConnectedNode?this._startConnectedNode.coord:this._entity.coord}},{key:"endCoord",get:function(){return this._endConnectedNode?this._endConnectedNode.coord:this._endCoord}},{key:"dCoord",get:function(){return this._startConnectedNode?this._startConnectedNode.dCoord:this._entity.dCoord}},{key:"dEndCoord",get:function(){return this._endConnectedNode?this._endConnectedNode.dCoord:this._entity.dCoord}},{key:"startForce",get:function(){return this._startForce},set:function(e){this._startForce=e}},{key:"endForce",get:function(){return this._endForce},set:function(e){this._endForce=e}},{key:"name",get:function(){if(this._startConnectedNode&&this._endConnectedNode){var e=this._startConnectedNode.name,t=this._endConnectedNode.name;return e<t?"".concat(e," - ").concat(t):"".concat(t," - ").concat(e)}return"..."}}]),Object(p.a)(t,[{key:"connectStartNode",value:function(e){this._startConnectedNode=e}},{key:"connectEndNode",value:function(e){this._endConnectedNode=e}},{key:"removeStartNode",value:function(){this._startConnectedNode=null}},{key:"removeEndNode",value:function(){this._endConnectedNode=null}},{key:"moveTo",value:function(e,t){this._startConnectedNode||(this.coord.x=e,this.coord.y=t)}},{key:"moveEndTo",value:function(e,t){this._endConnectedNode||(this._endCoord.x=e,this._endCoord.y=t)}},{key:"length",get:function(){var e=B.lengthBePoints(this.coord.x,this.coord.y,this.endCoord.x,this.endCoord.y);return Math.round(e)}}]),t}(ge),ce=Object(fe.a)(ie.prototype,"_startConnectedNode",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ie.prototype,"startConnectedNode",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"startConnectedNode"),ie.prototype),se=Object(fe.a)(ie.prototype,"_endConnectedNode",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ie.prototype,"endConnectedNode",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"endConnectedNode"),ie.prototype),Object(fe.a)(ie.prototype,"coord",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"coord"),ie.prototype),le=Object(fe.a)(ie.prototype,"_endCoord",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ie.prototype,"endCoord",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"endCoord"),ie.prototype),Object(fe.a)(ie.prototype,"dCoord",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"dCoord"),ie.prototype),Object(fe.a)(ie.prototype,"dEndCoord",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"dEndCoord"),ie.prototype),de=Object(fe.a)(ie.prototype,"_startForce",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ie.prototype,"startForce",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"startForce"),ie.prototype),ue=Object(fe.a)(ie.prototype,"_endForce",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ie.prototype,"endForce",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"endForce"),ie.prototype),Object(fe.a)(ie.prototype,"name",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"name"),ie.prototype),Object(fe.a)(ie.prototype,"connectStartNode",[he.d],Object.getOwnPropertyDescriptor(ie.prototype,"connectStartNode"),ie.prototype),Object(fe.a)(ie.prototype,"connectEndNode",[he.d],Object.getOwnPropertyDescriptor(ie.prototype,"connectEndNode"),ie.prototype),Object(fe.a)(ie.prototype,"removeStartNode",[he.d],Object.getOwnPropertyDescriptor(ie.prototype,"removeStartNode"),ie.prototype),Object(fe.a)(ie.prototype,"removeEndNode",[he.d],Object.getOwnPropertyDescriptor(ie.prototype,"removeEndNode"),ie.prototype),Object(fe.a)(ie.prototype,"moveTo",[he.d],Object.getOwnPropertyDescriptor(ie.prototype,"moveTo"),ie.prototype),Object(fe.a)(ie.prototype,"moveEndTo",[he.d],Object.getOwnPropertyDescriptor(ie.prototype,"moveEndTo"),ie.prototype),Object(fe.a)(ie.prototype,"length",[he.e],Object.getOwnPropertyDescriptor(ie.prototype,"length"),ie.prototype),ie),Ee=function(){function e(){Object(u.a)(this,e)}return Object(p.a)(e,null,[{key:"init",value:function(){var e=Object(Z.a)(Q.a.mark(function e(t,n,o,r,a){var i,c,s,l,d,u,p,m,f,h,y,b,v,g,O,E,k,j,C=this,w=arguments;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=w.length>5&&void 0!==w[5]?w[5]:{},c=i.area||225,s=i.modUpr||72e3,l=[],d=[],u=[],p=[],m=[],f=[],h=[],y=[],b=[],v=[],g=[],r.forEach(function(e,o){l.push(C.Kmest_i(c,s,a[o]));var i=C.Lambda_i(t[r[o].x],t[r[o].y],a[o]);d.push(i),u.push([[i.x,i.y,0,0],[0,0,i.x,i.y]]),p.push(C.Kobs_i(c,s,a[o],d[o])),m.push(C.IndexV_i(n[r[o].x],n[r[o].y]))}),O=r.length,E=n.length,k=Math.max.apply(Math,Object(pe.a)(n.map(function(e){var t=e.x,n=e.y;return Math.max(t,n)}))),f=this.K(k,m,p),!(B.getDetMatrix(f)<1e3)){e.next=21;break}throw Error("\u0414\u0430\u043d\u043d\u0430\u044f \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f (\u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043c\u0430\u044f) \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u043c");case 21:for(h=this.SquareRoot(f,o),y=this.Vi(n,h),b=this.Vij(r,y),j=0;j<O;j++)v.push(this.V_i(u[j],b[j])),g.push(this.P_i(l[j],v[j]));return this.farmCalcDebug&&(console.log("NodeCoord, LinkNodes, NodeV",t,r,n),console.log("Kobs, Kmest",p,l),console.log("Lambda0, Lambda,",d,u),console.log("IndexV",m),console.log("N_Link, N_Nodes, N_DOF",O,E,k),console.log("K, Force",f,o),console.log("Va",h),console.log("Vi",y),console.log("Vij",b),console.log("V",v),console.log("P",g)),e.abrupt("return",{P:g,LinkNodes:r,Vi:y});case 27:case"end":return e.stop()}},e,this)}));return function(t,n,o,r,a){return e.apply(this,arguments)}}()},{key:"Kmest_i",value:function(e,t,n){var o=e*t/n,r=[];return r.push([o,-o]),r.push([-o,o]),r}},{key:"Lambda_i",value:function(e,t,n){return{x:(t.x-e.x)/n,y:(t.y-e.y)/-n}}},{key:"Kobs_i",value:function(e,t,n,o){for(var r=e*t/n,a=[{x:o.x*o.x,y:o.x*o.y},{x:o.x*o.y,y:o.y*o.y}],i=[{x:-o.x*o.x,y:-o.x*o.y},{x:-o.x*o.y,y:-o.y*o.y}],c=[],s=[],l=0;l<2;l++)c.push({x1:a[l].x,y1:a[l].y,x2:i[l].x,y2:i[l].y}),s.push({x1:i[l].x,y1:i[l].y,x2:a[l].x,y2:a[l].y});return Array.prototype.concat(c,s).map(function(e){var t=e.x1,n=e.y1,o=e.x2,a=e.y2;return[t*r,n*r,o*r,a*r]})}},{key:"IndexV_i",value:function(e,t){return[e.x,e.y,t.x,t.y]}},{key:"K",value:function(e,t,n){for(var o=[],r=0;r<e;r++){for(var a=[],i=0;i<e;i++)a.push(0);o.push(a)}for(var c=0;c<t.length;c++)for(var s=0;s<4;s++){var l=t[c][s];if(0!==l)for(var d=0;d<4;d++){var u=t[c][d];0!==u&&(o[u-1][l-1]=o[u-1][l-1]+n[c][s][d])}}return o}},{key:"SquareRoot",value:function(e,t){if(e.length!==t.length)throw Error("SquareRoot - \u041c\u0430\u0441\u0441\u0438\u0432\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e\u0439 \u0434\u043b\u0438\u043d\u044b");for(var n=t.length,o=[],r=[],a=[],i=[],c=[],s=[],l=0;l<n+1;l++){for(var d=[],u=0;u<n;u++)d.push(0);c.push(d),o.push(d),r.push(0),a.push(0),i.push(0),s.push(0)}for(var p=1;p<=n;p++){for(var m=0;m<=n;m++)o[p][m]=e[p-1][m-1];r[p]=t[p-1]}i[1]=B.signum(o[1][1]),c[1][1]=Math.sqrt(Math.abs(o[1][1]));for(var f=2;f<=n;f++)c[1][f]=o[1][f]/(c[1][1]*i[1]);for(var h=2;h<=n;h++){for(var y=0,b=1;b<=h-1;b++)y+=c[b][h]*c[b][h]*i[b];i[h]=B.signum(o[h][h]-y),c[h][h]=Math.sqrt(Math.abs(o[h][h]-y));for(var v=1/(c[h][h]*i[h]),g=h+1;g<=n;g++){for(var O=0,E=1;E<=h-1;E++)O+=c[E][h]*i[E]*c[E][g];c[h][g]=v*(o[h][g]-O)}}s[1]=r[1]/(c[1][1]*i[1]);for(var k=2;k<=n;k++){for(var j=0,C=1;C<=k-1;C++)j+=c[C][k]*i[C]*s[C];s[k]=(r[k]-j)/(c[k][k]*i[k])}a[n]=s[n]/c[n][n];for(var w=n-1;w>=1;w--){for(var N=0,x=w+1;x<=n;x++)N+=c[w][x]*a[x];a[w]=(s[w]-N)/c[w][w]}var S=[];return a.forEach(function(e,t){0!==t&&S.push(e)}),S}},{key:"Vi",value:function(e,t){for(var n=[],o=0;o<e.length;o++){var r=Object(ee.a)({},e[o]);r.x=0===r.x?0:t[r.x-1],r.y=0===r.y?0:t[r.y-1],n.push(r)}return n}},{key:"Vij",value:function(e,t){for(var n=[],o=0;o<e.length;o++){var r=e[o].x,a=e[o].y;n.push([[t[r].x],[t[r].y],[t[a].x],[t[a].y]])}return n}},{key:"V_i",value:function(e,t){return B.multMatrxiV2(e,t)}},{key:"P_i",value:function(e,t){return B.multMatrxiV2(e,t)}}]),e}();Ee.farmCalcDebug=!0;var ke,je,Ce,we,Ne,xe,Se=(ke=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(u.a)(this,t),e=Object(U.a)(this,Object(P.a)(t).call(this,n)),Object(me.a)(e,"_beamsID",je,Object(ye.a)(e)),e._forceX=void 0,e._forceY=void 0,e._isStatic=void 0,e._fixation=void 0;var o=n.beamsID,r=n.forceX,a=n.forceY,i=n.isStatic,c=n.fixation;return e._beamsID=o||[],e._forceX=r||0,e._forceY=a||0,e._isStatic=i||!1,e._fixation=c||h.None,e}return Object(T.a)(t,e),Object(p.a)(t,[{key:"beams",get:function(){return this._beamsID}},{key:"forceX",get:function(){return this._forceX},set:function(e){this._forceX=e}},{key:"forceY",get:function(){return this._forceY},set:function(e){this._forceY=e}},{key:"isStatic",get:function(){return this._isStatic}},{key:"fixation",get:function(){return this._fixation}}]),Object(p.a)(t,[{key:"conncetBeam",value:function(e){return!this._beamsID.find(function(t){return t===e})&&(this._beamsID.push(e),!0)}},{key:"removeBeam",value:function(e){var t=!1;return this._beamsID=this._beamsID.filter(function(n){var o=n!==e;return o||(t=!0),o}),t}}]),t}(ge),je=Object(fe.a)(ke.prototype,"_beamsID",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(ke.prototype,"beams",[he.e],Object.getOwnPropertyDescriptor(ke.prototype,"beams"),ke.prototype),Object(fe.a)(ke.prototype,"conncetBeam",[he.d],Object.getOwnPropertyDescriptor(ke.prototype,"conncetBeam"),ke.prototype),Object(fe.a)(ke.prototype,"removeBeam",[he.d],Object.getOwnPropertyDescriptor(ke.prototype,"removeBeam"),ke.prototype),ke),_e=new(Ce=function(){function e(){Object(u.a)(this,e),Object(me.a)(this,"_nodes",we,this),Object(me.a)(this,"_beams",Ne,this),Object(me.a)(this,"_calcData",xe,this),this.sortByName=function(e,t){if(e instanceof Oe){var n=e.name.split(" - "),o=Number(n[0]+n[1]),r=t.name.split(" - ");return o>Number(r[0]+r[1])?1:-1}return e.name>t.name?1:-1},this._nodes=new Map,this._beams=new Map,this.connectBeamToStartNode=this.connectBeamToStartNode.bind(this)}return Object(p.a)(e,[{key:"nodes",get:function(){return this._nodes}},{key:"nodesArray",get:function(){return Array.from(this._nodes.values())}},{key:"beams",get:function(){return this._beams}},{key:"beamsArray",get:function(){return Array.from(this._beams.values())}},{key:"calcData",get:function(){return this._calcData}}]),Object(p.a)(e,[{key:"addNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._nodes.size>12)throw new Error("\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u043e \u0447\u0438\u0441\u043b\u043e \u0443\u0437\u043b\u043e\u0432");var t=!0,n=!1,o=void 0;try{for(var r,a=this._nodes.values()[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){if(r.value.coord===e.coord)return}}catch(s){n=!0,o=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}var i=this._nodes.size+1+"",c=new Se(Object(ee.a)({},e,{name:i}));return this._nodes.set(c.id,c),c}},{key:"moveNode",value:function(e,t,n){var o=this._nodes.get(e);if(!o)throw new Error("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0443\u0437\u0435\u043b");if(!o.isStatic&&o.fixation===h.None){var r=!0,a=!1,i=void 0;try{for(var c,s=this._nodes.values()[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var l=c.value;if(l.coord.x===t&&l.coord.y===n)return}}catch(d){a=!0,i=d}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}o.moveTo(t,n)}}},{key:"setNodes",value:function(e){this._nodes=new Map(e)}},{key:"sortNodesByCoord",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.nodesArray).sort(function(e,t){return e.coord.y<t.coord.y?-1:e.coord.y===t.coord.y&&e.coord.x<t.coord.x?-1:1}).forEach(function(e,t){e.name=(t+1).toString()})}},{key:"addBeam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._beams.size>36)throw new Error("\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u043e \u0447\u0438\u0441\u043b\u043e \u0441\u0442\u0435\u0440\u0436\u043d\u0435\u0439");var t=new Oe(e);return this._beams.set(t.id,t),t}},{key:"moveEndBeamWhileDraving",value:function(e,t,n){var o=this._beams.get(e);if(!o)throw new Error("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0441\u0442\u0435\u0440\u0436\u0435\u043d\u044c");if(o.endConnectedNode)throw new Error("\u0421\u0442\u0435\u0440\u0436\u0435\u043d\u044c \u043d\u0435\u043b\u044c\u0437\u044f \u043f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c - \u043e\u043d \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d \u043a \u0443\u0437\u043b\u0443");o.moveEndTo(t,n)}},{key:"connectBeamToStartNode",value:function(e,t){var n=this._beams.get(t),o=this._nodes.get(e);if(!n||!o)throw new Error("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b");return n.connectStartNode(o),o.conncetBeam(n.id),n}},{key:"connectBeamToEndNode",value:function(e,t){var n=this._beams.get(t),o=this._nodes.get(e);if(!n||!o)throw new Error("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u044b");var r=!0,a=!1,i=void 0;try{for(var c,s=this._beams.values()[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var l=c.value;if(this._findOldBeamByNode(o,n,l))return}}catch(d){a=!0,i=d}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n.connectEndNode(o),o.conncetBeam(n.id),n}},{key:"setBeams",value:function(e){this._beams=new Map(e)}},{key:"_findOldBeamByNode",value:function(e,t,n){return n.startConnectedNode===t.startConnectedNode&&n.endConnectedNode===e||n.startConnectedNode===e&&n.endConnectedNode===t.startConnectedNode||n===t&&n.startConnectedNode===e}},{key:"calculate",value:function(){var e=Object(Z.a)(Q.a.mark(function e(t){var n,o,r,a,i,c,s,l,d,u;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],o=[],r=[],a=[],i=[],e.next=7,this.updateBeforeCalc(Object(pe.a)(this.nodesArray),Object(pe.a)(this.beamsArray));case 7:if(c=e.sent,s=c.nodes,l=c.beams,!s.find(function(e){return 0===e.beams.length&&e.isStatic})){e.next=12;break}throw new Error("\u041d\u0435 \u0432\u0441\u0435 \u0443\u0437\u043b\u044b \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u044b");case 12:return d=0,s.forEach(function(e,t){switch(n.push(Object(ee.a)({},e.coord)),e.fixation){case h.X:d++,o.push({x:0,y:d}),a.push(-e.forceY);break;case h.Y:d++,o.push({x:d,y:0}),a.push(-e.forceX);break;case h.YX:case h.XY:o.push({x:0,y:0});break;case h.None:d++,o.push({x:d,y:d+1}),d++,a.push(-e.forceX),a.push(-e.forceY)}}),l.forEach(function(e,t){var n=e.name.split(" - ");r.push({x:Number(n[0])-1,y:Number(n[1])-1}),i.push(e.length)}),e.next=17,Ee.init(n,o,a,r,i,t);case 17:return u=e.sent,e.next=20,this.updateAfterCalc(s,l,u);case 20:return e.abrupt("return",!0);case 21:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateBeforeCalc",value:function(){var e=Object(Z.a)(Q.a.mark(function e(){var t,n,o=arguments;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:this.nodesArray,n=o.length>1&&void 0!==o[1]?o[1]:this.beamsArray,this.sortNodesByCoord(t),n=n.sort(this.sortByName),e.abrupt("return",{nodes:t,beams:n});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateAfterCalc",value:function(){var e=Object(Z.a)(Q.a.mark(function e(t,n,o){var r,a,i,c,s,l,d,u,p,m,f,h,y,b,v,g;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._calcData=o,r=o.P,(a=o.Vi)&&r){e.next=4;break}throw new Error("\u041d\u0435\u0442 \u0440\u0430\u0441\u0447\u0435\u0442\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445");case 4:for(i=!0,c=!1,s=void 0,e.prev=7,l=this.nodes.values()[Symbol.iterator]();!(i=(d=l.next()).done);i=!0)u=d.value,p=Object(ee.a)({},a[Number(u.name)-1]),u.dCoord={x:+p.x.toFixed(4),y:+p.y.toFixed(4)};e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),c=!0,s=e.t0;case 15:e.prev=15,e.prev=16,i||null==l.return||l.return();case 18:if(e.prev=18,!c){e.next=21;break}throw s;case 21:return e.finish(18);case 22:return e.finish(15);case 23:for(m=0,f=!0,h=!1,y=void 0,e.prev=27,b=this.beams.values()[Symbol.iterator]();!(f=(v=b.next()).done);f=!0)(g=v.value).startForce=Math.round(r[m][0][0]),g.endForce=Math.round(r[m][1][0]),m++;e.next=35;break;case 31:e.prev=31,e.t1=e.catch(27),h=!0,y=e.t1;case 35:e.prev=35,e.prev=36,f||null==b.return||b.return();case 38:if(e.prev=38,!h){e.next=41;break}throw y;case 41:return e.finish(38);case 42:return e.finish(35);case 43:return e.abrupt("return",{nodes:t,beams:n});case 44:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22],[27,31,35,43],[36,,38,42]])}));return function(t,n,o){return e.apply(this,arguments)}}()},{key:"delete",value:function(e){var t=this,n=void 0;if(this._beams.has(e)?n=this._beams.get(e):this._nodes.has(e)&&(n=this._nodes.get(e)),n instanceof Se){if(n.isStatic)return;return this.beamsArray.filter(function(e){return n instanceof Se&&n.beams.includes(e.id)}).forEach(function(e){if(n instanceof Se){var o;if(!e.startConnectedNode||!e.endConnectedNode)throw new Error;(o=e.startConnectedNode.id===n.id?t._nodes.get(e.endConnectedNode.id):t._nodes.get(e.startConnectedNode.id))&&o.removeBeam(e.id),t._beams.delete(e.id)}}),this._nodes.delete(n.id),!0}n instanceof Oe&&([n.startConnectedNode,n.endConnectedNode].forEach(function(e){e&&n&&e.removeBeam(n.id)}),this._beams.delete(n.id))}},{key:"clear",value:function(){this._beams.clear(),this._nodes.clear()}}]),e}(),we=Object(fe.a)(Ce.prototype,"_nodes",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ne=Object(fe.a)(Ce.prototype,"_beams",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xe=Object(fe.a)(Ce.prototype,"_calcData",[he.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(fe.a)(Ce.prototype,"nodes",[he.e],Object.getOwnPropertyDescriptor(Ce.prototype,"nodes"),Ce.prototype),Object(fe.a)(Ce.prototype,"nodesArray",[he.e],Object.getOwnPropertyDescriptor(Ce.prototype,"nodesArray"),Ce.prototype),Object(fe.a)(Ce.prototype,"beams",[he.e],Object.getOwnPropertyDescriptor(Ce.prototype,"beams"),Ce.prototype),Object(fe.a)(Ce.prototype,"beamsArray",[he.e],Object.getOwnPropertyDescriptor(Ce.prototype,"beamsArray"),Ce.prototype),Object(fe.a)(Ce.prototype,"calcData",[he.e],Object.getOwnPropertyDescriptor(Ce.prototype,"calcData"),Ce.prototype),Object(fe.a)(Ce.prototype,"addNode",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"addNode"),Ce.prototype),Object(fe.a)(Ce.prototype,"moveNode",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"moveNode"),Ce.prototype),Object(fe.a)(Ce.prototype,"setNodes",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"setNodes"),Ce.prototype),Object(fe.a)(Ce.prototype,"sortNodesByCoord",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"sortNodesByCoord"),Ce.prototype),Object(fe.a)(Ce.prototype,"addBeam",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"addBeam"),Ce.prototype),Object(fe.a)(Ce.prototype,"moveEndBeamWhileDraving",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"moveEndBeamWhileDraving"),Ce.prototype),Object(fe.a)(Ce.prototype,"connectBeamToStartNode",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"connectBeamToStartNode"),Ce.prototype),Object(fe.a)(Ce.prototype,"connectBeamToEndNode",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"connectBeamToEndNode"),Ce.prototype),Object(fe.a)(Ce.prototype,"setBeams",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"setBeams"),Ce.prototype),Object(fe.a)(Ce.prototype,"calculate",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"calculate"),Ce.prototype),Object(fe.a)(Ce.prototype,"updateBeforeCalc",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"updateBeforeCalc"),Ce.prototype),Object(fe.a)(Ce.prototype,"updateAfterCalc",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"updateAfterCalc"),Ce.prototype),Object(fe.a)(Ce.prototype,"delete",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"delete"),Ce.prototype),Object(fe.a)(Ce.prototype,"clear",[he.d],Object.getOwnPropertyDescriptor(Ce.prototype,"clear"),Ce.prototype),Ce),Ie=function(){function e(){Object(u.a)(this,e)}return Object(p.a)(e,null,[{key:"firstPlacement",value:function(e,t){e.forEach(function(e){var t=e.coord.x+Math.round(m.canvas.width/3/m.UI.cellSize)*m.UI.MMinCell,n=e.coord.y+Math.round(m.canvas.height/3/m.UI.cellSize)*m.UI.MMinCell;e.moveTo(t,n)})}},{key:"parse",value:function(){var e=Object(Z.a)(Q.a.mark(function e(t,n){var o,r,a,i;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,JSON.parse(t);case 2:return o=e.sent,e.next=5,JSON.parse(n);case 5:return r=e.sent,a=new Map,i=new Map,e.next=10,o.forEach(function(e){e.dCoord={x:0,y:0};var t=new Se(e);a.set(t.id,t)});case 10:return e.next=12,r.forEach(function(e){e.startForce=0,e.endForce=0;var t=new Oe(e);e.startConnectedNode&&e.endConnectedNode&&(t.connectStartNode(a.get(e.startConnectedNode.id)),t.connectEndNode(a.get(e.endConnectedNode.id))),i.set(t.id,t)});case 12:return e.abrupt("return",{nodes:a,beams:i});case 13:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"toString",value:function(e){var t=Array.from(e.nodes.values()),n=Array.from(e.beams.values());return{nodesJSON:JSON.stringify(t).replace(/_/g,""),beamsJSON:JSON.stringify(n).replace(/_/g,"")}}},{key:"createNodes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new Map;return e.forEach(function(e){var t=new Se({coord:{x:e.x,y:e.y},isStatic:!0,fixation:e.fixation});o.set(t.id,t)}),t.forEach(function(e){var t=new Se({coord:{x:e.x,y:e.y},isStatic:!0,forceX:e.forceX||0,forceY:e.forceY||0});o.set(t.id,t)}),n.forEach(function(e){var t=new Se({coord:{x:e.x,y:e.y}});o.set(t.id,t)}),o}}]),e}(),Be=n(418),De=n(118),Me=n(443),Ue=n(444),Pe=n(484),Te=n(445),Fe=n(446),ze=n(447),Ae=Object(Be.a)(function(e){return Object(X.a)({root:{width:"100%",overflowX:"auto",paddingTop:e.spacing(2)},table:{minWidth:650},tableBox:{marginBottom:e.spacing(2)},title:{paddingTop:e.spacing(2),paddingLeft:e.spacing(2)}})}),Le=Object(te.a)(function(e){var t=Ae(),n=e.Vi,o=e.P,r=e.LinkNodes,a=function(e,n,o){return i.createElement(De.a,{className:t.tableBox},i.createElement(V.a,{variant:"h6",className:t.title},e),i.createElement(Me.a,{className:t.table},Xe(n),i.createElement(Ue.a,null,o.map(function(e){return Ye(e)}))))};return i.createElement(Pe.a,{className:t.root},function(e,t){var n=[];return e.forEach(function(e,o){n.push(["".concat(t[o].x+1," - ").concat(t[o].y+1),e[0][0].toFixed(0),e[1][0].toFixed(0)])}),a("\u0423\u0441\u0438\u043b\u0438\u044f \u0432 \u0441\u0442\u0435\u0440\u0436\u043d\u044f\u0445",["\u0421\u0442\u0435\u0440\u0436\u0435\u043d\u044c","\u0421\u0438\u043b\u0430 \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 (H)","\u0421\u0438\u043b\u0430 \u0432 \u043a\u043e\u043d\u0446\u0435 (H)"],n)}(o,r),function(e){var t=[];return e.forEach(function(e,n){t.push([(n+1).toString(),e.x.toFixed(4),e.y.toFixed(4)])}),a("\u041f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u044f \u0443\u0437\u043b\u043e\u0432",["\u0423\u0437\u0435\u043b","\u041f\u043e \u043e\u0441\u0438 X (\u043c\u043c)","\u041f\u043e \u043e\u0441\u0438 Y (\u043c\u043c)"],t)}(n))}),Xe=function(e){return i.createElement(Te.a,null,i.createElement(Fe.a,null,e.map(function(e){return i.createElement(ze.a,{key:e},e)})))},Ye=function(e){return i.createElement(Fe.a,null,e.map(function(e){return i.createElement(ze.a,{key:e},e)}))},Ve=Le,We=n(460),Ge=n(458),Re=n(462),He=n(463),Ke=n(3),Je=n(448),qe=n(449),$e=Object(Y.a)(function(e){return Object(X.a)({appBar:{zIndex:e.zIndex.drawer+1},logo:{marginRight:e.spacing(4),marginLeft:e.spacing(2),"& img":{width:50,height:"auto"}}})})(function(e){var t=e.classes,n=e.children,o=e.className,r=e.color,a=e.position,c=e.withLogo,s=void 0===c||c;return i.createElement(Je.a,{position:a||"fixed",className:Object(Ke.a)(t.appBar,o),color:r||"primary"},i.createElement(qe.a,null,function(){if(s)return i.createElement(D.b,{to:"/",className:t.logo},i.createElement("img",{alt:"Logo Icon",src:m.img.bridgeIcon_2}))}(),n))}),Qe=n(485),Ze=n(451),et=function(e){var t=e.title,n=void 0===t?"":t,o=e.icon,r=void 0===o?i.createElement(i.Fragment,null):o,a=e.disabled,c=void 0!==a&&a,s=e.onClickToAction,l=e.todo,d=e.className,u=e.fab,p=void 0!==u&&u,m=e.size,f=e.onlyIcon,h=void 0!==f&&f;return p?i.createElement(Qe.a,{title:n},i.createElement(Ze.a,{size:m,color:"secondary",onClick:function(e){return s(e,l)},disabled:c,className:d,style:{marginLeft:5,marginRight:5}},r)):i.createElement(Qe.a,{title:n},i.createElement(W.a,{size:m,color:"secondary",variant:"contained",onClick:function(e){return s(e,l)},disabled:c,className:d,style:{marginLeft:5,marginRight:5}},r,!h&&n))},tt=n(224),nt=n(452),ot=n(453),rt=n(454),at=n(455);function it(e){var t=i.useState(null),n=Object(tt.a)(t,2),o=n[0],r=n[1];function a(e){r(null)}var c=e.items,s=e.title,l=Boolean(o),d=l?s:void 0;return i.createElement("div",null,i.createElement(W.a,{"aria-describedby":d,size:e.size,"aria-haspopup":"menu",onClick:function(e){r(o?null:e.currentTarget)},color:"secondary",variant:e.variant||"contained",style:{marginLeft:5,marginRight:5}},e.icon,"  ",e.title),i.createElement(nt.a,{id:d,open:l,anchorEl:o,onClose:a,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},keepMounted:!0},i.createElement(De.a,{onMouseLeave:a},i.createElement(ot.a,null,c.map(function(t){return i.createElement(rt.a,{onClick:function(n){return function(t,n){e.onClickToAction(t,n),r(null)}(n,t.todo)},disabled:t.disabled},void 0!==t.icon&&i.createElement(at.a,null,t.icon),t.title)})))))}var ct=n(79),st=n(218),lt=n(21),dt=n(456),ut=function(e){return Object(X.a)({btn:{marginLeft:e.spacing(2),marginRight:e.spacing(2),borderRadius:"50% !important",border:"1px solid ".concat(Object(lt.b)(e.palette.action.active,.2)," !important"),transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.light,"&$selected":{backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark}},"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main},"&$disabled":{backgroundColor:e.palette.secondary.main}}},selected:{}})},pt=function(e){var t=e.selected,n=e.classes,o=e.value,r=e.name,a=e.icon,c=Object(st.a)(e,["selected","classes","value","name","icon"]);return i.createElement(dt.a,Object.assign({key:r,value:o,className:Object(Ke.a)(n.btn,Object(ct.a)({},n.selected,t))},c),i.createElement(Qe.a,{title:r},a))},mt=Object(Y.a)(ut)(pt),ft=(Object(Y.a)(ut)(pt),n(422)),ht=n(457),yt=n(219),bt=n.n(yt),vt=Object(Be.a)(function(e){return Object(X.a)({box:{backgroundColor:e.palette.grey[300],width:"100%",height:"100%",padding:e.spacing(4),overflowX:"auto"},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1}})}),gt=c.a.forwardRef(function(e,t){return c.a.createElement(ft.a,Object.assign({direction:"up",ref:t},e))});function Ot(e){var t=e.children,n=e.open,o=e.handleClose,r=e.title,a=vt();return c.a.createElement(ht.a,{fullScreen:!0,open:n,onClose:o,TransitionComponent:gt},c.a.createElement(Je.a,{className:a.appBar},c.a.createElement(qe.a,null,c.a.createElement(V.a,{variant:"h6",className:a.title},r),c.a.createElement(Ge.a,{edge:"end",color:"inherit",onClick:o,"aria-label":"close"},c.a.createElement(bt.a,null)))),c.a.createElement(Pe.a,{className:a.box},t))}var Et,kt,jt,Ct,wt,Nt=n(459),xt=n(461),St=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(U.a)(this,Object(P.a)(t).call(this,e))).state={open:!0,viewTooltip:!1},n.switchDrawer=n.switchDrawer.bind(Object(ye.a)(n)),n}return Object(T.a)(t,e),Object(p.a)(t,[{key:"componentWillMount",value:function(){if(this.props.title){var e=localStorage.getItem("Sidebar_state:"+this.props.title);e&&this.setState({open:"true"===e})}}},{key:"switchDrawer",value:function(){localStorage.setItem("Sidebar_state:"+this.props.title,this.state.open?"false":"true"),this.setState({open:!this.state.open,viewTooltip:!1})}},{key:"changeViewtooltip",value:function(e){this.setState({viewTooltip:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,o=t.children,r=t.title,a=t.btnIcon,c=t.anchor,s=this.state,l=s.open,d=s.viewTooltip;return i.createElement(i.Fragment,null,i.createElement(Nt.a,{className:n.drawer,variant:"persistent",open:l,anchor:c,classes:{paper:n.drawerPaper}},i.createElement("div",{className:n.toolbar}),i.createElement(V.a,{variant:"body2",align:"center",className:n.title},r),i.createElement(We.a,null),o),i.createElement(Qe.a,{title:r,open:void 0!==r&&d&&!l,onOpen:function(){return e.changeViewtooltip(!0)},onClose:function(){return e.changeViewtooltip(!1)}},i.createElement(Ze.a,{style:{left:"left"===c?l?m.UI.sidebarWidth+15:15:"auto",right:"right"===c?l?m.UI.sidebarWidth+15:15:"auto"},color:"secondary",size:"medium",className:n.toogleIcon,onClick:this.switchDrawer},l?i.createElement(xt.a,null):a)))}}]),t}(i.PureComponent),_t=Object(Y.a)(function(e){return Object(X.a)({drawer:{position:"relative"},drawerPaper:{width:m.UI.sidebarWidth},toogleIcon:{position:"absolute",top:e.spacing(10),zIndex:e.zIndex.drawer+1},title:{padding:e.spacing(1)},toolbar:e.mixins.toolbar})})(St),It=function(e){var t=e.text;e.className;return i.createElement(i.Fragment,null,i.createElement(V.a,{variant:"subtitle2"},t),i.createElement(We.a,null))},Bt=function(e){var t=e.text;e.className;return 0===t.length?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,t.map(function(e,t){return i.createElement(V.a,{variant:"subtitle2",key:t},e)}),i.createElement(We.a,null))},Dt=Object(te.a)(Et=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(U.a)(this,Object(P.a)(t).call(this,e))).state={},n}return Object(T.a)(t,e),Object(p.a)(t,[{key:"viewFixationInfo",value:function(e){switch(e.fixation){case h.X:return i.createElement(It,{text:"\u0424\u0438\u043a\u0441\u0430\u0446\u0438\u044f \u043f\u043e \u043e\u0441\u0438 X"});case h.Y:return i.createElement(It,{text:"\u0424\u0438\u043a\u0441\u0430\u0446\u0438\u044f \u043f\u043e \u043e\u0441\u0438 Y"});case h.XY:return i.createElement(It,{text:"\u0424\u0438\u043a\u0441\u0430\u0446\u0438\u044f \u043f\u043e \u043e\u0441\u044f\u043c \u0425 \u0438 Y"});default:return}}},{key:"NodeInfo",value:function(e){var t=this.props,n=t.classes,o=t.onDelete,r=void 0===o?function(){}:o;return i.createElement(Pe.a,{className:n.root},i.createElement(V.a,{variant:"h6",className:n.title},"\u0423\u0437\u0435\u043b ",e.name),i.createElement(Bt,{text:["X: ".concat(e.coord.x," \u043c\u043c"),"Y: ".concat(e.coord.y," \u043c\u043c")]}),i.createElement(Bt,{text:["\u0394X: ".concat(e.dCoord.x," \u043c\u043c"),"\u0394Y': ".concat(e.dCoord.y," \u043c\u043c")]}),0!==e.forceX&&i.createElement(It,{text:"\u0421\u0438\u043b\u0430 \u043f\u043e \u043e\u0441\u0438 \u0425: ".concat(e.forceX," H")}),0!==e.forceY&&i.createElement(It,{text:"\u0421\u0438\u043b\u0430 \u043f\u043e \u043e\u0441\u0438 Y: ".concat(e.forceY," H")}),this.viewFixationInfo(e),i.createElement("div",{className:n.btnGroup},i.createElement(Ge.a,{"aria-label":"Delete",onClick:function(){return r(e)}},i.createElement(Re.a,null))))}},{key:"BeamInfo",value:function(e){var t=this.props,n=t.classes,o=t.onDelete,r=void 0===o?function(){}:o;return i.createElement(Pe.a,{className:n.root},i.createElement(V.a,{variant:"h6",className:n.title},"\u0421\u0442\u0435\u0440\u0436\u0435\u043d\u044c ",e.name),i.createElement(It,{text:"\u0414\u043b\u0438\u043d\u0430: ".concat(e.length," \u043c\u043c")}),i.createElement(Bt,{text:["\u0423\u0441\u0438\u043b\u0438\u044f \u0432 \u0441\u0442\u0435\u0440\u0436\u043d\u0435","\u0412 \u043d\u0430\u0447\u0430\u043b\u0435: ".concat(e.startForce," H"),"\u0412 \u043a\u043e\u043d\u0446\u0435: ".concat(e.endForce," H")]}),i.createElement("div",{className:n.btnGroup},i.createElement(Ge.a,{"aria-label":"Delete",onClick:function(){return r(e)}},i.createElement(Re.a,null))))}},{key:"viewInfo",value:function(e){return e instanceof Se?this.NodeInfo(e):e instanceof Oe?this.BeamInfo(e):void 0}},{key:"render",value:function(){var e=this.props.entity;return i.createElement(_t,{anchor:"right",title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u0435",btnIcon:i.createElement(He.a,null)},this.viewInfo(e),i.createElement(We.a,null))}}]),t}(i.PureComponent))||Et,Mt=Object(Y.a)(function(e){return Object(X.a)({root:{padding:e.spacing(2)},title:{marginBottom:e.spacing(2)},btnGroup:{marginTop:e.spacing(2)}})})(Dt),Ut=n(220),Pt=n(221),Tt=n(464),Ft=n(465),zt=n(466),At=n(467),Lt=n(468),Xt=n(469),Yt=n(470),Vt={CANVAS:{CLEAR:"header-canvas-clear",SAVE:"header-canvas-save"},CALC:{DO:"header-calc-do",RESULT:"header-calc-result"}},Wt={TRUSS:{CALC:"tools-truss-calc"}},Gt=[{title:"\u0425\u043e\u043b\u0441\u0442",items:[{title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0432 \u043a\u044d\u0448",todo:Vt.CANVAS.SAVE,icon:i.createElement(Tt.a,null)},{title:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",todo:Vt.CANVAS.CLEAR,icon:i.createElement(Ft.a,null)}]},{title:"\u0420\u0430\u0441\u0447\u0435\u0442",items:[{title:"\u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0442\u044c",todo:Vt.CALC.DO,icon:i.createElement(zt.a,null)},{title:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",todo:Vt.CALC.RESULT,icon:i.createElement(At.a,null)}]}],Rt=[{title:"\u0420\u0430\u0441\u0447\u0435\u0442 \u0444\u0435\u0440\u043c\u044b",todo:Wt.TRUSS.CALC,icon:i.createElement(zt.a,null),fab:!0}],Ht=[{title:"\u041f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435",mod:a.move,icon:i.createElement(Lt.a,null)},{title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0437\u0435\u043b",mod:a.addNode,icon:i.createElement(Xt.a,null)},{title:"\u0421\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0443\u0437\u043b\u044b",mod:a.addBeam,icon:i.createElement(Yt.a,null)},{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",mod:a.delete,icon:i.createElement(Re.a,null)}],Kt=Vt,Jt=Wt,qt=Object(te.a)(kt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(U.a)(this,Object(P.a)(t).call(this,e))).stage=void 0,n.state={stageHeight:m.canvas.height,stageWidth:m.canvas.width,uiMode:a.none,selectedEntityID:"",paintEntity:null,openModal:null},n.UIonClick=n.UIonClick.bind(Object(ye.a)(n)),n.UIonDrag=n.UIonDrag.bind(Object(ye.a)(n)),n.UIonMouseMove=n.UIonMouseMove.bind(Object(ye.a)(n)),n.onKeyHandle=n.onKeyHandle.bind(Object(ye.a)(n)),n.selectEntity=n.selectEntity.bind(Object(ye.a)(n)),n.deleteEntity=n.deleteEntity.bind(Object(ye.a)(n)),n.clearFarm=n.clearFarm.bind(Object(ye.a)(n)),n.saveFarm=n.saveFarm.bind(Object(ye.a)(n)),n.calculate=n.calculate.bind(Object(ye.a)(n)),n.handleBtnClick=n.handleBtnClick.bind(Object(ye.a)(n)),n.modalStateChange=n.modalStateChange.bind(Object(ye.a)(n)),n.stage=i.createRef(),n}return Object(T.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this.stage.current;if(e){var t=e.attrs.container.parentElement.parentElement;t&&(t.scrollTop=(t.scrollHeight-t.offsetHeight)/2,t.scrollLeft=(t.scrollWidth-t.offsetWidth)/2)}}},{key:"UIonClick",value:function(e,t){var n=this.state,o=n.uiMode,r=n.paintEntity,i=this.props.calculation,c=e.target.getStage()===e.target;if(e.evt.preventDefault(),0===e.evt.button&&!i){switch(o){case a.none:!c&&t?this.selectEntity(t.id):this.selectEntity("");break;case a.addNode:if(c){var s=e.evt,l=s.layerX,d=s.layerY,u=B.cellX(l),p=B.cellX(d);this.props.addNode(u,p)}break;case a.addBeam:if(!c&&t instanceof Se){var m=this.props.addBeam({coord:Object(ee.a)({},t.coord)});if(m instanceof Oe){var f=this.props.connectBeamToNode(t,m,"start");f instanceof Oe?this.setState({paintEntity:f,uiMode:a.addBeamStart}):this.props.deleteEntity(m.id)}}break;case a.addBeamStart:!c&&t instanceof Se&&r&&this.props.connectBeamToNode(t,r,"end")&&this.setState({uiMode:a.addBeam,paintEntity:null});break;case a.delete:!c&&t&&this.deleteEntity(t)}c&&this.setState({selectedEntityID:""})}}},{key:"UIonMouseMove",value:function(e){if(!this.props.calculation){var t=this.state,n=t.uiMode,o=t.paintEntity,r=e.evt,i=r.layerX,c=r.layerY;switch(n){case a.addBeamStart:e.target.getStage()&&(o?this.props.moveEndBeam(o,i,c):this.setState({uiMode:a.addBeam}));break;case a.delete:var s=e.target.getStage();s===e.target&&(s.container().style.cursor="default")}}}},{key:"UIonDrag",value:function(e,t){if(!this.props.calculation)switch(this.state.uiMode){case a.move:if(t instanceof Se&&e.evt.defaultPrevented){var n=e.evt,o=n.layerX,r=n.layerY;this.props.moveNode(t,B.cellX(o),B.cellY(r))}}}},{key:"onKeyHandle",value:function(e){switch(e.key){case"Escape":this.deletePaintEntity(),this.setState({uiMode:0})}}},{key:"deletePaintEntity",value:function(){this.state.paintEntity&&this.props.deleteEntity(this.state.paintEntity.id),this.setState({paintEntity:null})}},{key:"deleteEntity",value:function(e){this.props.calculation||(this.state.selectedEntityID&&this.state.selectedEntityID===e.id&&this.setState({selectedEntityID:""}),this.props.deleteEntity(e.id))}},{key:"selectEntity",value:function(e){this.props.calculation||e&&this.setState({selectedEntityID:e})}},{key:"clearFarm",value:function(){window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0445\u043e\u043b\u0441\u0442?")&&this.props.clearTruss()}},{key:"saveFarm",value:function(e){window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0445\u043e\u043b\u0441\u0442 \u0432 \u043a\u044d\u0448?")&&this.props.cacheTruss()}},{key:"calculate",value:function(e){this.props.calculate()}},{key:"setSelectedMode",value:function(e){this.props.calculation||(this.state.paintEntity&&this.props.deleteEntity(this.state.paintEntity.id),this.setState({uiMode:e||0,paintEntity:null}))}},{key:"handleBtnClick",value:function(e,t){switch(t){case Kt.CANVAS.CLEAR:this.clearFarm();break;case Kt.CANVAS.SAVE:this.saveFarm(e);break;case Jt.TRUSS.CALC:case Kt.CALC.DO:this.calculate(e);break;case Kt.CALC.RESULT:this.props.farm.calcData&&this.modalStateChange(Kt.CALC.RESULT)}}},{key:"modalStateChange",value:function(e){this.setState({openModal:e})}},{key:"viewDialogs",value:function(){var e=this;if(this.props.farm.calcData)return i.createElement(Ot,{title:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0440\u0430\u0441\u0441\u0447\u0435\u0442\u043e\u0432",open:this.state.openModal===Kt.CALC.RESULT,handleClose:function(){return e.modalStateChange(null)}},i.createElement(Ve,this.props.farm.calcData))}},{key:"render",value:function(){var e=this.state,t=e.stageHeight,n=e.stageWidth,o=e.uiMode,r=e.selectedEntityID,a=this.props,c=a.classes,s=a.farm,l=(a.calculation,a.calculated),d=r&&(s.beams.get(r)||s.nodes.get(r))||null;return i.createElement(Pe.a,{className:c.root},i.createElement(Pt.a,{isActive:!0}),i.createElement(Ut.a,{keyEventName:"keyup",keyValue:"Escape",onKeyHandle:this.onKeyHandle}),i.createElement(Zt,{disabled:Object(ct.a)({},Kt.CALC.RESULT,!Boolean(this.props.farm.calcData)),onClick:this.handleBtnClick}),i.createElement("div",{className:c.toolbar}),i.createElement(Pe.a,{className:c.stageBox},i.createElement("div",{className:c.toolbar}),i.createElement(hn,{nodes:s.nodesArray,beams:s.beamsArray,selectedEntityID:r,onSelect:this.selectEntity}),i.createElement(Nn,{onClick:this.UIonClick,onDrag:this.UIonDrag,onMouseMove:this.UIonMouseMove,selectedEntity:d,stageHeight:t,stageWidth:n,nodes:s.nodesArray,beams:s.beamsArray,stage:this.stage,uiMode:o,viewNewPos:l}),i.createElement(Mt,{entity:s.nodes.get(r)||s.beams.get(r),onDelete:this.deleteEntity})),i.createElement(tn,{selected:o,onSelect:this.setSelectedMode.bind(this),onClick:this.handleBtnClick}),this.viewDialogs())}}]),t}(i.Component))||kt,$t=Object(Y.a)(function(e){return Object(X.a)({root:{width:"100%",height:"100%",overflow:"hidden",background:e.palette.background.default,display:"flex",flexDirection:"column"},stageBox:{display:"flex",flexGrow:1,overflow:"hidden"},toolbar:e.mixins.toolbar})})(qt),Qt=n(471),Zt=Object(Y.a)(function(e){return Object(X.a)({root:{},btnIcon:{fontSize:18,marginTop:3,marginBottom:3},grow:{flexGrow:1}})})(function(e){var t=e.classes,n=e.onClick,o=void 0===n?function(){}:n,r=e.disabled,a=void 0===r?{}:r;return i.createElement($e,{className:t.root},Gt.map(function(e){return e.items.forEach(function(e){e.disabled=!0===a[e.todo]}),i.createElement(it,Object.assign({},e,{onClickToAction:o,size:"small"}))}),i.createElement("div",{className:t.grow}),i.createElement(Ze.a,{color:"secondary",size:"small"},i.createElement(Qt.a,null,"priority_high")))}),en=n(486),tn=Object(Y.a)(function(e){return Object(X.a)({root:{position:"absolute",padding:e.spacing(1),bottom:e.spacing(2),left:"50%",transform:"translateX(-50%)",backgroundColor:Object(lt.b)(e.palette.primary.light,.4),transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:e.palette.primary.light}},modsBtnGroup:{borderRadius:0,backgroundColor:"transparent",verticalAlign:"middle"},vHr:{display:"inline-block",width:2,height:"100%",minHeight:48,verticalAlign:"middle",backgroundColor:e.palette.secondary.light,opacity:.5,marginRight:10}})})(function(e){var t=e.onSelect,n=e.selected,o=e.classes,r=e.onClick,a=void 0===r?function(){}:r;return i.createElement(De.a,{className:o.root},i.createElement(en.a,{value:n,exclusive:!0,onChange:function(e,n){return t(n)},size:"medium",className:o.modsBtnGroup},Ht.map(function(e){return i.createElement(mt,{key:e.mod,value:e.mod,selected:e.mod===n,icon:e.icon,name:e.title})})),i.createElement("div",{className:o.vHr}),Rt.map(function(e){return i.createElement(et,Object.assign({},e,{onClickToAction:a,fab:e.fab,key:e.title,size:"medium"}))}))}),nn=n(421),on=n(472),rn=n(473),an=n(476),cn=n(420),sn=n(474),ln=n(475),dn=n(477),un=n(478),pn=n(479),mn=n(480),fn=Object(te.a)(jt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(U.a)(this,Object(P.a)(t).call(this,e))).state={open:!1,tabs:new Map},n.openTab=n.openTab.bind(Object(ye.a)(n)),n.viewListItem=n.viewListItem.bind(Object(ye.a)(n)),n}return Object(T.a)(t,e),Object(p.a)(t,[{key:"componentWillMount",value:function(){var e=this.state.tabs;e.set("\u0423\u0437\u043b\u044b",!0),e.set("\u0421\u0442\u0435\u0440\u0436\u043d\u0438",!0),this.setState({tabs:new Map(e)})}},{key:"openTab",value:function(e){var t=this.state.tabs;t.set(e,!t.get(e)),this.setState({tabs:new Map(t)})}},{key:"viewListItem",value:function(e,t,n){var r=this,a=this.props,c=a.selectedEntityID,s=void 0===c?"":c,l=a.classes,d=a.onSelect,u=void 0===d?function(){}:d,p=this.state.tabs;return i.createElement(Pe.a,null,i.createElement(nn.a,{button:!0,onClick:function(){return r.openTab(t)}},n&&i.createElement(at.a,null,i.createElement(on.a,{badgeContent:e.length,color:"secondary"},n)),i.createElement(rn.a,{primary:t}),p.get(t)?i.createElement(sn.a,null):i.createElement(ln.a,null)),i.createElement(an.a,{in:p.get(t),timeout:"auto",unmountOnExit:!0},i.createElement(cn.a,{component:"div",disablePadding:!0},e.map(function(e){return i.createElement(nn.a,{button:!0,className:l.nested,key:e.id,selected:s===e.id,onClick:function(t){return u(e.id)}},e instanceof Se&&i.createElement(at.a,null,i.createElement(dn.a,{style:{color:o.getNodeColor(e)}})),i.createElement(rn.a,{primary:e.name}))}))),i.createElement(We.a,null))}},{key:"render",value:function(){var e=this.props,t=e.nodes,n=void 0===t?[]:t,o=e.beams,r=void 0===o?[]:o;return r.sort(function(e,t){return e.name>t.name?1:-1}),n.sort(function(e,t){return e.name>t.name?1:-1}),i.createElement(_t,{anchor:"left",title:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430",btnIcon:i.createElement(un.a,null)},this.viewListItem(n,"\u0423\u0437\u043b\u044b",i.createElement(pn.a,null)),this.viewListItem(r,"\u0421\u0442\u0435\u0440\u0436\u043d\u0438",i.createElement(mn.a,null)))}}]),t}(i.PureComponent))||jt,hn=Object(Y.a)(function(e){return Object(X.a)({nested:{paddingLeft:e.spacing(6)}})})(fn),yn=n(37),bn=m.UI.beamSize,vn=Object(te.a)(function(e){var t=e.onClick,n=void 0===t?function(){}:t,r=e.mode,a=void 0===r?o.UIModes.none:r,c=e.selected,s=void 0!==c&&c,l=e.beam,d=e.viewNewPos,u=void 0!==d&&d,p=[l.coord.x/m.UI.koefOnGrid,l.coord.y/m.UI.koefOnGrid,l.endCoord.x/m.UI.koefOnGrid,l.endCoord.y/m.UI.koefOnGrid];return u&&(p=[(l.coord.x+l.dCoord.x*m.UI.koefOfNewPos)/m.UI.koefOnGrid,(l.coord.y-l.dCoord.y*m.UI.koefOfNewPos)/m.UI.koefOnGrid,(l.endCoord.x+l.dEndCoord.x*m.UI.koefOfNewPos)/m.UI.koefOnGrid,(l.endCoord.y-l.dEndCoord.y*m.UI.koefOfNewPos)/m.UI.koefOnGrid]),i.createElement(yn.Line,{opacity:u?.3:1,points:p,stroke:o.getBeamColor(l),strokeWidth:bn,shadowBlur:s&&!u?8:2,hitStrokeWidth:u?0:4*bn,onClick:u?function(){}:function(e){return n(e,l)},onMouseEnter:u?function(){}:function(e){return o.beamMouseEnter(e,l,a)},onMouseLeave:u?function(){}:function(e){return o.beamMouseLeave(e)}})}),gn=i.memo(function(e){var t=e.heightBox,n=e.heightCell,o=e.widthBox,r=e.widthCell,a=o/r,c=t/n;return console.log("UIGrid"),i.createElement(i.Fragment,null,function(e,t,n){for(var o=[],r=0;r<n;r++)o.push(i.createElement(yn.Line,{points:[r*e,0,r*e,t],stroke:"#ddd",strokeWidth:1,key:r}));return o}(r,t,a),function(e,t,n){for(var o=[],r=0;r<n;r++)o.push(i.createElement(yn.Line,{points:[0,r*e,t,r*e],stroke:"#ddd",strokeWidth:1,key:r}));return o}(n,o,c))}),On=m.UI.nodeSize,En=Object(te.a)(Ct=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(U.a)(this,Object(P.a)(t).call(this,e))).viewForce=function(e,t){if(!n.props.viewNewPos)return i.createElement(i.Fragment,null,i.createElement(yn.Arrow,{points:[0,0,m.UI.cellSize,0],stroke:o.theme.palette.grey[300],strokeWidth:On/3,shadowBlur:2,pointerLength:m.UI.cellSize/10,pointerWidth:m.UI.cellSize/10,hitStrokeWidth:2*On,rotation:e>0?t:180+t}),i.createElement(yn.Text,{x:0===t?e>0?m.UI.cellSize/3:-m.UI.cellSize:m.UI.cellSize/3,y:90===t?e>0?m.UI.cellSize/3:-m.UI.cellSize/2:-m.UI.cellSize/1.5,text:e+" H"}))},n.viewFixation=function(e){return i.createElement(yn.Group,{x:0,y:0,rotation:e},i.createElement(yn.Line,{points:[0,0,0,m.UI.cellSize,-m.UI.cellSize/2,m.UI.cellSize,m.UI.cellSize/2,m.UI.cellSize],stroke:o.theme.palette.grey[300],strokeWidth:On/4,shadowBlur:2}),i.createElement(yn.Circle,{radius:On/2,fill:o.theme.palette.grey[500],x:0,y:m.UI.cellSize-On/1.7}))},n.viewForce=n.viewForce.bind(Object(ye.a)(n)),n}return Object(T.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props,t=e.node,n=e.viewNewPos,r=void 0!==n&&n,c=e.onClick,s=void 0===c?function(){}:c,l=e.selected,d=void 0!==l&&l,u=e.mode,p=void 0===u?a.none:u,f=e.drag,y=void 0===f?function(){}:f,b=t.coord.x/m.UI.koefOnGrid,v=t.coord.y/m.UI.koefOnGrid;if(r){if(0===t.dCoord.x&&0===t.dCoord.y)return i.createElement(i.Fragment,null);b=(t.coord.x+t.dCoord.x*m.UI.koefOfNewPos)/m.UI.koefOnGrid,v=(t.coord.y-t.dCoord.y*m.UI.koefOfNewPos)/m.UI.koefOnGrid}return i.createElement(yn.Group,{opacity:r?.3:1,x:b,y:v,_useStrictMode:!0,onClick:r?function(){}:function(e){return s(e,t)}},0!==t.forceX&&this.viewForce(t.forceX,0),0!==t.forceY&&this.viewForce(t.forceY,90),t.fixation===h.X&&this.viewFixation(90),t.fixation===h.Y&&this.viewFixation(0),t.fixation===h.XY&&this.viewFixation(90),t.fixation===h.YX&&this.viewFixation(0),i.createElement(yn.Circle,{radius:On,x:0,y:0,fill:o.getNodeColor(t),shadowBlur:d&&!r?8:2,stroke:o.getNodeStorkeColor(t,p),strokeWidth:r?0:o.getNodeStorkeWidth(t,p),hitStrokeWidth:r?0:2*On}),i.createElement(yn.Text,{x:-On,y:-On/2-1,align:"center",fontSize:18,fill:"#fff",shadowBlur:8,fontFamily:"Trebuchet MS",width:2*On,verticalAlign:"middle",text:t.name}),i.createElement(yn.Circle,{radius:On,x:0,y:0,onDragEnd:function(e){e.target.to({x:0,y:0})},hitStrokeWidth:r?0:2*On,draggable:p===a.move&&!t.isStatic&&!r,onMouseEnter:r?function(){}:function(e){return o.nodeMouseEnter(e,t,p)},onMouseLeave:r?function(){}:function(e){return o.nodeMouseLeave(e)},onDragMove:function(e){return y(e,t)}}))}}]),t}(i.Component))||Ct,kn=n(222),jn=n.n(kn),Cn=n(43),wn=Object(Cn.c)(function(e){var t=e.classes,n=e.stage,o=e.stageHeight,r=e.stageWidth,a=e.onClick,c=e.onMouseMove,s=e.onDrag,l=e.beams,d=e.nodes,u=e.uiMode,p=e.selectedEntity,f=e.viewNewPos;return i.createElement(jn.a,{autoHide:!0},i.createElement(Pe.a,{style:{width:r+2*m.UI.sidebarWidth+20,height:o+m.UI.sidebarWidth},className:t.root},i.createElement(yn.Stage,{height:o,width:r,style:{height:o,width:r},className:t.stage,onClick:a,onMouseMove:c,ref:n},i.createElement(yn.Layer,{className:"layer"},i.createElement(gn,{heightCell:m.UI.cellSize,widthCell:m.UI.cellSize,heightBox:o,widthBox:r}),l.map(function(e){return i.createElement(vn,{key:e.id,beam:e,mode:u,onClick:a,selected:p===e})}),d.map(function(e){return i.createElement(En,{key:e.id,node:e,mode:u,drag:s,onClick:a,selected:p===e})}),f&&l.map(function(e){return i.createElement(vn,{key:e.id,beam:e,mode:u,onClick:a,selected:p===e,viewNewPos:!0})}),f&&d.map(function(e){return i.createElement(En,{key:e.id,node:e,mode:u,drag:s,onClick:a,selected:p===e,viewNewPos:!0})})))))}),Nn=Object(Y.a)(function(e){return Object(X.a)({root:{backgroundColor:"#ddd",display:"flex",alignItems:"center",justifyContent:"center"},stage:{backgroundColor:"#fff",boxShadow:e.shadows[2],borderRadius:8}})})(wn),xn=Object(te.a)(wt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(U.a)(this,Object(P.a)(t).call(this,e))).nodesCacheName="nodes:array",n.beamsCacheName="beams:array",n.addNode=function(e,t,o){n.state.calculated&&n.setState({calculated:!1});try{return _e.addNode(Object(ee.a)({},o,{coord:{x:e*m.UI.koefOnGrid,y:t*m.UI.koefOnGrid}}))}catch(r){console.error("addNode",r),r.message?alert(r.message):alert(r)}},n.moveNode=function(e,t,o){n.state.calculated&&n.setState({calculated:!1});try{var r=t*m.UI.koefOnGrid,a=o*m.UI.koefOnGrid;_e.moveNode(e.id,r,a)}catch(i){console.error("moveNode",i),i.message?alert(i.message):alert(i)}},n.addBeam=function(e){n.state.calculated&&n.setState({calculated:!1});try{return _e.addBeam(e)}catch(t){console.error("addBeam",t),t.message?alert(t.message):alert(t)}},n.moveEndBeam=function(e,t,o){n.state.calculated&&n.setState({calculated:!1});try{var r=t*m.UI.koefOnGrid,a=o*m.UI.koefOnGrid;return _e.moveEndBeamWhileDraving(e.id,r,a)}catch(i){console.error("moveEndBeam",i),i.message?alert(i.message):alert(i)}},n.connectBeamToNode=function(e,t,o){n.state.calculated&&n.setState({calculated:!1});try{switch(o){case"start":return _e.connectBeamToStartNode(e.id,t.id);case"end":return _e.connectBeamToEndNode(e.id,t.id)}}catch(r){console.error("connectBeamToNode",r),r.message?alert(r.message):alert(r)}},n.deleteEntity=function(e){n.state.calculated&&n.setState({calculated:!1});try{_e.delete(e)}catch(t){console.error("deleteEntity",t),t.message?alert(t.message):alert(t)}},n.calculate=function(){var e=Object(Z.a)(Q.a.mark(function e(t){return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.state.calculated&&n.setState({calculated:!1}),e.prev=1,n.setState({calculation:!0}),console.log("Calculate"),e.next=6,_e.calculate();case 6:n.setState({calculated:!0,calculation:!1}),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("calculate",e.t0),e.t0.message?alert(e.t0.message):alert(e.t0),n.setState({calculated:!1,calculation:!1});case 14:case"end":return e.stop()}},e,null,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),n.setDefaultTruss=function(){n.state.calculated&&n.setState({calculated:!1});try{if(console.log("setDefaultTruss"),n.state.loadFromCache)n.loadTrussFromCache();else{var e=Sn();_e.setNodes(e),_e.sortNodesByCoord(),Ie.firstPlacement(_e.nodesArray,_e.beamsArray)}}catch(t){console.error("setDefaultTruss",t),t.message?alert(t.message):alert(t)}},n.cacheTruss=function(){var e=Ie.toString(_e),t=e.beamsJSON,o=e.nodesJSON;localStorage.setItem(n.nodesCacheName,o),localStorage.setItem(n.beamsCacheName,t)},n.loadTrussFromCache=Object(Z.a)(Q.a.mark(function e(){var t,o,r,a,i;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem(n.nodesCacheName),o=localStorage.getItem(n.beamsCacheName),!t||!o){e.next=10;break}return e.next=5,Ie.parse(t,o);case 5:r=e.sent,a=r.nodes,i=r.beams,_e.setNodes(a),_e.setBeams(i);case 10:case"end":return e.stop()}},e)})),n.clearTruss=Object(Z.a)(Q.a.mark(function e(){return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.setState({loadFromCache:!1});case 2:return localStorage.removeItem(n.nodesCacheName),localStorage.removeItem(n.beamsCacheName),e.next=6,_e.clear();case 6:n.setDefaultTruss();case 7:case"end":return e.stop()}},e)})),n.state={calculation:!1,calculated:!1,loadFromCache:!1},n}return Object(T.a)(t,e),Object(p.a)(t,[{key:"componentWillMount",value:function(){localStorage.getItem(this.nodesCacheName)&&localStorage.getItem(this.beamsCacheName)&&this.setState({loadFromCache:!0})}},{key:"componentDidMount",value:function(){this.setDefaultTruss()}},{key:"render",value:function(){return i.createElement($t,Object.assign({},this.state,this,{farm:_e}))}}]),t}(i.Component))||wt,Sn=function(){return Ie.createNodes([{x:0,y:1e3,fixation:h.XY},{x:3e3,y:1e3,fixation:h.Y}],[{x:1e3,y:1e3,forceY:9e3}],[])},_n=xn,In=function(e){function t(){return Object(u.a)(this,t),Object(U.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.createElement(i.Fragment,null,i.createElement(z.a,{htmlAttributes:{leng:"en"},titleTemplate:"Truss - %s",defaultTitle:m.str.title,link:[{rel:"shortcut icon",href:m.img.bridgeIcon_2},{rel:"image_src",href:m.img.airBridge},{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500"},{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}],meta:[{charSet:"utf-8"},{name:"viewport",content:"minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no"},{name:"theme-color",content:"#000000"},{name:"description",content:m.str.description},{property:"og:type",content:"website"},{property:"og:title",content:m.str.title},{property:"og:image",content:m.img.airBridge},{property:"vk:image",content:m.img.airBridge},{property:"twitter:image",content:m.img.airBridge},{property:"og:url",content:m.str.url}]}),i.createElement(A.a,null),i.createElement(L.a,{theme:y},i.createElement(M.c,null,i.createElement(M.a,{path:G,component:q,exact:!0}),i.createElement(M.a,{path:R,component:_n}))))}}]),t}(i.Component);n(416);l.a.render(c.a.createElement(function(){return c.a.createElement(D.a,null,c.a.createElement(In,null))},null),document.getElementById("root"))}},[[235,1,2]]]);
//# sourceMappingURL=main.ca59df4d.chunk.js.map