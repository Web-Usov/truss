{"version":3,"sources":["static/images/ogImage.png","static/images/icon.png","static/images/bridge.png","static/images/airBridge.png","static/images/fixation.svg","static/const.ts","utils/UI.ts","utils/history.ts","models/Farm/ModelNode.ts","static/colors.ts","utils/math.ts","store/farm/farmReducer.ts","store/farm/farmTypes.ts","models/Farm/ModelEntity.ts","models/Farm/ModelForce.ts","models/Farm/ModelBeam.ts","store/home/homeActions.ts","store/home/homeTypes.ts","store/home/homeReducer.ts","store/index.ts","pages/Farm/components/UIFarmEntities/UINode.tsx","pages/Farm/components/UIFarmEntities/UIBeam.tsx","pages/Farm/components/UIFarmEntities/UIGrid.tsx","pages/Farm/components/UIFarmEntities/UIStage.tsx","components/sidebar.tsx","components/appBar.tsx","components/myToggleButton.tsx","pages/Farm/components/UIHeader.tsx","pages/Farm/components/UITreePanel.tsx","models/Farm/ModelFarm.ts","pages/Farm/components/UIEntityInfo.tsx","pages/Farm/components/UIToolPanel.tsx","pages/Farm/components/UIFarm.tsx","pages/Farm/index.ts","pages/Farm/FarmContainer.tsx","pages/Farm/_testFarm.ts","navigation/index.ts","pages/Home/components/homeHeader.tsx","pages/Home/home.tsx","pages/Home/index.ts","App.tsx","index.tsx"],"names":["module","exports","__webpack_require__","p","r","__webpack_exports__","__dirname","d","url","title","description","favicon","UI_cellSize","UI_nodeSize","UI_beamSize","MMinCell","SizeKoef","sidebarWidth","canvasWidth","canvasHeight","path__WEBPACK_IMPORTED_MODULE_0__","path__WEBPACK_IMPORTED_MODULE_0___default","n","_images_ogImage_png__WEBPACK_IMPORTED_MODULE_1__","_images_ogImage_png__WEBPACK_IMPORTED_MODULE_1___default","a","_images_icon_png__WEBPACK_IMPORTED_MODULE_2__","_images_icon_png__WEBPACK_IMPORTED_MODULE_2___default","_images_bridge_png__WEBPACK_IMPORTED_MODULE_3__","_images_bridge_png__WEBPACK_IMPORTED_MODULE_3___default","_images_airBridge_png__WEBPACK_IMPORTED_MODULE_4__","_images_airBridge_png__WEBPACK_IMPORTED_MODULE_4___default","_images_fixation_svg__WEBPACK_IMPORTED_MODULE_5__","_images_fixation_svg__WEBPACK_IMPORTED_MODULE_5___default","process","path","resolve","UIModes","createBrowserHistory","NodeFixation","theme","createMuiTheme","palette","primary","dark","main","light","secondary","background","default","getNodeColor","node","isStatic","fixation","colors","fixedNode","staticNode","getNodeStorkeColor","mode","move","addBeam","addBeamStart","getNodeStorkeWidth","getBeamColor","beam","nodeMouseEnter","e","stage","target","getStage","delete","container","style","cursor","none","nodeMouseLeave","beamMouseEnter","beamMouseLeave","mainBackGround","MyMath","x1","y1","x2","y2","Math","atan2","PI","sqrt","pow","x","round","consts","y","b","rowsA","length","rowsB","colsA","colsB","result","Error","i","row","j","push","k","sum","MathJs","error","console","defaultState","nodes","beams","forces","reducer","state","arguments","undefined","action","type","Object","objectSpread","concat","toConsumableArray","force","map","item","id","filter","createEntity","props","name","angle","newX","newY","withNewPosition","entity","uuid","createForce","nodeID","value","createBeam","startConnectedNodeID","endConnectedNodeID","endX","endY","instanceOfBeam","object","createNode","beamsID","forceX","forceY","isFixed","None","instanceOfNode","setTitle","defaultHomeState","mainReducer","combineReducers","farm","FarmReducer","home","HomeReducer","createStore","applyMiddleware","thunk","size","UINode","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","viewForce","bind","assertThisInitialized","nextProps","selected","react","ReactKonva","points","stroke","UI","grey","strokeWidth","shadowBlur","pointerLength","pointerWidth","hitStrokeWidth","rotation","text","radius","fill","_this2","_this$props","onClick","_useStrictMode","_onClick","_x","apply","toString","X","viewFixation","Y","XY","YX","align","fontSize","fontFamily","width","verticalAlign","onDragEnd","to","draggable","onMouseEnter","onMouseLeave","onDragMove","drag","React","UIBeam","_this$props2","ReactKonvaCore","UIGrid","_ref","widthCell","heightCell","heightBox","widthBox","countOfX","countOfY","columns","index","key","viewColumns","rows","viewRows","withStyles","createStyles","root","backgroundColor","display","alignItems","justifyContent","boxShadow","shadows","borderRadius","classes","stageHeight","stageWidth","onMouseMove","onDrag","uiMode","selectedEntity","lib_default","autoHide","Box","height","className","ref","UIFarmEntities_UIGrid","UIFarmEntities_UIBeam","UIFarmEntities_UINode","Sidebar","open","viewTooltip","switchDrawer","localState","localStorage","getItem","setState","setItem","flag","children","btnIcon","anchor","_this$state","Drawer","drawer","variant","paper","drawerPaper","toolbar","Typography","Divider","Tooltip","onOpen","changeViewtooltip","onClose","Fab","left","right","color","toogleIcon","Close","position","top","spacing","zIndex","padding","mixins","appBar","logo","marginRight","marginLeft","& img","_ref$withLogo","withLogo","AppBar","clsx","Toolbar","react_router_dom","alt","src","bridgeIcon_2","viewLogo","btn","border","fade","active","transition","transitions","create","duration","short","contrastText","&$selected","&:hover","@media (hover: none)","&$disabled","icon","other","objectWithoutProperties","ToggleButton","assign","defineProperty","grow","flexGrow","_ref$hundleSave","hundleSave","alert","_ref$hundleClear","hundleClear","_ref$hundleCalculate","hundleCalculate","_ref$disabled","disabled","Button","UITreePanel","tabs","Map","openTab","viewListItem","set","tab","get","entityArray","onSelect","ListItem","button","ListItemIcon","Badge","badgeContent","ListItemText","ExpandLess","ExpandMore","Collapse","in","timeout","unmountOnExit","List","component","disablePadding","nested","Brightness1","sort","sidebar","esm_List","GpsNotFixed","Timeline","paddingLeft","Farm","createClass","find","getBeamLength","checkingBeam","lengthBePoints","_beams","nodesMap","forEach","startNode","endNode","numsA","split","numA","Number","numsB","_nodes","setNodesName","setBeamsName","sortNodes","FarmCalc","_init","asyncToGenerator","regenerator_default","mark","_callee","farmNodes","farmBeams","farmNodesMap","farmBeamsMap","area","ModUpr","zKoef","NodeCoord","NodeV","Forces","LinkNodes","LinkLength","Kmest","Lambda0","Lambda","Kobs","IndexV","K","Va","Vi","Vij","V","P","nodeVindex","N_Link","N_Nodes","N_DOF","_args","wrap","_context","prev","next","modUpr","nums","beamLength","Kmest_i","l_i","Lambda_i","Kobs_i","IndexV_i","max","SquareRoot","V_i","P_i","farmCalcDebug","log","abrupt","t0","stop","_x2","length_i","mnoz","nodeCoordOfX","nodeCoordOfY","LTxL","_LTxL","augmnet1","augment2","Array","prototype","_ref2","nodeV1","nodeV2","n_dof","indexV","k_obs","t","A","B","_a","_b","s","signum","abs","l","SDSsum","nodeV","vi","q","linkNodes","vij","n_start","n_ends","multMatrxiV2","v","FarmFactory","_fixedNodes","_staticNodes","_node","TextRow","TextRows","str","UIEntityInfo","UIEntityInfo_TextRows","UIEntityInfo_TextRow","onDelete","viewForceInfo","viewFixationInfo","btnGroup","IconButton","aria-label","Delete","NodeInfo","BeamInfo","Info","viewInfo","marginBottom","marginTop","bottom","transform","modsBtnGroup","mods","mod","ZoomOutMap","addNode","MyLocation","Power","Paper","ToggleButtonGroup","exclusive","onChange","myToggleButton","UIFarm","paintEntity","UIonClick","UIonDrag","UIonMouseMove","onKeyHandle","selectEntity","clearFarm","deleteEntity","saveFarm","calculateFarm","current","attrs","parentElement","scrollTop","scrollHeight","offsetHeight","scrollLeft","scrollWidth","offsetWidth","calculation","isEmptyPlace","evt","preventDefault","_e$evt","layerX","layerY","cellX","cellY","connectedBeam","connectBeamToNode","_this$state2","_e$evt2","moveBeam","defaultPrevented","_e$evt3","moveNode","deletePaintEntity","window","confirm","defautlFarm","_this$state3","react_stats","isActive","esm","keyEventName","keyValue","components_UIHeader","stageBox","components_UITreePanel","UIFarmEntities_UIStage","components_UIEntityInfo","components_UIToolPanel","setSelectedMode","overflow","flexDirection","FarmPage","_React$Component","FarmContainer","options","_beam","place","moveEntity","includes","findOldBeam","moveBeamEnd","addForceToNode","_y","_Farm$update","update","upNodes","upBeams","inherits","nodesJSON","beamsJSON","JSON","parse","_calculateFarm","_Farm$normalize","normalize","init","sent","link","message","_farm","createNodes","removeItem","_farm2","firstPlacement","stringify","components_UIFarm","navPath","descripton","Link","Home","homeHeader","minHeight","connect","dispatch","bindActionCreators","homeActions","App","Helmet_default","htmlAttributes","leng","titleTemplate","defaultTitle","rel","href","airBridge","meta","charSet","content","property","CssBaseline","ThemeProvider","react_router","exact","ReactDOM","render","react_default","createElement","es","store","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.5be83ee2.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/ogImage.0619e300.png\";","module.exports = __webpack_public_path__ + \"static/media/icon.68e274b2.png\";","module.exports = __webpack_public_path__ + \"static/media/bridge.e53bced3.png\";","module.exports = __webpack_public_path__ + \"static/media/airBridge.7d581a65.png\";","module.exports = __webpack_public_path__ + \"static/media/fixation.dd261ca6.svg\";","// import favicon from './images/favicon.ico'\r\nimport path from 'path'\r\nimport ogImage from './images/ogImage.png'\r\nimport bridgeIcon_1 from './images/icon.png'\r\nimport bridgeIcon_2 from './images/bridge.png'\r\nimport airBridge from './images/airBridge.png'\r\nimport FixationIcon from './images/fixation.svg'\r\n\r\n// Strings\r\nexport const url = process.env.PUBLIC_URL\r\nexport const title = \"Truss - ферма для каждого\"\r\nexport const description = \"Ферма (farm или truss) — стержневая система в строительной механике, остающаяся геометрически неизменяемой после замены её жёстких узлов шарнирными.\"\r\nexport const favicon = path.resolve(__dirname,\"favicon.ico\")\r\n\r\n// UI\r\nexport const UI_cellSize = 45\r\nexport const UI_nodeSize = UI_cellSize / 3\r\nexport const UI_beamSize = UI_cellSize / 7\r\nexport const MMinCell = 200\r\nexport const SizeKoef = MMinCell/UI_cellSize\r\n\r\nexport const sidebarWidth = 240\r\nexport const canvasWidth  = 2500\r\nexport const canvasHeight = 1500\r\n\r\n\r\n// Images\r\nexport {\r\n    ogImage,\r\n    bridgeIcon_1,\r\n    bridgeIcon_2,\r\n    airBridge,\r\n    FixationIcon\r\n}","import { FarmNode } from \"src/models/Farm/ModelNode\";\r\nimport { colors } from \"src/static\";\r\nimport { Beam } from \"src/models/Farm/ModelBeam\";\r\nimport Konva from \"konva\";\r\nimport { Stage } from \"konva/types/Stage\";\r\nimport { createMuiTheme } from \"@material-ui/core\";\r\n\r\nexport enum UIModes {\r\n    none,\r\n    move,\r\n    addNode,\r\n    addBeam,\r\n    addBeamStart,\r\n    delete\r\n}\r\nexport const theme = createMuiTheme({\r\n    palette: {\r\n        primary: {\r\n            dark:\"#0A4467\",\r\n            main: \"#1e779e\",\r\n            light:'#51A8D6'\r\n        },\r\n        secondary: {\r\n            dark: \"#a83e19\",\r\n            main: \"#f15a24\",\r\n            light: \"#F39B7C\",\r\n            // light:\"#f0965d\"\r\n        },\r\n        background:{\r\n            default:'linear-gradient(35deg, #6863bf 0%, #067d93 50%, #e68a68 100%)'\r\n        }  \r\n        \r\n    },\r\n});\r\nexport const getNodeColor = (node: FarmNode):string => {\r\n    \r\n    if (node.isStatic) {\r\n        if (node.fixation) return colors.fixedNode\r\n        return colors.staticNode\r\n    }\r\n    return colors.node\r\n}\r\nexport const getNodeStorkeColor = (node: FarmNode, mode : UIModes):string => {\r\n    switch (mode) {\r\n        case UIModes.move: {\r\n            if (node.isStatic) return theme.palette.secondary.dark\r\n            return theme.palette.primary.light\r\n        }\r\n        case UIModes.addBeam:\r\n        case UIModes.addBeamStart: {\r\n            return theme.palette.primary.light\r\n        }\r\n        default:\r\n            return theme.palette.secondary.main\r\n    }\r\n}\r\nexport const getNodeStorkeWidth = (node: FarmNode, mode : UIModes): number =>  {\r\n    switch (mode) {\r\n        case UIModes.move: {\r\n            if (node.isStatic) return 0\r\n            return 2\r\n        }\r\n        case UIModes.addBeam:\r\n        case UIModes.addBeamStart: {\r\n            return 2\r\n        }\r\n        default:\r\n            return 0\r\n    }\r\n}\r\n\r\nexport const getBeamColor = (beam : Beam) : string => {\r\n    return colors.beam\r\n}\r\n\r\n\r\nexport const nodeMouseEnter = (e: Konva.KonvaEventObject<MouseEvent>, node:FarmNode, mode: UIModes):void => {\r\n    const stage: typeof Stage & Konva.Stage = e.target.getStage()\r\n    switch (mode) {\r\n        case UIModes.delete:\r\n            if (node.isStatic) {\r\n                stage.container().style.cursor = 'default'\r\n                break\r\n            }\r\n            stage.container().style.cursor = 'pointer'\r\n            break\r\n        case UIModes.none: {\r\n            stage.container().style.cursor = 'pointer'\r\n            break;\r\n        }\r\n\r\n        case UIModes.addBeam:\r\n        case UIModes.addBeamStart: {\r\n            stage.container().style.cursor = 'crosshair'\r\n            break\r\n        }\r\n        case UIModes.move: {\r\n            if (node.isStatic) {\r\n                stage.container().style.cursor = 'default'\r\n                break\r\n            }\r\n            stage.container().style.cursor = 'move'\r\n            break\r\n        }\r\n\r\n        default: {\r\n            break;\r\n        }\r\n    }\r\n\r\n}\r\nexport const nodeMouseLeave = (e: Konva.KonvaEventObject<MouseEvent>):void => {\r\n    const stage: typeof Stage & Konva.Stage = e.target.getStage()\r\n    if (stage) stage.container().style.cursor = 'default'\r\n}\r\n\r\nexport const beamMouseEnter = (e: Konva.KonvaEventObject<MouseEvent>, beam:Beam, mode: UIModes) :void =>  {\r\n    const stage: typeof Stage & Konva.Stage = e.target.getStage()\r\n\r\n    switch (mode) {\r\n        case UIModes.delete:\r\n        case UIModes.none: {\r\n            stage.container().style.cursor = 'pointer'\r\n            break\r\n        }\r\n\r\n        default: {\r\n            break\r\n        }\r\n    }\r\n\r\n}\r\nexport const beamMouseLeave = (e: Konva.KonvaEventObject<MouseEvent>) :void => {\r\n    const stage: typeof Stage & Konva.Stage = e.target.getStage()\r\n    if (stage) stage.container().style.cursor = 'default'\r\n}","import {createBrowserHistory} from 'history';\r\n\r\nexport default createBrowserHistory();","import { IEntity, Entity, createEntity } from './ModelEntity';\r\nimport { Force } from './ModelForce';\r\n\r\nexport enum NodeFixation {\r\n    None = 0,\r\n    X = 1,\r\n    Y = 2,\r\n    XY = 3,\r\n    YX = XY\r\n\r\n}\r\nexport interface INode extends IEntity {\r\n    beamsID?: string[]\r\n    forceX?: Force,\r\n    forceY?: Force,\r\n    isStatic?: boolean\r\n    fixation?: NodeFixation\r\n}\r\n\r\nexport interface FarmNode extends Entity {\r\n    beamsID: string[];\r\n    forceX: Force | undefined\r\n    forceY: Force | undefined\r\n    isStatic: boolean\r\n    fixation: NodeFixation\r\n}\r\n\r\nexport const createNode = (props: INode = {}): FarmNode => {\r\n    const { beamsID, forceX, forceY, isStatic, fixation: isFixed } = props\r\n    const entity = createEntity(props)\r\n    const node: FarmNode = {\r\n        ...entity,\r\n        type: \"node\",\r\n        beamsID: beamsID || [],\r\n        forceX: forceX,\r\n        forceY: forceY,\r\n        isStatic: isStatic || false,\r\n        fixation: isFixed || NodeFixation.None\r\n    }\r\n    return node\r\n}\r\nexport const instanceOfNode = (object: any): object is FarmNode => object && object.type === 'node'","import { theme } from \"src/utils/UI\";\r\n\r\nexport const mainBackGround = \"#09B4D3\"\r\n\r\nexport const node = theme.palette.secondary.main\r\nexport const staticNode = theme.palette.secondary.light\r\nexport const fixedNode = theme.palette.secondary.dark\r\n\r\nexport const beam = theme.palette.secondary.light","import { consts } from \"src/static\";\r\nimport * as MathJs from 'mathjs'\r\n\r\nclass MyMath {\r\n    static angleBePoints(x1: number, y1: number, x2: number, y2: number): number {\r\n        return Math.atan2(-y1 + y2, -x1 + x2) / (Math.PI)\r\n    }\r\n\r\n    static lengthBePoints(x1: number, y1: number, x2: number, y2: number): number {\r\n        return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2))\r\n    }\r\n\r\n    static cellX(x: number): number {\r\n        return Math.round(x / consts.UI_cellSize) * consts.UI_cellSize\r\n    }\r\n    static cellY(y: number): number {\r\n        return Math.round(y / consts.UI_cellSize) * consts.UI_cellSize\r\n    }\r\n    static signum(x: number) {\r\n        if (x > 0) return 1\r\n        else if (x < 0) return -1\r\n        else return 0\r\n    }\r\n    static multMatrxi(a: number[][], b: number[][]) {\r\n        const rowsA = a.length\r\n        const rowsB = b.length\r\n        const colsA = a[0].length\r\n        const colsB = b[0].length\r\n        const result: number[][] = []\r\n        if (colsA !== rowsB) throw new Error(\"Размерность матриц не позволяет переумножить их\")\r\n\r\n        for (let i = 0; i < rowsA; i++) {\r\n            const row: number[] = []\r\n            for (let j = 0; j < colsB; j++) {\r\n                row.push(0)\r\n            }\r\n            result.push(row)\r\n        }\r\n        for (let k = 0; k < colsB; k++) {\r\n            for (let i = 0; i < rowsA; i++) {\r\n                let sum = 0\r\n                for (let j = 0; j < rowsB; j++)\r\n                    sum += a[i][j] + b[j][k]\r\n                result[i][k] = sum\r\n            }\r\n        }\r\n        // console.log(result);\r\n        return result\r\n\r\n    }\r\n    static multMatrxiV2(a: number[][], b: number[][]) : number[][]{\r\n        let result: number[][] = []\r\n        try {\r\n            result = (MathJs.multiply(a,b) as number[][])\r\n            \r\n        } catch (error) {\r\n            console.error(\"multMatrxiV2:\", error);\r\n        }        \r\n        return result\r\n    }\r\n}\r\n\r\n\r\nexport default MyMath","\r\nimport * as FarmTypes from './farmTypes'\r\nimport { Beam } from 'src/models/Farm/ModelBeam';\r\nimport { Force } from 'src/models/Farm/ModelForce';\r\nimport { FarmNode } from 'src/models/Farm/ModelNode';\r\n\r\nexport interface IFarmStore {\r\n    nodes:FarmNode[],\r\n    beams:Beam[],\r\n    forces:Force[]\r\n}\r\n\r\nexport const defaultState: IFarmStore = {\r\n    nodes:[],\r\n    beams:[],\r\n    forces:[]\r\n}\r\n\r\nexport const reducer = (state: IFarmStore = defaultState, action: FarmTypes.FarmActions): IFarmStore => {\r\n    switch (action.type) {\r\n        // Add\r\n        case FarmTypes.ADD_NODE : {\r\n            const {node} = action\r\n            return {\r\n                ...state,\r\n                nodes : [\r\n                    ...state.nodes,\r\n                    node\r\n                ]\r\n            }\r\n            \r\n        }\r\n        case FarmTypes.ADD_BEAM : {\r\n            const {beam} = action\r\n            return {\r\n                ...state,\r\n                beams : [\r\n                    ...state.beams,\r\n                    beam\r\n                ]\r\n            }            \r\n        }\r\n        case FarmTypes.ADD_FORCE : {\r\n            const {force} = action\r\n            return {\r\n                ...state,\r\n                forces : [\r\n                    ...state.forces,\r\n                    force\r\n                ]\r\n            }            \r\n        }\r\n        // Edit\r\n        case FarmTypes.EDIT_NODE : {\r\n            return {\r\n                ...state,\r\n                nodes : state.nodes.map(item => {\r\n                    if(item.id === action.node.id){      \r\n                        // const node : Node = {\r\n                        //     ...item,\r\n                        //     ...action.node\r\n                        // }\r\n                        return {\r\n                                ...item,\r\n                                ...action.node\r\n                            }\r\n                    }\r\n                    return item\r\n                })\r\n            }            \r\n        }\r\n        case FarmTypes.EDIT_BEAM : {\r\n            return {\r\n                ...state,\r\n                beams : state.beams.map(item => {\r\n                    if(item.id === action.beam.id){ \r\n                        return {\r\n                            ...item,\r\n                            ...action.beam\r\n                        }   \r\n                    }\r\n                    return item\r\n                })\r\n            }            \r\n        }\r\n        // Delete\r\n        case FarmTypes.DELETE_ENTITY : {\r\n            return {\r\n                beams : state.beams.filter(item => item.id !== action.id),\r\n                nodes : state.nodes.filter(item => item.id !== action.id),\r\n                forces : state.forces.filter(item => item.id !== action.id),\r\n            }            \r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n","import { Action } from \"redux\";\r\nimport {  Beam } from \"src/models/Farm/ModelBeam\";\r\nimport {  FarmNode } from \"src/models/Farm/ModelNode\";\r\nimport { Force } from \"src/models/Farm/ModelForce\";\r\n\r\nexport const DELETE_EN = \"DELETE_EN\"\r\nexport const ADD_NODE = \"ADD_NODE\"\r\nexport const ADD_BEAM = \"ADD_BEAM\"\r\nexport const ADD_FORCE = \"ADD_FORCE\"\r\nexport const DELETE_ENTITY = \"DELETE_ENTITY\"\r\nexport const EDIT_NODE = \"EDIT_NODE\"\r\nexport const EDIT_BEAM = \"EDIT_BEAM\"\r\n\r\n// Add\r\nexport interface ActionAddNode extends Action {    \r\n    type: typeof ADD_NODE,\r\n    node:FarmNode\r\n}\r\nexport interface ActionAddBeam extends Action {    \r\n    type: typeof ADD_BEAM,\r\n    beam:Beam\r\n}\r\nexport interface ActionAddForce extends Action {    \r\n    type: typeof ADD_FORCE,\r\n    force:Force\r\n}\r\n// Delete\r\nexport interface ActionDeleteEntity extends Action {    \r\n    type: typeof DELETE_ENTITY,\r\n    id:string\r\n}\r\n// Edit\r\nexport interface ActionEditNode extends Action {    \r\n    type: typeof EDIT_NODE,\r\n    node:FarmNode\r\n}\r\nexport interface ActionEditBeam extends Action {    \r\n    type: typeof EDIT_BEAM,\r\n    beam:Beam\r\n}\r\n\r\nexport type FarmActions = (\r\n    ActionAddNode | \r\n    ActionAddBeam |\r\n    ActionAddForce |\r\n    ActionDeleteEntity |\r\n    ActionEditNode | \r\n    ActionEditBeam\r\n);","import uuid from 'uuid'\r\n\r\nexport interface IEntity {\r\n    id?: string\r\n    x?: number\r\n    y?: number\r\n    angle?: number\r\n    name?: string\r\n    newX?: number\r\n    newY?: number\r\n    type?:'entity' | 'node' | 'beam' | 'force',\r\n    withNewPosition?: boolean\r\n}\r\nexport interface Entity {    \r\n    id: string\r\n    x: number;\r\n    y: number;\r\n    angle: number;\r\n    name: string;\r\n    newX: number;\r\n    newY: number;\r\n    type:'entity' | 'node' | 'beam' | 'force',\r\n    withNewPosition:boolean\r\n}\r\n\r\nexport const createEntity = (props:IEntity = {}) :Entity => {\r\n    const { x, y, name, angle, id, newX, newY, type, withNewPosition } = props\r\n    const entity : Entity =  {\r\n        id: id || uuid(),\r\n        x: x || 0,\r\n        y: y || 0,\r\n        angle: angle || 0,\r\n        name: name || \"\",\r\n        newX: newX || x || 0,\r\n        newY: newY || y || 0,\r\n        type:type || 'entity',\r\n        withNewPosition: withNewPosition || false\r\n    }\r\n    entity.name = name || entity.id\r\n    return entity\r\n\r\n}\r\nexport const instanceOfEntity = (object: any): object is Entity => object && object.type === 'entity';","import { IEntity, Entity, createEntity } from \"./ModelEntity\";\r\n\r\nexport interface IForce extends IEntity {\r\n    value?: number,\r\n    angle?: 0 | 90,\r\n    nodeID?: string\r\n}\r\n\r\nexport interface Force extends Entity {\r\n    value: number\r\n    angle: 0 | 90\r\n    nodeID: string\r\n}\r\nexport const createForce = (props: IForce = {}): Force => {\r\n    const {  angle, nodeID, value } = props\r\n    const entity = createEntity(props)\r\n    const force : Force =  {\r\n        ...entity,\r\n        type:\"force\",\r\n        angle: angle || 0,\r\n        nodeID: nodeID || \"\",\r\n        value: value || 0\r\n    }\r\n    return force\r\n}\r\nexport const instanceOfForce = (object: any): object is Force => object && object.type === 'force';","import { IEntity, Entity, createEntity } from \"./ModelEntity\";\r\n\r\nexport interface IBeam extends IEntity {\r\n    length?: number\r\n    startConnectedNodeID?: string\r\n    endConnectedNodeID?: string\r\n    endX?: number,\r\n    endY?: number\r\n}\r\n\r\nexport interface Beam extends Entity {\r\n    length: number\r\n    startConnectedNodeID: string | undefined\r\n    endConnectedNodeID: string | undefined\r\n    endX: number\r\n    endY: number\r\n}\r\nexport const createBeam = (props: IBeam = {}): Beam => {\r\n    const { length, startConnectedNodeID, endConnectedNodeID, endX, endY } = props\r\n    const entity = createEntity(props)\r\n    const bram: Beam = {\r\n        ...entity,\r\n        type: \"beam\",\r\n        length: length || 0,\r\n        startConnectedNodeID: startConnectedNodeID,\r\n        endConnectedNodeID: endConnectedNodeID,\r\n        endX: endX || entity.x || 0,\r\n        endY: endY || entity.y || 0,\r\n    }\r\n    return bram\r\n}\r\n\r\n\r\nexport const instanceOfBeam = (object: any): object is Beam => object && object.type === 'beam';\r\n","import { HomeActions, SET_TITLE } from \"./homeTypes\";\r\n\r\nexport const setTitle = (title :string) : HomeActions => ({\r\n    type:SET_TITLE,\r\n    title\r\n})","import { Action } from \"redux\";\r\n\r\nexport const SET_TITLE = 'SET_TITLE'\r\n\r\nexport interface IActionHomeSetTitle extends Action {\r\n    type: typeof SET_TITLE,\r\n    title : string,\r\n}\r\n\r\nexport type HomeActions = IActionHomeSetTitle ;","import { SET_TITLE, HomeActions } from \"./homeTypes\";\r\n\r\nexport interface IHomeStore {\r\n    title: string,\r\n}\r\n\r\nexport const defaultHomeState : IHomeStore = {\r\n    title: 'Hello, world!',\r\n}\r\n\r\nexport const reducer = (state: IHomeStore = defaultHomeState, action: HomeActions): IHomeStore => {\r\n    switch (action.type) {\r\n        case SET_TITLE:\r\n            return {\r\n                ...state,\r\n                title: action.title\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}","import { combineReducers, createStore, applyMiddleware } from 'redux';\r\nimport { FarmReducer, FarmTypes } from './farm';\r\nimport { HomeReducer, HomeTypes } from './home';\r\nimport thunk, { ThunkMiddleware } from 'redux-thunk'\r\n\r\n\r\n\r\nexport const mainReducer = combineReducers({\r\n    farm : FarmReducer.reducer,\r\n    home : HomeReducer.reducer\r\n})\r\n\r\nexport type AppState = ReturnType<typeof mainReducer> \r\nexport type AppActions = FarmTypes.FarmActions | HomeTypes.HomeActions\r\n\r\nexport default createStore(mainReducer, applyMiddleware(thunk as ThunkMiddleware<AppState,AppActions>));\r\n","import * as React from 'react'\r\nimport { Circle,  Text, Group, Arrow, Line } from 'react-konva'\r\nimport Konva from 'konva'\r\nimport { FarmNode, NodeFixation } from 'src/models/Farm/ModelNode';\r\nimport { consts } from 'src/static';\r\nimport { Force } from 'src/models/Farm/ModelForce';\r\nimport { KonvaEventObject } from 'konva/types/Node';\r\nimport { UI } from 'src/utils';\r\nimport { UIModes } from 'src/utils/UI';\r\nimport { SizeKoef } from 'src/static/const';\r\n\r\nconst size = consts.UI_nodeSize\r\ninterface UINodeProps {\r\n    node: FarmNode,\r\n    drag(e: Konva.KonvaEventObject<DragEvent>, node: FarmNode): void\r\n    onClick(e: Konva.KonvaEventObject<MouseEvent>, node: FarmNode): void\r\n    mode: UIModes,\r\n    selected: boolean\r\n}\r\nclass UINode extends React.Component<UINodeProps>{\r\n    constructor(props: UINodeProps) {\r\n        super(props)\r\n        this.viewForce = this.viewForce.bind(this)\r\n    }\r\n    shouldComponentUpdate(nextProps: UINodeProps) {\r\n        return (\r\n            nextProps.node !== this.props.node ||\r\n            nextProps.mode !== this.props.mode ||\r\n            nextProps.selected !== this.props.selected\r\n        )\r\n    }\r\n\r\n    viewForce(force: Force) {\r\n        return (\r\n            <React.Fragment>\r\n\r\n                <Arrow\r\n                    points={[\r\n                        0,\r\n                        0,\r\n                        consts.UI_cellSize,\r\n                        0,\r\n                    ]}\r\n                    stroke={UI.theme.palette.grey[300]}\r\n                    strokeWidth={size / 3}\r\n                    shadowBlur={2}\r\n                    pointerLength={consts.UI_cellSize / 10}\r\n                    pointerWidth={consts.UI_cellSize / 10}\r\n                    hitStrokeWidth={size * 2}\r\n                    rotation={force.value > 0 ? force.angle : 180 + force.angle}\r\n                />\r\n                <Text\r\n                    x={force.angle === 0 ? (force.value > 0 ? consts.UI_cellSize / 3 : -consts.UI_cellSize) : consts.UI_cellSize / 3}\r\n                    y={force.angle === 90 ? (force.value > 0 ? consts.UI_cellSize / 3 : -consts.UI_cellSize / 2) : -consts.UI_cellSize / 1.5}\r\n                    text={force.value + \"H\"}\r\n                />\r\n            </React.Fragment>\r\n\r\n        )\r\n    }\r\n    viewFixation(angle: 0 | 90) {\r\n\r\n        return (<Group\r\n            x={0}\r\n            y={0}\r\n            rotation={angle}\r\n        >\r\n            <Line\r\n                points={[\r\n                    0, 0,\r\n                    0, consts.UI_cellSize,\r\n                    -consts.UI_cellSize / 2, consts.UI_cellSize,\r\n                    consts.UI_cellSize / 2, consts.UI_cellSize,\r\n                ]}\r\n                stroke={UI.theme.palette.grey[300]}\r\n                strokeWidth={size / 4}\r\n                shadowBlur={2}\r\n            />\r\n            <Circle\r\n                radius={size / 2}\r\n                fill={UI.theme.palette.grey[500]}\r\n                x={0}\r\n                y={consts.UI_cellSize - (size / 1.7)}\r\n            />\r\n        </Group>)\r\n    }\r\n    render() {\r\n        const { onClick, mode, selected, node } = this.props\r\n\r\n        return (\r\n            <Group\r\n                x={node.x / SizeKoef}\r\n                y={node.y / SizeKoef}\r\n                _useStrictMode\r\n                onClick={(e: any) => onClick(e, node)}\r\n            >\r\n                {node.forceX && this.viewForce(node.forceX)}\r\n                {node.forceY && this.viewForce(node.forceY)}\r\n                {node.fixation === NodeFixation.X && this.viewFixation(90)}\r\n                {node.fixation === NodeFixation.Y && this.viewFixation(0)}\r\n                {node.fixation === NodeFixation.XY && this.viewFixation(90)}\r\n                {node.fixation === NodeFixation.YX && this.viewFixation(0)}\r\n                <Circle\r\n                    radius={size}\r\n                    x={0}\r\n                    y={0}\r\n                    fill={UI.getNodeColor(node)}\r\n                    shadowBlur={selected ? 8 : 2}\r\n                    stroke={UI.getNodeStorkeColor(node,mode)}\r\n                    strokeWidth={UI.getNodeStorkeWidth(node, mode)}\r\n\r\n                    hitStrokeWidth={size * 2}\r\n                />\r\n                <Text\r\n                    x={-size}\r\n                    y={-size / 2 - 1}\r\n                    align=\"center\"\r\n                    fontSize={18}\r\n                    fill=\"#fff\"\r\n                    shadowBlur={8}\r\n                    // stroke=\"#555\"\r\n                    // strokeWidth={0.1}\r\n                    fontFamily='Trebuchet MS'\r\n                    width={size * 2}\r\n                    verticalAlign=\"middle\"\r\n                    text={node.name}\r\n                />\r\n                <Circle\r\n                    radius={size}\r\n                    x={0}\r\n                    y={0}\r\n                    onDragEnd={(e: KonvaEventObject<DragEvent>) => {\r\n                        e.target.to({\r\n                            x: 0,\r\n                            y: 0,\r\n                        })\r\n                    }}\r\n                    hitStrokeWidth={size * 2}\r\n                    draggable={mode === UIModes.move && !node.isStatic}\r\n                    onMouseEnter={(e: any) => UI.nodeMouseEnter(e, node, mode)}\r\n                    onMouseLeave={(e: any) => UI.nodeMouseLeave(e)}\r\n                    onDragMove={(e: KonvaEventObject<DragEvent>) => this.props.drag(e, node)}\r\n                />\r\n            </Group>\r\n        )\r\n    }\r\n}\r\nexport default UINode","import * as React from 'react'\r\nimport { Line } from 'react-konva/lib/ReactKonvaCore'\r\nimport Konva from 'konva'\r\nimport { Beam } from 'src/models/Farm/ModelBeam';\r\nimport { consts } from 'src/static';\r\nimport { UI } from 'src/utils';\r\nimport { UIModes } from 'src/utils/UI';\r\nimport { SizeKoef } from 'src/static/const';\r\n\r\ninterface UIBeamProps {\r\n    onClick(e: Konva.KonvaEventObject<MouseEvent>, beam: Beam): void\r\n    mode: UIModes,\r\n    selected: boolean,\r\n    beam: Beam\r\n}\r\n\r\nclass UIBeam extends React.Component<UIBeamProps>{\r\n\r\n    shouldComponentUpdate(nextProps: UIBeamProps) {\r\n        const { beam, mode, selected } = this.props\r\n        return (\r\n            nextProps.beam !== beam ||\r\n            nextProps.mode !== mode ||\r\n            nextProps.selected !== selected\r\n        )\r\n    }\r\n    render() {\r\n        const { onClick, mode, selected, beam } = this.props\r\n        const size = consts.UI_beamSize\r\n        return (\r\n            <Line\r\n                points={[\r\n                    beam.x / SizeKoef,\r\n                    beam.y / SizeKoef,\r\n                    beam.endX / SizeKoef,\r\n                    beam.endY / SizeKoef\r\n                ]}\r\n                stroke={UI.getBeamColor(beam)}\r\n                strokeWidth={size}\r\n                shadowBlur={selected ? 8 : 2}\r\n\r\n                hitStrokeWidth={size * 4}\r\n                onClick={(e: any) => onClick(e, beam)}\r\n                onMouseEnter={(e: any) => UI.beamMouseEnter(e,beam, mode)}\r\n                onMouseLeave={(e: any) => UI.beamMouseLeave(e)}\r\n            />\r\n        )\r\n\r\n    }\r\n}\r\nexport default UIBeam","import * as React from 'react'\r\nimport { Line } from 'react-konva'\r\n\r\nexport interface UIGridProps {\r\n    widthCell: number,\r\n    heightCell: number,\r\n    heightBox: number,\r\n    widthBox: number\r\n\r\n}\r\n\r\nconst UIGrid: React.FC<UIGridProps> = ({ widthCell, heightCell, heightBox, widthBox }) => {\r\n    const countOfX: number = widthBox / widthCell\r\n    const countOfY: number = heightBox / heightCell\r\n    const viewRows = () => {\r\n        const rows = []\r\n        for (let index = 0; index < countOfY; index++) {\r\n            rows.push(<Line\r\n                points={[\r\n                    0,\r\n                    index * heightCell,\r\n                    widthBox,\r\n                    index * heightCell,\r\n\r\n                ]}\r\n                stroke=\"#ddd\"\r\n                strokeWidth={1}\r\n                key={index}\r\n            />)\r\n        }\r\n        return rows\r\n    }\r\n\r\n    const viewColumns = () => {\r\n        const columns = []\r\n        for (let index = 0; index < countOfX; index++) {\r\n\r\n            columns.push(<Line\r\n                points={[\r\n                    index*widthCell,\r\n                    0,\r\n                    index*widthCell,\r\n                    heightBox,\r\n\r\n                ]}\r\n                stroke=\"#ddd\"\r\n                strokeWidth={1}\r\n                key={index}\r\n            />)\r\n\r\n        }\r\n        return columns\r\n    }\r\n    return (\r\n        <React.Fragment>\r\n            {viewColumns()}\r\n            {viewRows()}\r\n\r\n        </React.Fragment>\r\n    )\r\n}\r\n\r\nexport default UIGrid","import * as React from 'react'\r\nimport { Theme, createStyles, withStyles, Box } from '@material-ui/core';\r\nimport { WithStyles } from '@material-ui/styles';\r\nimport { Stage, Layer, } from 'react-konva';\r\nimport { Entity } from 'src/models/Farm/ModelEntity';\r\nimport Konva from 'konva';\r\nimport UIGrid from './UIGrid';\r\nimport { consts } from 'src/static';\r\nimport ScrollBar from 'react-custom-scrollbars';\r\nimport { UIBeam, UINode } from '..';\r\nimport { UIModes } from 'src/utils/UI';\r\nimport { IFarm } from 'src/models/Farm/ModelFarm';\r\nimport { sidebarWidth } from 'src/static/const';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    root: {\r\n        backgroundColor: \"#ddd\",\r\n        display:'flex', \r\n        alignItems:'center', \r\n        justifyContent:'center'\r\n    },\r\n    stage: {\r\n        backgroundColor: \"#fff\",\r\n        boxShadow:theme.shadows[2],\r\n        borderRadius:8,\r\n    }\r\n})\r\n\r\nexport interface UIStageProps extends IFarm, WithStyles<typeof styles> {\r\n    uiMode: UIModes,\r\n    selectedEntity: Entity | undefined,\r\n    stageHeight: number,\r\n    stageWidth: number,\r\n    onClick(e: Konva.KonvaEventObject<MouseEvent>, entity?: Entity): void,\r\n    onMouseMove(e: Konva.KonvaEventObject<MouseEvent | TouchEvent>): void,\r\n    onDrag(e: Konva.KonvaEventObject<DragEvent>, entity: Entity): void,\r\n    stage: React.RefObject<Stage & Konva.Stage>\r\n}\r\n\r\nconst UIStage: React.FC<UIStageProps> = ({ classes, stage, stageHeight, stageWidth, onClick, onMouseMove, onDrag, beams, nodes, uiMode, selectedEntity }) => {\r\n    return (\r\n        <ScrollBar\r\n            autoHide>\r\n            <Box style={{width: stageWidth + sidebarWidth*2,height: stageHeight + sidebarWidth }}\r\n                className={classes.root}>\r\n                <Stage\r\n                    height={stageHeight}\r\n                    width={stageWidth}\r\n                    style={{ height: stageHeight, width: stageWidth }}\r\n                    className={classes.stage}\r\n                    onClick={onClick}\r\n                    onMouseMove={onMouseMove}\r\n                    ref={stage}\r\n                >\r\n\r\n                    <Layer className=\"layer\" >\r\n                        \r\n                        <UIGrid\r\n                            heightCell={consts.UI_cellSize}\r\n                            widthCell={consts.UI_cellSize}\r\n                            heightBox={stageHeight}\r\n                            widthBox={stageWidth}\r\n                        />\r\n                        \r\n                        {beams.map(beam => (\r\n                            <UIBeam\r\n                                key={beam.id}\r\n                                beam={beam}\r\n                                mode={uiMode}\r\n                                onClick={onClick}\r\n                                selected={selectedEntity === beam}\r\n                            />\r\n                        ))}\r\n\r\n                        {nodes.map(node => (\r\n                            <UINode\r\n                                key={node.id}\r\n                                node={node}\r\n                                mode={uiMode}\r\n                                drag={onDrag}\r\n                                onClick={onClick}\r\n                                selected={selectedEntity === node}\r\n                            />\r\n                        ))}\r\n                    </Layer>\r\n                </Stage>\r\n            </Box>\r\n\r\n        </ScrollBar>\r\n\r\n\r\n\r\n    )\r\n}\r\n\r\nexport default withStyles(styles)(UIStage)","import * as React from 'react'\r\nimport { Theme, createStyles, withStyles, Fab, Drawer, Tooltip, Typography, Divider } from '@material-ui/core';\r\nimport { WithStyles } from '@material-ui/styles';\r\nimport { Close as CloseIcon } from '@material-ui/icons';\r\nimport { sidebarWidth } from 'src/static/const';\r\n\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    drawer: {\r\n        position: 'relative'\r\n    },\r\n    drawerPaper: {\r\n        width: sidebarWidth,\r\n    },\r\n    toogleIcon: {\r\n        position: 'absolute',\r\n        top: theme.spacing(10),\r\n        zIndex: theme.zIndex.drawer + 1\r\n    },\r\n    title:{\r\n        padding:theme.spacing(1)\r\n    },\r\n    toolbar: theme.mixins.toolbar,\r\n})\r\n\r\n\r\n\r\n\r\ninterface SidebarProps extends WithStyles<typeof styles> {\r\n    anchor: 'left' | 'right',\r\n    title? : string,\r\n    btnIcon : JSX.Element\r\n}\r\n\r\ninterface SidebarState {\r\n    open: boolean,\r\n    viewTooltip: boolean\r\n\r\n}\r\nconst localStr = \"Sidebar_state:\"\r\nclass Sidebar extends React.PureComponent<SidebarProps, SidebarState>{\r\n    constructor(props: SidebarProps) {\r\n        super(props)\r\n        this.state = {\r\n            open: true,\r\n            viewTooltip: false\r\n        }\r\n        this.switchDrawer = this.switchDrawer.bind(this)\r\n    }\r\n    componentWillMount(){\r\n        if(this.props.title){\r\n            const localState = localStorage.getItem(localStr+this.props.title)\r\n            if(localState)\r\n            this.setState({open: localState === \"true\"})\r\n        }\r\n    }\r\n    switchDrawer() {\r\n        localStorage.setItem(localStr+this.props.title,(!this.state.open ? \"true\" : \"false\"))\r\n        this.setState(\r\n            {\r\n                open: !this.state.open,\r\n                viewTooltip: false\r\n            }\r\n        )\r\n    }\r\n    \r\n    changeViewtooltip(flag: boolean) {\r\n        this.setState({ viewTooltip: flag })\r\n    }\r\n    render() {\r\n        const { classes,children, title, btnIcon, anchor } = this.props\r\n        const { open, viewTooltip } = this.state\r\n        return (\r\n            <React.Fragment>\r\n                <Drawer\r\n                    className={classes.drawer}\r\n                    variant=\"persistent\"\r\n                    open={open}\r\n                    anchor={anchor}\r\n                    classes={{\r\n                        paper: classes.drawerPaper,\r\n                    }}\r\n                >\r\n                    <div className={classes.toolbar} />\r\n                    \r\n                    <Typography \r\n                        variant='body2'\r\n                        align=\"center\"\r\n                        className={classes.title}>\r\n                        {title}\r\n                    </Typography>\r\n                    <Divider/>\r\n                    {children}\r\n                </Drawer>\r\n                <Tooltip\r\n                    title={title}\r\n                    open={title !== undefined && viewTooltip && !open}\r\n                    onOpen={() => this.changeViewtooltip(true)}\r\n                    onClose={() => this.changeViewtooltip(false)}>\r\n                    <Fab\r\n                        style={{\r\n                            left: anchor === 'left' ? !open ? 15 : sidebarWidth + 15 : \"auto\",\r\n                            \r\n                            right: anchor === 'right' ? !open ? 15 : sidebarWidth + 15 : \"auto\"\r\n                        }}\r\n                        color=\"secondary\"\r\n                        size=\"medium\"\r\n                        className={classes.toogleIcon}\r\n                        onClick={this.switchDrawer}\r\n                    >\r\n                        {open ? <CloseIcon /> : btnIcon}\r\n                    </Fab>\r\n                </Tooltip>\r\n            </React.Fragment>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default withStyles(styles)(Sidebar)","import * as React from 'react'\r\nimport clsx from 'clsx'\r\nimport { Theme, createStyles, withStyles, AppBar, Toolbar } from '@material-ui/core';\r\nimport { WithStyles } from '@material-ui/styles';\r\nimport { consts } from 'src/static';\r\nimport { Link } from 'react-router-dom';\r\nimport { AppBarProps } from '@material-ui/core/AppBar';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    appBar: {\r\n        zIndex: theme.zIndex.drawer + 1,\r\n    },\r\n    logo: {\r\n        marginRight: theme.spacing(4),\r\n        marginLeft: theme.spacing(2),\r\n        '& img': {\r\n            width: 50,\r\n            height: 'auto'\r\n        }\r\n    }\r\n})\r\n\r\nexport interface UIToolBarProps extends WithStyles<typeof styles>, React.HTMLAttributes<HTMLDivElement> {\r\n    color?: AppBarProps['color'],\r\n    position?: AppBarProps['position'],\r\n    withLogo?: boolean\r\n}\r\n\r\nconst UIAppBar: React.FC<UIToolBarProps> = ({ classes, children, className, color, position, withLogo = true }) => {\r\n    const viewLogo = () => {\r\n        if (withLogo) return ((\r\n            <Link\r\n                to={'/'}\r\n                className={classes.logo}\r\n            >\r\n                <img\r\n                    alt=\"Logo Icon\"\r\n                    src={consts.bridgeIcon_2}\r\n                />\r\n            </Link>\r\n        ))\r\n    }\r\n    return (\r\n        <AppBar\r\n            position={position || 'fixed'}\r\n            className={clsx(classes.appBar, className)}\r\n            color={color || 'primary'}>\r\n            <Toolbar >\r\n                {viewLogo()}\r\n                {children}\r\n            </Toolbar>\r\n        </AppBar>\r\n    )\r\n}\r\n\r\nexport default withStyles(styles)(UIAppBar)","import * as React from 'react'\r\nimport { Theme, createStyles, withStyles, Tooltip } from '@material-ui/core';\r\nimport {  ToggleButton } from '@material-ui/lab'\r\nimport { WithStyles } from '@material-ui/styles';\r\nimport clsx from 'clsx';\r\nimport { fade } from '@material-ui/core/styles';\r\nimport { ToggleButtonProps } from '@material-ui/lab/ToggleButton';\r\n\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    btn: {\r\n        marginLeft: theme.spacing(2),\r\n        marginRight: theme.spacing(2),\r\n        borderRadius: '50% !important',\r\n        border: `1px solid ${fade(theme.palette.action.active, 0.2)} !important`,\r\n        transition: theme.transitions.create(['background-color', 'box-shadow', 'border'], {\r\n            duration: theme.transitions.duration.short,\r\n        }),\r\n\r\n        color: theme.palette.secondary.contrastText,\r\n        backgroundColor: theme.palette.secondary.light,\r\n\r\n        '&$selected': {\r\n            backgroundColor: theme.palette.secondary.main,\r\n            '&:hover': {\r\n                backgroundColor: theme.palette.secondary.dark,\r\n            }\r\n        },\r\n        '&:hover': {\r\n            backgroundColor: theme.palette.secondary.dark,\r\n            '@media (hover: none)': {\r\n                backgroundColor: theme.palette.secondary.main,\r\n            },\r\n            '&$disabled': {\r\n                backgroundColor: theme.palette.secondary.main,\r\n            },\r\n        },\r\n    },\r\n    selected: {},\r\n})\r\n\r\n\r\n\r\nexport interface MyToggleButtonProps extends WithStyles<typeof styles> {\r\n    selected: boolean,\r\n    value?:any,\r\n    name?:string,\r\n    icon:JSX.Element\r\n}\r\n\r\nconst MyToggleButton: React.FC<MyToggleButtonProps & ToggleButtonProps> = ({  selected, classes , value, name, icon, ...other}) => {\r\n    return (\r\n        <ToggleButton\r\n            key={name}\r\n            value={value}\r\n            className={clsx(\r\n                classes.btn,\r\n                {\r\n                    [classes.selected]: selected,\r\n                }\r\n            )}\r\n            {...other}\r\n            \r\n        >\r\n            <Tooltip title={name}>\r\n                {icon}\r\n            </Tooltip>\r\n        </ToggleButton>\r\n    )\r\n}\r\n\r\nexport default withStyles(styles)(MyToggleButton)","import * as React from 'react'\r\nimport { Theme, createStyles, withStyles, Button } from '@material-ui/core';\r\nimport { WithStyles } from '@material-ui/styles';\r\nimport { AppBar } from 'src/components';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    root:{\r\n\r\n    },\r\n    btn:{\r\n        marginLeft:theme.spacing(2),\r\n        marginRight:theme.spacing(2)\r\n    },\r\n    grow:{\r\n        flexGrow:1\r\n    }\r\n})\r\n\r\nexport interface UIHeaderProps extends WithStyles<typeof styles> {\r\n    hundleSave?:(e: React.FormEvent<HTMLButtonElement>) => void,\r\n    hundleClear?:(e: React.FormEvent<HTMLButtonElement>) => void,\r\n    hundleCalculate?:(e: React.FormEvent<HTMLButtonElement>) => void,\r\n    disabled?:boolean\r\n}\r\n\r\nconst UIHeader: React.FC<UIHeaderProps> = (\r\n    { \r\n        classes, \r\n        hundleSave = (e) => {alert(\"Буедет реализовано в будущем\")},\r\n        hundleClear = (e) => {alert(\"Буедет реализовано в будущем\")},\r\n        hundleCalculate = (e) => {alert(\"Буедет реализовано в будущем\")},\r\n        disabled = false\r\n    }) => {\r\n\r\n    return (\r\n        <AppBar \r\n            className={classes.root}\r\n        >\r\n            <div className={classes.grow}/>\r\n            <Button\r\n                color=\"secondary\"\r\n                variant=\"contained\"\r\n                className={classes.btn}\r\n                onClick={hundleCalculate}\r\n                disabled={disabled}\r\n            >\r\n                Расчет\r\n            </Button>\r\n            <Button\r\n                color=\"secondary\"\r\n                variant=\"contained\"\r\n                className={classes.btn}\r\n                onClick={hundleSave}\r\n                disabled={disabled}\r\n            >\r\n                Сохранить\r\n            </Button>\r\n            <Button\r\n                color=\"secondary\"\r\n                variant=\"contained\"\r\n                className={classes.btn}\r\n                onClick={hundleClear}\r\n                disabled={disabled}\r\n            >\r\n                Очистить\r\n            </Button>\r\n        </AppBar>\r\n    )\r\n}\r\n\r\nexport default withStyles(styles)(UIHeader)","import * as React from 'react'\r\nimport { Theme, createStyles, withStyles, List, ListItem, ListItemText, Collapse, ListItemIcon, Divider, Badge, Box } from '@material-ui/core';\r\nimport { WithStyles } from '@material-ui/styles';\r\nimport { GpsNotFixed as NodeIcon, Timeline as BeamIcon, List as TreePanelIcon, ExpandLess, ExpandMore, Brightness1 as CircleIcon } from '@material-ui/icons';\r\nimport { Sidebar } from 'src/components';\r\nimport { Entity } from 'src/models/Farm/ModelEntity';\r\nimport { Beam } from 'src/models/Farm/ModelBeam';\r\nimport { FarmNode, instanceOfNode } from 'src/models/Farm/ModelNode';\r\nimport { UI } from 'src/utils';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    nested: {\r\n        paddingLeft: theme.spacing(6)\r\n    },\r\n})\r\n\r\ninterface TreePanelProps extends WithStyles<typeof styles> {\r\n    nodes: FarmNode[],\r\n    beams: Beam[]\r\n    selectedEntity: Entity | undefined\r\n    onSelect(entity: Entity): void\r\n}\r\n\r\ninterface TreeState {\r\n    tabs: Map<string, boolean>,\r\n    open: boolean,\r\n\r\n}\r\n\r\nclass UITreePanel extends React.PureComponent<TreePanelProps, TreeState>{\r\n    constructor(props: TreePanelProps) {\r\n        super(props)\r\n        this.state = {\r\n            open: false,\r\n            tabs: new Map()\r\n        }\r\n        this.openTab = this.openTab.bind(this)\r\n        this.viewListItem = this.viewListItem.bind(this)\r\n    }\r\n    componentWillMount() {\r\n        const { tabs } = this.state\r\n        tabs.set('Узлы', true)\r\n        tabs.set('Стержни', true)\r\n        this.setState({ tabs: new Map(tabs) })\r\n    }\r\n    openTab(tab: string): void {\r\n        const { tabs } = this.state\r\n        tabs.set(tab, !tabs.get(tab))\r\n        this.setState({ tabs: new Map(tabs) })\r\n    }\r\n    viewListItem(entityArray: Entity[], title: string, icon?: JSX.Element) {\r\n        const { selectedEntity, classes, onSelect } = this.props\r\n        const { tabs } = this.state\r\n        return (\r\n            <Box>\r\n                <ListItem button onClick={() => this.openTab(title)}>\r\n                    {icon && (\r\n                        <ListItemIcon>\r\n                            <Badge badgeContent={entityArray.length} color=\"secondary\">\r\n                                {icon}\r\n                            </Badge>\r\n                        </ListItemIcon>\r\n                    )}\r\n                    <ListItemText primary={title} />\r\n                    {tabs.get(title) ? <ExpandLess /> : <ExpandMore />}\r\n                </ListItem>\r\n                <Collapse in={tabs.get(title)} timeout=\"auto\" unmountOnExit>\r\n                    <List component=\"div\" disablePadding>\r\n                        {entityArray.map(item => (\r\n                            <ListItem\r\n                                button\r\n                                className={classes.nested}\r\n                                key={item.id}\r\n                                selected={selectedEntity === item}\r\n                                onClick={(e) => onSelect(item)}\r\n                            >\r\n                                {instanceOfNode(item) && (\r\n                                    <ListItemIcon>\r\n                                        <CircleIcon style={{ color: UI.getNodeColor(item) }} />\r\n                                    </ListItemIcon>\r\n                                )}\r\n                                <ListItemText primary={item.name} />\r\n                            </ListItem>\r\n                        ))}\r\n                    </List>\r\n                </Collapse>\r\n                <Divider />\r\n            </Box>\r\n        )\r\n    }\r\n    render() {\r\n        const { nodes, beams } = this.props\r\n        beams.sort((a: Beam, b: Beam) => {\r\n            return a.name > b.name ? 1 : -1\r\n        })\r\n        return (\r\n            <Sidebar\r\n                anchor=\"left\"\r\n                title=\"Структура проекта\"\r\n                btnIcon={(<TreePanelIcon />)}\r\n            >\r\n\r\n                {this.viewListItem(nodes, 'Узлы', (<NodeIcon />))}\r\n                {this.viewListItem(beams, 'Стержни', (<BeamIcon />))}\r\n\r\n            </Sidebar>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default withStyles(styles)(UITreePanel)","import { canvasWidth, MMinCell } from './../../static/const';\r\nimport { FarmNode, NodeFixation, createNode, INode } from \"./ModelNode\";\r\nimport { Beam, IBeam, createBeam, instanceOfBeam } from \"./ModelBeam\";\r\nimport { createForce } from \"./ModelForce\";\r\nimport { Entity } from \"./ModelEntity\";\r\nimport uuid from 'uuid'\r\nimport { MyMath } from \"src/utils\";\r\nimport { consts } from 'src/static';\r\n\r\n\r\n\r\n\r\nexport interface IFarm {\r\n    nodes: FarmNode[],\r\n    beams: Beam[]\r\n}\r\nexport interface ICoord {\r\n    x: number,\r\n    y: number\r\n}\r\ninterface IFixedNodeCreate extends ICoord {\r\n    fixation: NodeFixation\r\n}\r\ninterface IStaticNodeCreate extends ICoord {\r\n    angle: 0 | 90\r\n    value: number\r\n}\r\ninterface ISimpleNodeCreate extends ICoord {\r\n\r\n}\r\n\r\nexport interface CalcData {\r\n    P: number[][][],\r\n    Vi: ICoord[],\r\n    LinkNodes: ICoord[],\r\n}\r\nexport class Farm {\r\n    static addNode(nodes: FarmNode[], props: INode): FarmNode | null {\r\n        if (nodes.length > 12) return null\r\n        const {x, y} = props\r\n        const oldNode = nodes.find(item => item.x === x && item.y === y)\r\n        if (oldNode) return null\r\n        const id = uuid()\r\n        if (!id) return null\r\n        const name = (nodes.length + 1) + \"\"\r\n        const node = createNode({\r\n            ...props,\r\n            x,\r\n            y,\r\n            name: props.name || name,\r\n            id,\r\n        })\r\n        return node\r\n    }\r\n    static addBeam(beams: Beam[], props: IBeam): Beam | null {\r\n        if (beams.length > 36) return null\r\n        let x = props.x\r\n        let y = props.y\r\n        if (props.x && props.y) {\r\n            x = props.x\r\n            y = props.y\r\n        }\r\n        const id = uuid()\r\n        if (!id) return null\r\n        const beam = createBeam({\r\n            ...props,\r\n            x,\r\n            y,\r\n            id,\r\n        })\r\n        return beam\r\n    }\r\n    static moveEntity(entity: Entity, x: number, y: number) {\r\n\r\n        entity.x = x\r\n        entity.y = y\r\n        if (instanceOfBeam(entity)) {\r\n            entity.length = this.getBeamLength(entity)\r\n        }\r\n    }\r\n    static moveBeamEnd(beam: Beam, x: number, y: number) {\r\n        beam.endX = x\r\n        beam.endY = y\r\n        beam.length = this.getBeamLength(beam)\r\n    }\r\n\r\n    static findOldBeam(node: FarmNode, beam: Beam, checkingBeam: Beam) {\r\n        return (\r\n            (checkingBeam.startConnectedNodeID === beam.startConnectedNodeID && checkingBeam.endConnectedNodeID === node.id) ||\r\n            (checkingBeam.startConnectedNodeID === node.id && checkingBeam.endConnectedNodeID === beam.startConnectedNodeID) ||\r\n            (checkingBeam.id === beam.id && checkingBeam.startConnectedNodeID === node.id)\r\n        )\r\n    }\r\n    static getBeamLength(beam: Beam): number {\r\n        return Math.round(MyMath.lengthBePoints(beam.x, beam.y, beam.endX, beam.endY) - 0.5)\r\n    }\r\n    static setNodesName(nodes: FarmNode[]) {\r\n        return nodes.map((node, index) => ({ ...node, name: (index + 1) + \"\" }))\r\n    }\r\n    static setBeamsName(_beams: Beam[], nodes: FarmNode[]): Beam[] {\r\n\r\n        const nodesMap: Map<string, FarmNode> = new Map()\r\n        nodes.forEach(node => {\r\n            nodesMap.set(node.id, node)\r\n        })\r\n        let name: string = \"\"\r\n\r\n        let beams = _beams.map(beam => {\r\n            if (!beam.startConnectedNodeID || !beam.endConnectedNodeID) return beam\r\n            const startNode = nodesMap.get(beam.startConnectedNodeID)\r\n            const endNode = nodesMap.get(beam.endConnectedNodeID)\r\n            if (startNode && endNode) {\r\n                if (startNode.name < endNode.name) name = `${startNode.name} - ${endNode.name}`\r\n                else name = `${endNode.name} - ${startNode.name}`\r\n\r\n                return {\r\n                    ...beam,\r\n                    name: name\r\n                }\r\n            }\r\n            return beam\r\n        })\r\n            .sort((a: Beam, b: Beam) => {\r\n                const numsA = a.name.split(' - ')\r\n                const numA = Number(numsA[0] + numsA[1])\r\n                const numsB = b.name.split(' - ')\r\n                const numB = Number(numsB[0] + numsB[1])\r\n\r\n                return numA > numB ? 1 : -1\r\n            })\r\n        return beams\r\n    }\r\n    static sortNodes(_nodes: FarmNode[]) {\r\n        let nodes = [..._nodes]\r\n        nodes = nodes.sort((a: FarmNode, b: FarmNode) => {\r\n            if (a.y < b.y) return -1\r\n            else if (a.y === b.y) if (a.x < b.x) return -1; else return 1\r\n            else return 1\r\n        })\r\n        nodes = this.setNodesName(nodes)\r\n        return nodes\r\n    }\r\n    static update(_nodes: FarmNode[], _beams: Beam[]): IFarm {\r\n        let nodes = [..._nodes]\r\n        let beams = [..._beams]\r\n        nodes = Farm.setNodesName(nodes)\r\n        beams = Farm.setBeamsName(beams, nodes)\r\n        return { nodes, beams }\r\n    }\r\n    static normalize(_nodes: FarmNode[], _beams: Beam[]): IFarm {\r\n        let nodes = [..._nodes]\r\n        let beams = [..._beams]\r\n        nodes = _nodes.filter(node => (node.beamsID.length !== 0 || node.isStatic))\r\n        nodes = Farm.sortNodes(nodes)\r\n        beams = Farm.setBeamsName(_beams, nodes)\r\n        return {\r\n            nodes,\r\n            beams\r\n        }\r\n    }\r\n}\r\nexport interface FarmCalcProps {\r\n    area?: number,\r\n    modUpr?: number,\r\n    zKoef?: number\r\n}\r\nexport class FarmCalc {\r\n\r\n    private static farmCalcDebug = process.env.REACT_APP_FARM_CALC_DEBUG === \"true\" || true\r\n    static async init(_nodes: FarmNode[], _beams: Beam[], props: FarmCalcProps = {}): Promise<CalcData> {\r\n        let farmNodes: FarmNode[] = [..._nodes]\r\n        let farmBeams: Beam[] = [..._beams]\r\n        const farmNodesMap: Map<string, FarmNode> = new Map()\r\n        const farmBeamsMap: Map<string, Beam> = new Map()\r\n\r\n        const area: number = props.area || 225 //Площадь стержней\r\n        const ModUpr: number = props.modUpr || 72000 // Модуль упругости \r\n        const zKoef = props.zKoef || 1\r\n\r\n        const NodeCoord: ICoord[] = []\r\n        const NodeV: ICoord[] = []\r\n        const Forces: number[] = []\r\n        const LinkNodes: ICoord[] = []\r\n        const LinkLength: number[] = []\r\n        const Kmest: number[][][] = [] // Матрица жесткости\r\n        const Lambda0: ICoord[] = []\r\n        const Lambda: number[][][] = []\r\n        const Kobs: number[][][] = []\r\n        const IndexV: number[][] = []\r\n        let K: number[][] = []\r\n        let Va: number[] = []\r\n        let Vi: ICoord[] = []\r\n        let Vij: number[][][] = []\r\n        let V: number[][][] = []\r\n        let P: number[][][] = []\r\n\r\n        if (farmNodes.find(node => node.beamsID.length === 0 && node.isStatic)) throw new Error(\"Не все узлый соединены\")\r\n        try {\r\n            let nodeVindex = 0;\r\n            farmNodes.forEach(node => {\r\n                farmNodesMap.set(node.id, node)\r\n                NodeCoord.push({ x: node.x * zKoef, y: node.y * zKoef }) // Z koef\r\n                switch (node.fixation) {\r\n                    case NodeFixation.X: {\r\n                        nodeVindex++\r\n                        NodeV.push({ x: 0, y: nodeVindex })\r\n                        if (node.forceY) Forces.push(-node.forceY.value)\r\n\r\n                        break;\r\n                    }\r\n                    case NodeFixation.Y: {\r\n                        nodeVindex++\r\n                        NodeV.push({ x: nodeVindex, y: 0 })\r\n                        if (node.forceX) Forces.push(-node.forceX.value)\r\n                        else Forces.push(0)\r\n                        break;\r\n                    }\r\n                    case NodeFixation.YX:\r\n                    case NodeFixation.XY: {\r\n                        NodeV.push({ x: 0, y: 0 })\r\n                        break;\r\n                    }\r\n                    case NodeFixation.None: {\r\n                        nodeVindex++\r\n                        NodeV.push({ x: nodeVindex, y: nodeVindex + 1 })\r\n                        nodeVindex++\r\n                        if (node.forceX) Forces.push(-node.forceX.value)\r\n                        else Forces.push(0)\r\n                        if (node.forceY) Forces.push(-node.forceY.value)\r\n                        else Forces.push(0)\r\n                        break;\r\n                    }\r\n                    default: break;\r\n                }\r\n            })\r\n            farmBeams.forEach((beam, i) => {\r\n                farmBeamsMap.set(beam.id, beam)\r\n                const nums = beam.name.split(' - ')\r\n                LinkNodes.push({\r\n                    x: Number(nums[0]) - 1,\r\n                    y: Number(nums[1]) - 1\r\n                })\r\n                const beamLength = Farm.getBeamLength(beam) * zKoef// Z koef\r\n                LinkLength.push(beamLength)\r\n                Kmest.push(this.Kmest_i(area, ModUpr, beamLength))\r\n\r\n                const l_i = this.Lambda_i(NodeCoord[LinkNodes[i].x], NodeCoord[LinkNodes[i].y], LinkLength[i])\r\n                Lambda0.push(l_i)\r\n                Lambda.push([\r\n                    [l_i.x, l_i.y, 0, 0],\r\n                    [0, 0, l_i.x, l_i.y]\r\n                ])\r\n                Kobs.push(this.Kobs_i(area, ModUpr, LinkLength[i], Lambda0[i]))\r\n                IndexV.push(this.IndexV_i(NodeV[LinkNodes[i].x], NodeV[LinkNodes[i].y]))\r\n            })\r\n\r\n            const N_Link = LinkNodes.length\r\n            const N_Nodes = NodeV.length\r\n            const N_DOF = Math.max(...NodeV.map(({ x, y }) => Math.max(x, y)))\r\n\r\n            K = this.K(N_DOF, IndexV, Kobs)\r\n\r\n            Va = this.SquareRoot(K, Forces)\r\n            Vi = this.Vi(NodeV, Va)\r\n            Vij = this.Vij(LinkNodes, Vi)\r\n\r\n            for (let i = 0; i < N_Link; i++) {\r\n                V.push(this.V_i(Lambda[i], Vij[i]))\r\n                P.push(this.P_i(Kmest[i], V[i]))\r\n            }\r\n\r\n            if (this.farmCalcDebug) {\r\n                console.log(\"NodeCoord, LinkNodes, NodeV\", NodeCoord, LinkNodes, NodeV);\r\n                console.log(\"Kobs, Kmest\", Kobs, Kmest);\r\n                console.log(\"Lambda0, Lambda,\", Lambda0, Lambda);\r\n                console.log(\"IndexV\", IndexV);\r\n                console.log(\"N_Link, N_Nodes, N_DOF\", N_Link, N_Nodes, N_DOF);\r\n                console.log(\"K, Force\", K, Forces);\r\n                console.log(\"Va\", Va);\r\n                console.log(\"Vi\", Vi);\r\n                console.log(\"Vij\", Vij);\r\n                console.log(\"V\", V);\r\n                console.log(\"P\", P);\r\n            }\r\n\r\n            return { P, LinkNodes, Vi }\r\n\r\n        } catch (e) {\r\n            throw new Error(e)\r\n        }\r\n    }\r\n\r\n    static Kmest_i(area: number, modUpr: number, length_i: number) {\r\n        const mnoz = (area * modUpr) / length_i\r\n        const result = []\r\n        result.push([mnoz, -mnoz])\r\n        result.push([-mnoz, mnoz])\r\n        return result\r\n    }\r\n    static Lambda_i(nodeCoordOfX: ICoord, nodeCoordOfY: ICoord, length_i: number): ICoord {\r\n        const l_x = (nodeCoordOfY.x - nodeCoordOfX.x) / length_i\r\n        const l_y = (nodeCoordOfY.y - nodeCoordOfX.y) / -length_i\r\n        return { x: l_x, y: l_y }\r\n    }\r\n    static Kobs_i(area: number, modUpr: number, length_i: number, l_i: ICoord) {\r\n        const mnoz = (area * modUpr) / length_i\r\n        const LTxL: ICoord[] = [{ x: l_i.x * l_i.x, y: l_i.x * l_i.y }, { x: l_i.x * l_i.y, y: l_i.y * l_i.y }]\r\n        const _LTxL: ICoord[] = [{ x: -l_i.x * l_i.x, y: -l_i.x * l_i.y }, { x: -l_i.x * l_i.y, y: -l_i.y * l_i.y }]\r\n        const augmnet1 = []\r\n        const augment2 = []\r\n        for (let i = 0; i < 2; i++) {\r\n            augmnet1.push({ x1: LTxL[i].x, y1: LTxL[i].y, x2: _LTxL[i].x, y2: _LTxL[i].y })\r\n            augment2.push({ x1: _LTxL[i].x, y1: _LTxL[i].y, x2: LTxL[i].x, y2: LTxL[i].y })\r\n        }\r\n        const stack: { x1: number, y1: number, x2: number, y2: number }[] = Array.prototype.concat(augmnet1, augment2)\r\n        const result = stack.map(({ x1, y1, x2, y2 }) => ([\r\n            x1 * mnoz,\r\n            y1 * mnoz,\r\n            x2 * mnoz,\r\n            y2 * mnoz\r\n        ]))\r\n        return result\r\n\r\n    }\r\n    static IndexV_i(nodeV1: ICoord, nodeV2: ICoord): number[] {\r\n        return [\r\n            nodeV1.x,\r\n            nodeV1.y,\r\n            nodeV2.x,\r\n            nodeV2.y\r\n        ]\r\n    }\r\n    static K(n_dof: number, indexV: number[][], k_obs: number[][][]) {\r\n        const K: number[][] = []\r\n\r\n        for (let t = 0; t < n_dof; t++) {\r\n            const row: number[] = []\r\n            for (let r = 0; r < n_dof; r++) {\r\n                row.push(0)\r\n            }\r\n            K.push(row)\r\n        }\r\n\r\n        for (let e = 0; e < indexV.length; e++) {\r\n            for (let i = 0; i < 4; i++) {\r\n                const A = indexV[e][i]\r\n                if (A !== 0)\r\n                    for (let j = 0; j < 4; j++) {\r\n                        const B = indexV[e][j]\r\n                        if (B !== 0)\r\n                            K[B - 1][A - 1] = K[B - 1][A - 1] + k_obs[e][i][j]\r\n                    }\r\n\r\n            }\r\n        }\r\n        return K\r\n    }\r\n    static SquareRoot(_a: number[][], _b: number[]) {\r\n        if (_a.length !== _b.length) {\r\n            throw Error(\"SquareRoot - Массивы должны быть одинаковой длины\")\r\n        }\r\n\r\n        const n = _b.length\r\n        const a: number[][] = []\r\n        const b: number[] = []\r\n        const x: number[] = []\r\n        const d: number[] = []\r\n        const s: number[][] = []\r\n        const y: number[] = []\r\n\r\n        for (let i = 0; i < n + 1; i++) {\r\n            const row: number[] = []\r\n            for (let r = 0; r < n; r++) {\r\n                row.push(0)\r\n            }\r\n            s.push(row)\r\n            a.push(row)\r\n            b.push(0)\r\n            x.push(0)\r\n            d.push(0)\r\n            y.push(0)\r\n        }\r\n\r\n        for (let j = 1; j <= n; j++) {\r\n            for (let r = 0; r <= n; r++) {\r\n                a[j][r] = _a[j - 1][r - 1]\r\n            }\r\n            b[j] = _b[j - 1]\r\n        }\r\n\r\n        d[1] = MyMath.signum(a[1][1]);\r\n        s[1][1] = Math.sqrt(Math.abs(a[1][1]));\r\n        for (let j = 2; j <= n; j++) {\r\n            s[1][j] = a[1][j] / (s[1][1] * d[1]);\r\n        }\r\n\r\n        for (let i = 2; i <= n; i++) {\r\n            let sum = 0;\r\n            for (let k = 1; k <= i - 1; k++) {\r\n                sum += s[k][i] * s[k][i] * d[k];\r\n            }\r\n            d[i] = MyMath.signum(a[i][i] - sum);\r\n            s[i][i] = Math.sqrt(Math.abs(a[i][i] - sum));\r\n\r\n            const l = 1 / (s[i][i] * d[i]);\r\n            for (let j = i + 1; j <= n; j++) {\r\n                let SDSsum = 0;\r\n                for (let k = 1; k <= i - 1; k++) {\r\n                    SDSsum += s[k][i] * d[k] * s[k][j];\r\n                }\r\n                s[i][j] = l * (a[i][j] - SDSsum);\r\n            }\r\n        }\r\n\r\n        y[1] = b[1] / (s[1][1] * d[1]);\r\n\r\n        for (let i = 2; i <= n; i++) {\r\n            let sum = 0;\r\n\r\n            for (let j = 1; j <= i - 1; j++) {\r\n                sum += s[j][i] * d[j] * y[j];\r\n            }\r\n\r\n            y[i] = (b[i] - sum) / (s[i][i] * d[i]);\r\n        }\r\n\r\n        x[n] = y[n] / s[n][n];\r\n\r\n        for (let i = n - 1; i >= 1; i--) {\r\n            let sum = 0;\r\n\r\n            for (let k = i + 1; k <= n; k++) {\r\n                sum += s[i][k] * x[k];\r\n            }\r\n\r\n            x[i] = (y[i] - sum) / s[i][i];\r\n        }\r\n\r\n        const result: number[] = []\r\n        x.forEach((item, i) => {\r\n            if (i !== 0) result.push(item)\r\n        })\r\n\r\n        return result\r\n    }\r\n\r\n    static Vi(nodeV: ICoord[], Va: number[]) {\r\n        const vi: ICoord[] = []\r\n        for (let e = 0; e < nodeV.length; e++) {\r\n            const q: ICoord = { ...nodeV[e] }\r\n            q.x = q.x === 0 ? 0 : Va[q.x - 1]\r\n            q.y = q.y === 0 ? 0 : Va[q.y - 1]\r\n            vi.push(q)\r\n        }\r\n        return vi\r\n    }\r\n    static Vij(linkNodes: ICoord[], vi: ICoord[]) {\r\n        const vij: number[][][] = []\r\n        for (let e = 0; e < linkNodes.length; e++) {\r\n            const n_start = linkNodes[e].x\r\n            const n_ends = linkNodes[e].y\r\n\r\n            vij.push([\r\n                [vi[n_start].x],\r\n                [vi[n_start].y],\r\n                [vi[n_ends].x],\r\n                [vi[n_ends].y],\r\n            ])\r\n        }\r\n        return vij\r\n    }\r\n    static V_i(l: number[][], vij: number[][]) {\r\n        const v: number[][] = MyMath.multMatrxiV2(l, vij)\r\n        return v\r\n    }\r\n    static P_i(k: number[][], v: number[][]) {\r\n        const p: number[][] = MyMath.multMatrxiV2(k, v)\r\n        return p\r\n    }\r\n}\r\n\r\nexport class FarmFactory {\r\n    static firstPlacement(_nodes: FarmNode[], _beams: Beam[]) : IFarm {\r\n\r\n        const nodes = _nodes.map(node => {\r\n            const x = node.x + Math.round((consts.canvasWidth / 3) / consts.UI_cellSize) * consts.MMinCell\r\n            const y = node.y + Math.round((consts.canvasHeight / 3) / consts.UI_cellSize) * consts.MMinCell\r\n            return {\r\n                ...node,\r\n                x,\r\n                y\r\n            }\r\n        })\r\n        const beams = _beams.map(beam => {\r\n            const x = beam.x + Math.round((consts.canvasWidth / 3) / consts.UI_cellSize) * consts.MMinCell\r\n            const y = beam.y + Math.round((consts.canvasHeight / 3) / consts.UI_cellSize) * consts.MMinCell\r\n            return {\r\n                ...beam,\r\n                x,\r\n                y\r\n            }\r\n        })\r\n\r\n        return {nodes , beams}\r\n    }\r\n    static createNodes(_fixedNodes: IFixedNodeCreate[], _staticNodes: IStaticNodeCreate[], _nodes: ISimpleNodeCreate[]): FarmNode[] {\r\n        const nodes: FarmNode[] = []\r\n        let index: number = 0;\r\n        return nodes.concat(\r\n            _fixedNodes.map(item => {\r\n                index++\r\n                return createNode({ ...item, isStatic: true, name: index + \"\" })\r\n            }),\r\n            _staticNodes.map(item => {\r\n                index++\r\n                const _node = createNode({ ...item, isStatic: true, name: index + \"\" })\r\n                if (item.angle === 0) _node.forceX = createForce({ nodeID: _node.id, value: item.value, angle: item.angle })\r\n                else _node.forceY = createForce({ nodeID: _node.id, value: item.value, angle: item.angle })\r\n                return _node\r\n            }),\r\n            _nodes.map(item => {\r\n                index++\r\n                return createNode({ ...item, name: index + \"\" })\r\n            })\r\n        )\r\n    }\r\n}","import * as React from 'react'\r\nimport { Theme, createStyles, withStyles, Typography, IconButton, Box, Divider } from '@material-ui/core';\r\nimport { WithStyles } from '@material-ui/styles';\r\nimport { Delete as DeleteIcon, Info as InfoEntityIcon } from '@material-ui/icons';\r\nimport { Sidebar } from 'src/components';\r\nimport { Entity } from 'src/models/Farm/ModelEntity';\r\nimport { instanceOfNode, FarmNode, NodeFixation } from 'src/models/Farm/ModelNode';\r\nimport { instanceOfBeam, Beam } from 'src/models/Farm/ModelBeam';\r\nimport { Farm } from 'src/models/Farm/ModelFarm';\r\nimport { Force } from 'src/models/Farm/ModelForce';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    root: {\r\n        padding: theme.spacing(2)\r\n    },\r\n    title: {\r\n        marginBottom: theme.spacing(2)\r\n    },\r\n    btnGroup: {\r\n        marginTop: theme.spacing(2)\r\n    }\r\n})\r\n\r\ninterface EntityInfoProps extends WithStyles<typeof styles> {\r\n    entity?: Entity | undefined,\r\n    onDelete(entity: Entity): void\r\n}\r\n\r\ninterface EntityInfoState {\r\n\r\n}\r\nconst TextRow = ({ text, className }: { text: string, className?: string }) =>     (\r\n    <React.Fragment>\r\n        <Typography variant=\"subtitle2\">\r\n            {text}\r\n        </Typography>\r\n        <Divider />\r\n    </React.Fragment>\r\n)\r\nconst TextRows = ({ text, className }: { text: string[], className?: string }) => {\r\n    if (text.length === 0) return (<React.Fragment />)\r\n    return (\r\n        <React.Fragment>\r\n            {text.map((str,i) => (\r\n                <Typography variant=\"subtitle2\" key={i}>\r\n                    {str}\r\n                </Typography>\r\n            ))}\r\n            <Divider />\r\n        </React.Fragment>\r\n    )\r\n}\r\nclass UIEntityInfo extends React.PureComponent<EntityInfoProps, EntityInfoState>{\r\n    constructor(props: EntityInfoProps) {\r\n        super(props)\r\n        this.state = {\r\n        }\r\n    }\r\n    viewForceInfo(force: Force) {\r\n        return (\r\n            <TextRows text={[`Сила: ${force.value} H`, `Угол: ${force.angle}°`]} />\r\n        )\r\n    }\r\n    viewFixationInfo(node: FarmNode) {\r\n        switch (node.fixation) {\r\n            case NodeFixation.X: return (\r\n                <TextRow text={\"Фиксация по оси X\"} />\r\n            )\r\n            case NodeFixation.Y: return (\r\n                <TextRow text={\"Фиксация по оси Y\"} />\r\n            )\r\n            case NodeFixation.XY: return (\r\n                <TextRow text={\"Фиксация по осям Х и Y\"} />\r\n            )\r\n            default: return undefined\r\n        }\r\n    }\r\n    NodeInfo(node: FarmNode) {\r\n        const { classes, onDelete } = this.props        \r\n        return (\r\n            <Box className={classes.root}>\r\n                <Typography variant=\"h6\" className={classes.title}>\r\n                    Узел {node.name}\r\n                </Typography>\r\n                <TextRows text={[`X: ${node.x}`,`Y: ${node.y}`]}/>\r\n                {node.withNewPosition && (<TextRows text={[`ΔX: ${node.newX}`,`ΔY: ${node.newY}`]}/>)}\r\n                {node.forceX && this.viewForceInfo(node.forceX)}\r\n                {node.forceY && this.viewForceInfo(node.forceY)}\r\n                {this.viewFixationInfo(node)}\r\n                <div className={classes.btnGroup}>\r\n                    <IconButton\r\n                        aria-label=\"Delete\"\r\n                        onClick={() => onDelete(node)}\r\n                    >\r\n                        <DeleteIcon />\r\n                    </IconButton>\r\n\r\n                </div>\r\n            </Box>\r\n        )\r\n    }\r\n    BeamInfo(beam: Beam) {\r\n        const { classes, onDelete } = this.props\r\n        return (\r\n            <Box className={classes.root}>\r\n                <Typography variant=\"h6\" className={classes.title}>\r\n                    Стержень {beam.name}\r\n                </Typography>\r\n                <TextRow text={`Длина: ${beam.length || Farm.getBeamLength(beam)}`}/>\r\n                <div className={classes.btnGroup}>\r\n                    <IconButton\r\n                        aria-label=\"Delete\"\r\n                        onClick={() => onDelete(beam)}\r\n                    >\r\n                        <DeleteIcon />\r\n                    </IconButton>\r\n                </div>\r\n            </Box>\r\n        )\r\n    }\r\n    viewInfo(entity: Entity | undefined) {\r\n        if (instanceOfNode(entity)) return this.NodeInfo(entity)\r\n        else if (instanceOfBeam(entity)) return this.BeamInfo(entity)\r\n    }\r\n    render() {\r\n        const { entity } = this.props\r\n        return (\r\n            <Sidebar\r\n                anchor=\"right\"\r\n                title=\"Информация о выбранном объекте\"\r\n                btnIcon={(<InfoEntityIcon />)}\r\n            >\r\n                {this.viewInfo(entity)}\r\n                <Divider />\r\n            </Sidebar>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default withStyles(styles)(UIEntityInfo)","import * as React from 'react'\r\nimport { Theme, createStyles, withStyles,  Paper } from '@material-ui/core';\r\nimport { ToggleButtonGroup } from '@material-ui/lab'\r\nimport { WithStyles } from '@material-ui/styles';\r\nimport { ZoomOutMap as MoveIcon, MyLocation as AddNodeIcon, Delete as DeleteIcon, Power as ConnectIcon } from '@material-ui/icons';\r\n\r\nimport { fade } from '@material-ui/core/styles';\r\nimport { MyToggleButton } from 'src/components';\r\nimport { UIModes } from 'src/utils/UI';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    root: {\r\n        position: 'absolute',\r\n        padding: theme.spacing(1),\r\n        bottom: theme.spacing(2),\r\n        left: \"50%\",\r\n        transform: 'translateX(-50%)',\r\n        backgroundColor: fade(theme.palette.primary.light, 0.4),\r\n        transition: theme.transitions.create(['background-color', 'box-shadow', 'border'], {\r\n            duration: theme.transitions.duration.short,\r\n        }),\r\n        '&:hover':{\r\n            backgroundColor: theme.palette.primary.light,\r\n        }\r\n    },\r\n    modsBtnGroup: {\r\n        borderRadius: 0,\r\n        backgroundColor: 'transparent'\r\n    }\r\n})\r\n\r\n\r\nexport interface IMode {\r\n    name: string,\r\n    mod: UIModes\r\n    icon: JSX.Element\r\n}\r\n\r\n\r\n\r\nexport interface UIToolPanelProps extends WithStyles<typeof styles> {\r\n    selected: UIModes\r\n    onSelect(mod: UIModes): void\r\n}\r\n\r\nconst UIToolPanel: React.FC<UIToolPanelProps> = ({ onSelect, selected, classes }) => {\r\n    const mods: IMode[] = [\r\n        {\r\n            name: \"Перемещение\",\r\n            mod: UIModes.move,\r\n            icon: (<MoveIcon />)\r\n        },\r\n        {\r\n            name: \"Добавить узел\",\r\n            mod: UIModes.addNode,\r\n            icon: (<AddNodeIcon />)\r\n        },\r\n        {\r\n            name: \"Соединить узлы\",\r\n            mod: UIModes.addBeam,\r\n            icon: (<ConnectIcon />)\r\n        },\r\n        {\r\n            name: \"Удалить\",\r\n            mod: UIModes.delete,\r\n            icon: (<DeleteIcon />)\r\n        }\r\n    ]\r\n    return (\r\n        <Paper className={classes.root}>\r\n            <ToggleButtonGroup\r\n                value={selected}\r\n                exclusive\r\n                onChange={(e, value) => onSelect(value)}\r\n                size=\"medium\"\r\n                className={classes.modsBtnGroup}\r\n            >\r\n                {mods.map(item => (\r\n                    <MyToggleButton\r\n                        key={item.mod}\r\n                        value={item.mod}\r\n                        selected={item.mod === selected}\r\n                        icon={item.icon}\r\n                        name={item.name}\r\n                        \r\n                    />\r\n                ))}\r\n            </ToggleButtonGroup>\r\n        </Paper>\r\n    )\r\n}\r\n\r\nexport default withStyles(styles)(UIToolPanel)","import * as React from 'react'\r\nimport KeyHandler from 'react-key-handler'\r\nimport Konva from \"konva\"\r\nimport { Stage } from \"react-konva\"\r\nimport { createStyles, Theme, WithStyles, withStyles, Box } from '@material-ui/core';\r\nimport { UITreePanel, UIEntityInfo, UIStage, UIHeader, UIToolPanel } from '.';\r\nimport { MyMath } from 'src/utils';\r\nimport Stats from 'react-stats'\r\nimport { instanceOfBeam } from 'src/models/Farm/ModelBeam';\r\nimport { Entity } from 'src/models/Farm/ModelEntity';\r\nimport { instanceOfNode } from 'src/models/Farm/ModelNode';\r\nimport { FarmContainer } from '../FarmContainer'\r\nimport { UIModes } from 'src/utils/UI';\r\nimport { IFarm } from 'src/models/Farm/ModelFarm';\r\nimport { consts } from 'src/static';\r\n\r\n\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n    root: {\r\n        width: \"100%\",\r\n        height: \"100%\",\r\n        overflow: \"hidden\",\r\n        background: theme.palette.background.default,\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n    },\r\n    stageBox: {\r\n        display: 'flex',\r\n        flexGrow: 1,\r\n        overflow: 'hidden',\r\n\r\n    },\r\n    toolbar: theme.mixins.toolbar,\r\n})\r\nexport interface UIFarmProps extends IFarm, WithStyles<typeof styles> {\r\n    addNode: typeof FarmContainer.prototype.addNode,\r\n    addBeam: typeof FarmContainer.prototype.addBeam,\r\n    moveNode: typeof FarmContainer.prototype.moveNode,\r\n    moveBeam: typeof FarmContainer.prototype.moveBeam,\r\n    connectBeamToNode: typeof FarmContainer.prototype.connectBeamToNode,\r\n    deleteEntity: typeof FarmContainer.prototype.deleteEntity\r\n    defautlFarm: typeof FarmContainer.prototype.defautlFarm\r\n    saveFarm: typeof FarmContainer.prototype.saveFarm,\r\n    calculateFarm: typeof FarmContainer.prototype.calculateFarm\r\n    calculation: boolean,\r\n}\r\n\r\nexport interface UIFarmState {\r\n    stageWidth: number,\r\n    stageHeight: number,\r\n    uiMode: UIModes,\r\n    selectedEntity: Entity | undefined,\r\n    paintEntity: Entity | undefined\r\n}\r\n\r\nclass UIFarm extends React.Component<UIFarmProps, UIFarmState>{\r\n    private stage: React.RefObject<Stage & Konva.Stage>\r\n    constructor(props: UIFarmProps) {\r\n        super(props)\r\n        this.state = {\r\n            stageHeight: consts.canvasHeight,\r\n            stageWidth: consts.canvasWidth,\r\n            uiMode: UIModes.none,\r\n            selectedEntity: undefined,\r\n            paintEntity: undefined,\r\n        }\r\n        this.UIonClick = this.UIonClick.bind(this)\r\n        this.UIonDrag = this.UIonDrag.bind(this)\r\n        this.UIonMouseMove = this.UIonMouseMove.bind(this)\r\n        this.onKeyHandle = this.onKeyHandle.bind(this)\r\n        this.selectEntity = this.selectEntity.bind(this)\r\n        this.clearFarm = this.clearFarm.bind(this)\r\n        this.deleteEntity = this.deleteEntity.bind(this)\r\n        this.saveFarm = this.saveFarm.bind(this)\r\n        this.calculateFarm = this.calculateFarm.bind(this)\r\n        this.stage = React.createRef();\r\n    }\r\n    componentDidMount() {\r\n        const { current: stage } = this.stage\r\n        if (stage) {\r\n            const container: HTMLDivElement = stage.attrs.container.parentElement.parentElement            \r\n            if (container) {\r\n                container.scrollTop = (container.scrollHeight - container.offsetHeight) / 2\r\n                container.scrollLeft = (container.scrollWidth - container.offsetWidth) / 2\r\n            }\r\n        }\r\n    }\r\n\r\n    UIonClick(e: Konva.KonvaEventObject<MouseEvent>, entity?: Entity) {\r\n        const { uiMode, paintEntity } = this.state\r\n        const { calculation } = this.props\r\n        const isEmptyPlace = e.target.getStage() === e.target\r\n        e.evt.preventDefault()\r\n        if (e.evt.button === 0 && !calculation) {\r\n            switch (uiMode) {\r\n                case UIModes.none: {\r\n                    if (!isEmptyPlace) {\r\n                        this.selectEntity(entity);\r\n                    } else this.setState({ selectedEntity: undefined })\r\n\r\n                    break;\r\n                }\r\n                case UIModes.addNode: {\r\n                    if (isEmptyPlace) {\r\n                        const { layerX, layerY } = e.evt\r\n                        const cellX = MyMath.cellX(layerX)\r\n                        const cellY = MyMath.cellX(layerY)\r\n                        this.props.addNode(cellX, cellY)\r\n                    }\r\n                    break;\r\n                }\r\n                case UIModes.addBeam: {\r\n                    if (!isEmptyPlace && instanceOfNode(entity)) {\r\n                        const beam = this.props.addBeam({\r\n                            x: entity.x,\r\n                            y: entity.y\r\n                        })\r\n                        if (instanceOfBeam(beam)) {\r\n                            const connectedBeam = this.props.connectBeamToNode(entity, beam, 'start')\r\n                            if (instanceOfBeam(connectedBeam))\r\n                                this.setState({\r\n                                    paintEntity: connectedBeam,\r\n                                    uiMode: UIModes.addBeamStart\r\n                                })\r\n                            else this.props.deleteEntity(beam.id)\r\n                        }\r\n                    }\r\n                    break;\r\n                }\r\n                case UIModes.addBeamStart: {\r\n                    if (!isEmptyPlace && instanceOfNode(entity) && instanceOfBeam(paintEntity)) {\r\n                        if (this.props.connectBeamToNode(entity, paintEntity, 'end'))\r\n                            this.setState({\r\n                                uiMode: UIModes.addBeam,\r\n                                paintEntity: undefined\r\n                            })\r\n                    }\r\n                    break;\r\n                }\r\n                case UIModes.delete: {\r\n                    if (!isEmptyPlace && entity) {\r\n                        this.deleteEntity(entity)\r\n                    }\r\n                    break;\r\n                }\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n\r\n\r\n        if (isEmptyPlace) this.setState({ selectedEntity: undefined })\r\n\r\n    }\r\n    UIonMouseMove(e: Konva.KonvaEventObject<MouseEvent>) {        \r\n        const { calculation } = this.props\r\n        if (calculation) return\r\n        const { uiMode, paintEntity } = this.state\r\n        const { layerX, layerY } = e.evt\r\n        switch (uiMode) {\r\n            case UIModes.addBeamStart: {\r\n                if (e.target.getStage()) {\r\n                    if (paintEntity && instanceOfBeam(paintEntity)) {\r\n                        this.props.moveBeam(paintEntity, layerX, layerY)\r\n                    } else this.setState({ uiMode: UIModes.addBeam })\r\n                }\r\n                break;\r\n            }\r\n            case UIModes.delete: {\r\n                const stage: Stage & Konva.Stage = e.target.getStage()\r\n                if (stage === e.target) {\r\n                    stage.container().style.cursor = 'default'\r\n                }\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    UIonDrag(e: Konva.KonvaEventObject<DragEvent>, entity: Entity) {\r\n        const { calculation } = this.props\r\n        if (calculation) return\r\n        const { uiMode } = this.state\r\n        switch (uiMode) {\r\n            case UIModes.move: {\r\n                if (instanceOfNode(entity)) {\r\n                    if (e.evt.defaultPrevented) {\r\n                        const { layerX, layerY } = e.evt\r\n                        this.props.moveNode(entity, MyMath.cellX(layerX), MyMath.cellY(layerY))\r\n                    }\r\n                }\r\n                break\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n\r\n    }\r\n    onKeyHandle(e: KeyboardEvent) {\r\n        switch (e.key) {\r\n            case \"Escape\": {\r\n                this.deletePaintEntity()\r\n\r\n                break;\r\n            }\r\n            default:\r\n                break;\r\n        }\r\n\r\n    }\r\n    deletePaintEntity() {\r\n        if (this.state.paintEntity)\r\n            this.props.deleteEntity(this.state.paintEntity.id)\r\n        this.setState({\r\n            paintEntity: undefined\r\n        })\r\n    }\r\n    deleteEntity(entity: Entity) {\r\n        const { calculation } = this.props\r\n        if (calculation) return\r\n        if (this.state.selectedEntity && this.state.selectedEntity.id === entity.id)\r\n            this.setState({\r\n                selectedEntity: undefined\r\n            })\r\n        this.props.deleteEntity(entity.id)\r\n    }\r\n    selectEntity(entity: Entity | undefined) {\r\n        const { calculation } = this.props\r\n        if (calculation) return\r\n        if (entity) this.setState({ selectedEntity: entity })\r\n    }\r\n    clearFarm(): void {\r\n        if (window.confirm('Вы уверены, что хотите очистить холст?'))\r\n            this.props.defautlFarm()\r\n    }\r\n    saveFarm(e: React.FormEvent<HTMLButtonElement>) {\r\n        if (window.confirm('Вы уверены, что хотите сохранить холст в кэш?'))\r\n            this.props.saveFarm()\r\n    }\r\n    calculateFarm(e: React.FormEvent<HTMLButtonElement>) {\r\n        this.props.calculateFarm()\r\n    }\r\n    setSelectedMode(mode: UIModes) {\r\n        const { calculation } = this.props\r\n        if (calculation) return\r\n        if (this.state.paintEntity)\r\n            this.props.deleteEntity(this.state.paintEntity.id)\r\n        this.setState({\r\n            uiMode: mode || 0,\r\n            paintEntity: undefined\r\n        })\r\n    }\r\n    render() {\r\n        const { stageHeight, stageWidth, uiMode, selectedEntity } = this.state\r\n        const { classes, nodes, beams, calculation } = this.props\r\n        return (\r\n            <Box className={classes.root}>\r\n                <Stats isActive={true} />\r\n                <KeyHandler\r\n                    keyEventName={\"keyup\"}\r\n                    keyValue={\"Escape\"}\r\n                    onKeyHandle={this.onKeyHandle}\r\n                />\r\n                <UIHeader\r\n                    hundleClear={this.clearFarm}\r\n                    hundleSave={this.saveFarm}\r\n                    hundleCalculate={this.calculateFarm}\r\n                    disabled={calculation} />\r\n\r\n                <div className={classes.toolbar} />\r\n                <Box className={classes.stageBox}>\r\n                    <div className={classes.toolbar} />\r\n                    <UITreePanel\r\n                        nodes={nodes}\r\n                        beams={beams}\r\n                        selectedEntity={selectedEntity}\r\n                        onSelect={this.selectEntity}\r\n                    />\r\n                    <UIStage\r\n                        onClick={this.UIonClick}\r\n                        onDrag={this.UIonDrag}\r\n                        onMouseMove={this.UIonMouseMove}\r\n                        stageHeight={stageHeight}\r\n                        stageWidth={stageWidth}\r\n                        nodes={nodes}\r\n                        beams={beams}\r\n                        stage={this.stage}\r\n                        selectedEntity={selectedEntity}\r\n                        uiMode={uiMode}\r\n                    />\r\n                    <UIEntityInfo\r\n                        entity={selectedEntity}\r\n                        onDelete={this.deleteEntity} />\r\n                </Box>\r\n                <UIToolPanel\r\n                    selected={uiMode}\r\n                    onSelect={this.setSelectedMode.bind(this)} />\r\n            </Box>\r\n        )\r\n    }\r\n}\r\n\r\nexport default withStyles(styles)(UIFarm)","import FarmPage from './FarmContainer'\r\n\r\nexport default FarmPage","import * as React from 'react'\r\nimport { UIFarm } from './components'\r\nimport { FarmNode, INode, instanceOfNode } from 'src/models/Farm/ModelNode';\r\nimport { Beam, IBeam, instanceOfBeam } from 'src/models/Farm/ModelBeam';\r\nimport { Force, createForce, IForce } from 'src/models/Farm/ModelForce';\r\nimport { IFarm, Farm,  FarmCalc, FarmFactory } from 'src/models/Farm/ModelFarm';\r\nimport testFarm from './_testFarm'\r\nimport { consts } from 'src/static';\r\n\r\ninterface State extends IFarm {\r\n    calculation: boolean\r\n}\r\ninterface Props {\r\n\r\n}\r\nexport class FarmContainer extends React.Component<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props)\r\n        this.state = {\r\n            nodes: [],\r\n            beams: [],\r\n            calculation: false\r\n        }\r\n        this.defautlFarm = this.defautlFarm.bind(this)\r\n        this.saveFarm = this.saveFarm.bind(this)\r\n        this.calculateFarm = this.calculateFarm.bind(this)\r\n    }\r\n    componentDidMount() {\r\n        const nodesJSON = localStorage.getItem(\"nodes\")\r\n        const beamsJSON = localStorage.getItem(\"beams\")\r\n        if (nodesJSON && beamsJSON) {\r\n            const _nodes: FarmNode[] = JSON.parse(nodesJSON)\r\n            const _beams: Beam[] = JSON.parse(beamsJSON)\r\n            this.setState({ nodes: _nodes, beams: _beams })\r\n        } else this.defautlFarm()\r\n    }\r\n    addNode = (x: number, y: number, options?: INode) => {\r\n        const node = Farm.addNode(this.state.nodes, { ...options, x:x*consts.SizeKoef, y:y*consts.SizeKoef })\r\n        if (node) {\r\n            this.setState({\r\n                nodes: [...this.state.nodes, node]\r\n            })\r\n            return node\r\n        }\r\n        return null\r\n    }\r\n    addBeam = (options?: IBeam) => {\r\n        const beam = Farm.addBeam(this.state.beams, { ...options })\r\n        if (beam) {\r\n            this.setState({\r\n                beams: [...this.state.beams, beam]\r\n            })\r\n            return beam\r\n        }\r\n        return null\r\n    }\r\n    connectBeamToNode = (_node: FarmNode, _beam: Beam, place: 'start' | 'end') => {\r\n\r\n        const node: FarmNode = { ..._node }\r\n        const beam: Beam = { ..._beam }\r\n\r\n        switch (place) {\r\n            case 'start': {\r\n                beam.startConnectedNodeID = node.id\r\n                beam.name = node.name + \" - \"\r\n                node.beamsID.push(beam.id)\r\n                Farm.moveEntity(beam, node.x, node.y)\r\n                this.setState(state => ({\r\n                    nodes: state.nodes.map(item => {\r\n                        if (item.id === node.id) return node\r\n                        return item\r\n                    }),\r\n                    beams: state.beams.map(item => {\r\n                        if (item.id === beam.id) return beam\r\n                        return item\r\n                    })\r\n                }))\r\n                return beam;\r\n            }\r\n            case 'end': {\r\n                const beamsOfNode = this.state.beams.filter(item => (node && node.beamsID.includes(item.id)))\r\n                const oldBeam = beamsOfNode.find(item => Farm.findOldBeam(node, beam, item))\r\n                if (!oldBeam) {\r\n                    node.beamsID.push(beam.id)\r\n                    beam.endConnectedNodeID = node.id\r\n                    beam.name = beam.name + node.name\r\n                    Farm.moveBeamEnd(beam, node.x, node.y)\r\n                    this.setState(state => ({\r\n                        nodes: state.nodes.map(item => {\r\n                            if (item.id === node.id) return node\r\n                            return item\r\n                        }),\r\n                        beams: state.beams.map(item => {\r\n                            if (item.id === beam.id) return beam\r\n                            return item\r\n                        })\r\n                    }))\r\n                    return true\r\n                }\r\n                return false\r\n            }\r\n            default: return false\r\n        }\r\n    }\r\n    addForceToNode = (node: FarmNode, options?: IForce) => {\r\n        let force: Force = createForce({\r\n            ...options,\r\n            nodeID: node.id,\r\n        })\r\n\r\n        if (force.angle === 0) node.forceX = force\r\n        else node.forceY = force\r\n        this.setState(state => ({\r\n            nodes: state.nodes.map(item => {\r\n                if (node && item.id === node.id) return node\r\n                return item\r\n            }),\r\n        }))\r\n        return force\r\n\r\n    }\r\n    moveNode = (_node: FarmNode, _x: number, _y: number, ) => {\r\n        const x = _x *consts.SizeKoef\r\n        const y = _y *consts.SizeKoef\r\n        if (_node.isStatic) return false\r\n        const oldNode = this.state.nodes.find(item => item.x === x && item.y === y)\r\n        if (!oldNode) {\r\n            const node: FarmNode = { ..._node}\r\n            Farm.moveEntity(node,x,y)\r\n            const beamsOfNode = this.state.beams.filter(item => (node && node.beamsID.includes(item.id)))\r\n            beamsOfNode.forEach(item => {\r\n                if (node) {\r\n                    const beam: Beam = { ...item }\r\n                    if (beam.startConnectedNodeID === node.id) Farm.moveEntity(beam, x, y)\r\n                    else if (item.endConnectedNodeID === node.id) Farm.moveBeamEnd(beam, x, y)\r\n                    this.setState(state => ({\r\n                        beams: state.beams.map(item => {\r\n                            if (item.id === beam.id) return beam\r\n                            return item\r\n                        })\r\n                    }))\r\n                }\r\n            })\r\n            this.setState(state => ({\r\n                nodes: state.nodes.map(item => {\r\n                    if (item.id === node.id) return node\r\n                    return item\r\n                }),\r\n            }))\r\n\r\n            return true\r\n        }\r\n        return false\r\n    }\r\n    moveBeam = (beam: Beam, _x: number, _y: number, place: 'start' | 'end' = 'end') => {\r\n        \r\n        const x = _x *consts.SizeKoef\r\n        const y = _y *consts.SizeKoef\r\n        beam = { ...beam }\r\n        if (place === 'start') Farm.moveEntity(beam, x, y)\r\n        else Farm.moveBeamEnd(beam, x, y)\r\n        this.setState(state => ({\r\n            beams: state.beams.map(item => {\r\n                if (beam && item.id === beam.id) return beam\r\n                return item\r\n            })\r\n        }))\r\n        return true\r\n    }\r\n    deleteEntity = (id: string) => {\r\n        let nodes: FarmNode[] = [...this.state.nodes]\r\n        let beams: Beam[] = [...this.state.beams]\r\n        let entity: Beam | FarmNode | undefined =\r\n            this.state.beams.find(item => item.id === id) ||\r\n            this.state.nodes.find(item => item.id === id)\r\n        if (instanceOfNode(entity)) {\r\n            if (entity.isStatic) return false\r\n            const beamsOfNode = beams.filter(item => (instanceOfNode(entity) && entity.beamsID.includes(item.id)))\r\n            beamsOfNode.forEach(beam => {\r\n                if (instanceOfNode(entity)) {\r\n                    let _node: FarmNode | undefined\r\n                    if (beam.startConnectedNodeID === entity.id) _node = nodes.find(item => item.id === beam.endConnectedNodeID)\r\n                    else _node = nodes.find(item => item.id === beam.startConnectedNodeID)\r\n                    if (_node) {\r\n                        _node = { ..._node }\r\n                        _node.beamsID = _node.beamsID.filter(id => id !== beam.id)\r\n                        nodes = nodes.map(item => {\r\n                            if (_node && item.id === _node.id) return _node\r\n                            return item\r\n                        })\r\n                    }\r\n                    beams = beams.filter(i => i.id !== beam.id)\r\n                }\r\n            })\r\n            nodes = nodes.filter(i => (instanceOfNode(entity) && i.id !== entity.id))\r\n            const { nodes: upNodes, beams: upBeams } = Farm.update(nodes, beams)\r\n            this.setState({\r\n                nodes: upNodes,\r\n                beams: upBeams\r\n            })\r\n            return true\r\n\r\n        } else if (instanceOfBeam(entity)) {\r\n            [entity.startConnectedNodeID, entity.endConnectedNodeID].forEach(nodeID => {\r\n                if (nodeID && nodeID.length > 0) {\r\n                    let _node = nodes.find(item => item.id === nodeID)\r\n                    if (_node && instanceOfBeam(entity)) {\r\n                        _node = { ..._node }\r\n                        _node.beamsID = _node.beamsID.filter(id => {\r\n                            if (entity) return id !== entity.id\r\n                            return false\r\n                        })\r\n                        nodes = nodes.map(item => {\r\n                            if (_node && item.id === _node.id) return _node\r\n                            return item\r\n                        })\r\n                    }\r\n                }\r\n            })\r\n            beams = beams.filter(i => (instanceOfBeam(entity) && i.id !== entity.id))\r\n            this.setState({\r\n                nodes, beams\r\n            })\r\n            return true\r\n        }\r\n\r\n        return false\r\n    }\r\n    async calculateFarm() {\r\n        let { nodes, beams } = Farm.normalize(this.state.nodes, this.state.beams)\r\n        this.setState({\r\n            nodes,\r\n            beams\r\n        })\r\n        try {\r\n            const { P, LinkNodes, Vi } = await FarmCalc.init(nodes, beams)\r\n            nodes = nodes.map((node, i) => {\r\n                return {\r\n                    ...node,\r\n                    newX: Vi[i].x,\r\n                    newY: Vi[i].y,\r\n                    withNewPosition: true\r\n                }\r\n            })\r\n            P.forEach((row, i) => {\r\n                const link = (LinkNodes[i].x + 1) + \" - \" + (LinkNodes[i].y + 1)\r\n                console.log(`${i + 1} - [${link}] P1: ${row[0]}; P2: ${row[1]}; `);\r\n            })\r\n            this.setState({\r\n                nodes\r\n            })\r\n\r\n\r\n        } catch (e) {\r\n            if (e.message)\r\n                alert(e.message)\r\n            else alert(e)\r\n            console.error(e);\r\n        }\r\n    }\r\n    defautlFarm() {\r\n        let _farm = testFarm()\r\n        localStorage.removeItem('nodes')\r\n        localStorage.removeItem('beams')\r\n        \r\n        _farm = FarmFactory.firstPlacement(_farm.nodes, _farm.beams)\r\n        const {nodes,beams} = _farm\r\n        this.setState({\r\n            nodes,\r\n            beams,\r\n        })\r\n    }\r\n    saveFarm() {\r\n        const { nodes, beams } = this.state\r\n        localStorage.setItem('nodes', JSON.stringify(nodes))\r\n        localStorage.setItem('beams', JSON.stringify(beams))\r\n    }\r\n    render() {\r\n        return (\r\n            <UIFarm\r\n                {...this.state}\r\n                {...this}\r\n            />\r\n        )\r\n    }\r\n}\r\nexport default FarmContainer","import { FarmNode, NodeFixation } from \"src/models/Farm/ModelNode\";\r\nimport { Beam } from \"src/models/Farm/ModelBeam\";\r\nimport {  FarmFactory } from \"src/models/Farm/ModelFarm\";\r\n\r\nexport default () => {\r\n    let nodes: FarmNode[] = []\r\n    let beams: Beam[] = []\r\n\r\n    nodes = FarmFactory.createNodes(\r\n        [\r\n            {\r\n                x: 0,\r\n                y: 1000,\r\n                fixation: NodeFixation.XY,\r\n            },\r\n            {\r\n                x: 3000,\r\n                y: 1000,\r\n                fixation: NodeFixation.Y,\r\n            }\r\n        ],\r\n        [\r\n            {\r\n                x: 1000,\r\n                y: 1000,\r\n                angle: 90,\r\n                value: 9000\r\n            }\r\n        ],\r\n        [\r\n            // {\r\n            //     x: 1000,\r\n            //     y: 1000\r\n            // }, {\r\n            //     x: 700,\r\n            //     y: 700\r\n            // }, {\r\n            //     x: 1000,\r\n            //     y: 700\r\n            // }\r\n        ]\r\n    )\r\n\r\n    return { nodes, beams }\r\n}","export const navPath = {\r\n    HOME_PAGE: '/',\r\n    FARM_PAGE: '/farm'\r\n}\r\n\r\n","import * as React from 'react'\r\nimport { consts } from 'src/static';\r\nimport { Typography, Button, Theme, createStyles } from '@material-ui/core';\r\nimport { Link } from 'react-router-dom';\r\nimport { navPath } from 'src/navigation';\r\nimport { WithStyles, withStyles } from '@material-ui/styles';\r\n\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n\troot:{\r\n\t\tdisplay: \"flex\",\r\n\t\tflexDirection: \"column\",\r\n\t\talignItems: \"center\",\r\n\t\tjustifyContent: \"flex-start\",\r\n\r\n\t},\r\n\tlogo: {\r\n\t\twidth: \"20%\",\r\n\t\theight:'20%'\r\n\t},\r\n\ttitle: {\r\n\t\tpadding: 40\r\n\t},\r\n\tdescripton: {\r\n\t\tpadding: 40\r\n\t},\r\n\tbtn: {\r\n\r\n\t}\r\n})\r\n\r\n\r\nconst HomeHeader = ({classes} : WithStyles<typeof styles>) => {\r\n\treturn (\r\n\t\t<header className={classes.root}>\r\n\t\t\t<img \r\n\t\t\t\tsrc={consts.bridgeIcon_2} \r\n\t\t\t\talt=\"logo\" \r\n\t\t\t\tclassName={classes.logo} \r\n\t\t\t/>\r\n\t\t\t<Typography variant=\"h3\" className={classes.title}>\r\n\t\t\t\t{consts.title}\r\n\t\t\t</Typography>\r\n\t\t\t<Typography variant=\"subtitle1\" align=\"center\" className={classes.descripton}>\r\n\t\t\t\t{consts.description}\r\n\t\t\t</Typography>\r\n\t\t\t<Button\r\n\t\t\t\tcomponent={Link}\r\n\t\t\t\tto={navPath.FARM_PAGE}\r\n\t\t\t\tvariant=\"contained\"\r\n\t\t\t\tsize=\"large\"\r\n\t\t\t\tcolor=\"secondary\"\r\n\t\t\t>\r\n\t\t\t\tПоехали\r\n\t\t\t</Button>\r\n\t\t</header>\r\n\r\n\t)\r\n}\r\n\r\nexport default withStyles(styles)(HomeHeader)","import * as React from 'react'\r\nimport { IHomeStore } from 'src/store/home/homeReducer';\r\nimport { Theme, WithStyles, createStyles, withStyles } from '@material-ui/core'\r\nimport { HomeHeader } from './components';\r\n\r\nconst styles = (theme: Theme) => createStyles({\r\n\troot: {\r\n\t\twidth:'100%',\r\n\t\tminHeight:'100%',\r\n\t\tdisplay:'block',\r\n\t\tbackground: theme.palette.background.default,\r\n\t\tpadding: theme.spacing(4)\r\n\t}\r\n})\r\n\r\nexport interface IHomeProps extends IHomeStore, WithStyles<typeof styles> {\r\n\tsetTitle: (title: string) => void,\r\n}\r\n\r\nclass Home extends React.Component<IHomeProps> {\r\n\trender() {\r\n\t\tconst { classes } = this.props\r\n\t\treturn (\r\n\t\t\t<div className={classes.root}>\r\n\t\t\t\t<HomeHeader/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Home)","import {connect} from 'react-redux'\r\nimport Home from './home'\r\nimport { AppState } from 'src/store';\r\nimport { Dispatch, bindActionCreators } from 'redux';\r\nimport * as homeActions from 'src/store/home/homeActions';\r\n\r\nconst mapStateToProps =  ({home}: AppState) => ({\r\n    title:home.title,\r\n})\r\nconst mapDispatchToProps = (dispatch: Dispatch) => bindActionCreators({...homeActions}, dispatch)\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(Home);","import * as React from 'react';\r\nimport { Switch, Route } from 'react-router-dom';\r\nimport Helment from 'react-helmet'\r\nimport {CssBaseline} from '@material-ui/core';\r\nimport { ThemeProvider } from '@material-ui/styles';\r\nimport { FarmPage, Home } from './pages'\r\nimport { navPath } from './navigation'\r\nimport {consts} from './static/';\r\nimport { theme } from './utils/UI';\r\n\r\ninterface IAppProps {}\r\n\r\nclass App extends React.Component<IAppProps> {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Helment\r\n\t\t\t\t\thtmlAttributes={{\"leng\":\"en\"}}\r\n\t\t\t\t\ttitleTemplate=\"Truss - %s\"\r\n\t\t\t\t\tdefaultTitle={consts.title}\r\n\t\t\t\t\tlink={[\r\n\t\t\t\t\t\t{\"rel\":\"shortcut icon\", \"href\":consts.bridgeIcon_2},\r\n\t\t\t\t\t\t{\"rel\":\"image_src\", \"href\":consts.airBridge},\r\n\t\t\t\t\t\t{\"rel\":\"stylesheet\", \"href\":'https://fonts.googleapis.com/css?family=Roboto:300,400,500'},\r\n\t\t\t\t\t\t{\"rel\":\"stylesheet\", \"href\":'https://fonts.googleapis.com/icon?family=Material+Icons'}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tmeta={[\r\n\t\t\t\t\t\t{\"charSet\":\"utf-8\"},\r\n\t\t\t\t\t\t{\"name\": \"viewport\", \"content\": \"minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no\" },\r\n\t\t\t\t\t\t{\"name\": \"theme-color\", \"content\": \"#000000\" },\r\n\t\t\t\t\t\t{\"name\": \"description\", \"content\": consts.description },\r\n\t\t\t\t\t\t{\"property\": \"og:type\", \"content\": \"website\"},\r\n\t\t\t\t\t\t{\"property\": \"og:title\", \"content\": consts.title},\r\n\t\t\t\t\t\t{\"property\": \"og:image\", \"content\": consts.airBridge},\r\n\t\t\t\t\t\t{\"property\": \"vk:image\", \"content\": consts.airBridge},\r\n\t\t\t\t\t\t{\"property\": \"twitter:image\", \"content\": consts.airBridge},\r\n\t\t\t\t\t\t{\"property\": \"og:url\", \"content\": consts.url},\r\n\t\t\t\t\t]}\r\n\r\n\t\t\t\t/>\r\n\t\t\t\t<CssBaseline/>\r\n\t\t\t\t<ThemeProvider theme={theme}>\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route path={navPath.HOME_PAGE} component={Home} exact />\r\n\t\t\t\t\t\t<Route path={navPath.FARM_PAGE} component={FarmPage} />\r\n\t\t\t\t\t</Switch>\r\n\r\n\t\t\t\t</ThemeProvider>\r\n\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n}\r\n\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { Provider } from 'react-redux'\r\nimport { history } from './utils';\r\nimport store from './store';\r\nimport { HashRouter, Router } from 'react-router-dom';\r\nimport App from './App';\r\nimport './index.css';\r\n\r\nconst isGitHubPages = process.env.REACT_APP_GHP === 'true' || false;\r\n\r\nconst Root = () => {    \r\n    if (isGitHubPages) return (\r\n        <HashRouter>\r\n            <App />\r\n        </HashRouter>\r\n    )\r\n    else return (\r\n        <Router history={history}>\r\n            <App />\r\n        </Router>\r\n    )\r\n}\r\n\r\n\r\nReactDOM.render(\r\n    <Provider store={store}>\r\n        <Root/>\r\n    </Provider>,\r\n    document.getElementById('root')\r\n);"],"sourceRoot":""}