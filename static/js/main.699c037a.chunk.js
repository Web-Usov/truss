(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"str",function(){return p}),n.d(t,"UI",function(){return b}),n.d(t,"canvas",function(){return v}),n.d(t,"img",function(){return g});var a=n(130),r=n.n(a),o=n(191),i=n.n(o),c=n(192),s=n.n(c),l=n(193),u=n.n(l),d=n(194),m=n.n(d),f=n(195),h=n.n(f),p={url:"https://web-usov.github.io/truss",title:"Truss - \u0444\u0435\u0440\u043c\u0430 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e",description:"\u0424\u0435\u0440\u043c\u0430 (farm \u0438\u043b\u0438 truss) \u2014 \u0441\u0442\u0435\u0440\u0436\u043d\u0435\u0432\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0432 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0435, \u043e\u0441\u0442\u0430\u044e\u0449\u0430\u044f\u0441\u044f \u0433\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435\u0438\u0437\u043c\u0435\u043d\u044f\u0435\u043c\u043e\u0439 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043c\u0435\u043d\u044b \u0435\u0451 \u0436\u0451\u0441\u0442\u043a\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 \u0448\u0430\u0440\u043d\u0438\u0440\u043d\u044b\u043c\u0438.",favicon:r.a.resolve(e,"favicon.ico")},b={cellSize:45,MMinCell:200,koefOfNewPos:100,nodeSize:0,beamSize:0,koefOnGrid:0,sidebarWidth:240};b.nodeSize=b.cellSize/3,b.beamSize=b.cellSize/7,b.koefOnGrid=b.MMinCell/b.cellSize;var v={width:2500,height:1500},g={ogImage:i.a,bridgeIcon_1:s.a,bridgeIcon_2:u.a,airBridge:m.a,FixationIcon:h.a}}.call(this,"/")},191:function(e,t,n){e.exports=n.p+"static/media/ogImage.0619e300.png"},192:function(e,t,n){e.exports=n.p+"static/media/icon.68e274b2.png"},193:function(e,t,n){e.exports=n.p+"static/media/bridge.e53bced3.png"},194:function(e,t,n){e.exports=n.p+"static/media/airBridge.7d581a65.png"},195:function(e,t,n){e.exports=n.p+"static/media/fixation.dd261ca6.svg"},215:function(e,t,n){e.exports=n(397)},301:function(e,t){},302:function(e,t){},303:function(e,t){},307:function(e,t){},309:function(e,t){},344:function(e,t){},345:function(e,t){},396:function(e,t,n){},397:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"UIModes",function(){return s}),n.d(a,"theme",function(){return E}),n.d(a,"getNodeColor",function(){return k}),n.d(a,"getNodeStorkeColor",function(){return O}),n.d(a,"getNodeStorkeWidth",function(){return w}),n.d(a,"getBeamColor",function(){return x}),n.d(a,"nodeMouseEnter",function(){return I}),n.d(a,"nodeMouseLeave",function(){return j}),n.d(a,"beamMouseEnter",function(){return N}),n.d(a,"beamMouseLeave",function(){return S});var r={};n.r(r),n.d(r,"mainBackGround",function(){return C}),n.d(r,"node",function(){return M}),n.d(r,"staticNode",function(){return D}),n.d(r,"fixedNode",function(){return B}),n.d(r,"beam",function(){return U});var o={};n.r(o),n.d(o,"defaultState",function(){return P}),n.d(o,"reducer",function(){return T});var i={};n.r(i),n.d(i,"setTitle",function(){return q});var c={};n.r(c),n.d(c,"defaultHomeState",function(){return J}),n.d(c,"reducer",function(){return $});var s,l=n(0),u=n.n(l),d=n(23),m=n.n(d),f=n(108),h=n(42),p=(Object(h.a)(),n(18)),b=n(16),v=n(15),g=n(208);!function(e){e[e.none=0]="none",e[e.move=1]="move",e[e.addNode=2]="addNode",e[e.addBeam=3]="addBeam",e[e.addBeamStart=4]="addBeamStart",e[e.delete=5]="delete"}(s||(s={}));var y,E=Object(g.a)({palette:{primary:{dark:"#0A4467",main:"#1e779e",light:"#51A8D6"},secondary:{dark:"#a83e19",main:"#f15a24",light:"#F39B7C"},background:{default:"linear-gradient(35deg, #6863bf 0%, #067d93 50%, #e68a68 100%)"}}}),k=function(e){return e.isStatic?e.fixation?r.fixedNode:r.staticNode:r.node},O=function(e,t){switch(t){case s.move:return e.isStatic?E.palette.secondary.dark:E.palette.primary.light;case s.addBeam:case s.addBeamStart:return E.palette.primary.light;default:return E.palette.secondary.main}},w=function(e,t){switch(t){case s.move:return e.isStatic?0:2;case s.addBeam:case s.addBeamStart:return 2;default:return 0}},x=function(e){return r.beam},I=function(e,t,n){var a=e.target.getStage();switch(n){case s.delete:if(t.isStatic){a.container().style.cursor="default";break}a.container().style.cursor="pointer";break;case s.none:a.container().style.cursor="pointer";break;case s.addBeam:case s.addBeamStart:a.container().style.cursor="crosshair";break;case s.move:if(t.isStatic){a.container().style.cursor="default";break}a.container().style.cursor="move"}},j=function(e){var t=e.target.getStage();t&&(t.container().style.cursor="default")},N=function(e,t,n){var a=e.target.getStage();switch(n){case s.delete:case s.none:a.container().style.cursor="pointer"}},S=function(e){var t=e.target.getStage();t&&(t.container().style.cursor="default")},C="#09B4D3",M=E.palette.secondary.main,D=E.palette.secondary.dark,B=E.palette.secondary.dark,U=E.palette.secondary.light,F=n(448),X=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"angleBePoints",value:function(e,t,n,a){return Math.atan2(-t+a,-e+n)/Math.PI}},{key:"lengthBePoints",value:function(e,t,n,a){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-a,2))}},{key:"cellX",value:function(e){return Math.round(e/v.UI.cellSize)*v.UI.cellSize}},{key:"cellY",value:function(e){return Math.round(e/v.UI.cellSize)*v.UI.cellSize}},{key:"signum",value:function(e){return e>0?1:e<0?-1:0}},{key:"multMatrxi",value:function(e,t){var n=e.length,a=t.length,r=e[0].length,o=t[0].length,i=[];if(r!==a)throw new Error("\u0420\u0430\u0437\u043c\u0435\u0440\u043d\u043e\u0441\u0442\u044c \u043c\u0430\u0442\u0440\u0438\u0446 \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u043f\u0435\u0440\u0435\u0443\u043c\u043d\u043e\u0436\u0438\u0442\u044c \u0438\u0445");for(var c=0;c<n;c++){for(var s=[],l=0;l<o;l++)s.push(0);i.push(s)}for(var u=0;u<o;u++)for(var d=0;d<n;d++){for(var m=0,f=0;f<a;f++)m+=e[d][f]+t[f][u];i[d][u]=m}return i}},{key:"multMatrxiV2",value:function(e,t){var n=[];try{n=F.b(e,t)}catch(a){console.error("multMatrxiV2:",a)}return n}},{key:"getDetMatrix",value:function(e){return F.a(e)}}]),e}(),Y=n(59),z=n(24),L=n(6),P={nodes:[],beams:[],forces:[]},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NODE":var n=t.node;return Object(L.a)({},e,{nodes:[].concat(Object(z.a)(e.nodes),[n])});case"ADD_BEAM":var a=t.beam;return Object(L.a)({},e,{beams:[].concat(Object(z.a)(e.beams),[a])});case"ADD_FORCE":var r=t.force;return Object(L.a)({},e,{forces:[].concat(Object(z.a)(e.forces),[r])});case"EDIT_NODE":return Object(L.a)({},e,{nodes:e.nodes.map(function(e){return e.id===t.node.id?Object(L.a)({},e,t.node):e})});case"EDIT_BEAM":return Object(L.a)({},e,{beams:e.beams.map(function(e){return e.id===t.beam.id?Object(L.a)({},e,t.beam):e})});case"DELETE_ENTITY":return{beams:e.beams.filter(function(e){return e.id!==t.id}),nodes:e.nodes.filter(function(e){return e.id!==t.id}),forces:e.forces.filter(function(e){return e.id!==t.id})};default:return e}},_=n(60),G=n.n(_),W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.x,n=e.y,a=e.name,r=e.angle,o=e.id,i=e.newX,c=e.newY,s=e.type,l=e.withNewPosition,u={id:o||G()(),x:t||0,y:n||0,angle:r||0,name:a||"",newX:i||t||0,newY:c||n||0,type:s||"entity",withNewPosition:l||!1};return u.name=a||u.id,u},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.angle,n=e.nodeID,a=e.value,r=W(e);return Object(L.a)({},r,{type:"force",angle:t||0,nodeID:n||"",value:a||0})},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.length,n=e.startConnectedNodeID,a=e.endConnectedNodeID,r=e.endX,o=e.endY,i=e.newEndX,c=e.newEndY,s=e.startForce,l=e.endForce,u=W(e);return Object(L.a)({},u,{type:"beam",length:t||0,startConnectedNodeID:n||"",endConnectedNodeID:a||"",endX:r||u.x||0,endY:o||u.y||0,newEndX:i||r||u.x||0,newEndY:c||o||u.y||0,startForce:s||0,endForce:l||0})},A=function(e){return e&&"beam"===e.type};!function(e){e[e.None=0]="None",e[e.X=1]="X",e[e.Y=2]="Y",e[e.XY=3]="XY",e[e.YX=3]="YX"}(y||(y={}));var K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.beamsID,n=e.forceX,a=e.forceY,r=e.isStatic,o=e.fixation,i=W(e);return Object(L.a)({},i,{type:"node",beamsID:t||[],forceX:n,forceY:a,isStatic:r||!1,fixation:o||y.None})},R=function(e){return e&&"node"===e.type},q=function(e){return{type:"SET_TITLE",title:e}},J={title:"Hello, world!"},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TITLE":return Object(L.a)({},e,{title:t.title});default:return e}},Q=n(197),Z=Object(Y.c)({farm:o.reducer,home:c.reducer}),ee=Object(Y.d)(Z,Object(Y.a)(Q.a)),te=n(66),ne=n(62),ae=n(30),re=n(29),oe=n(31),ie=n(198),ce=n.n(ie),se=n(454),le=n(447),ue=n(55),de=n.n(ue),me=n(74),fe=n(19),he=n(35),pe=v.UI.nodeSize,be=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(ae.a)(this,Object(re.a)(t).call(this,e))).viewForce=n.viewForce.bind(Object(fe.a)(n)),n}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"shouldComponentUpdate",value:function(e){return e.node!==this.props.node||e.mode!==this.props.mode||e.selected!==this.props.selected}},{key:"viewForce",value:function(e){if(!this.props.viewNewPos)return l.createElement(l.Fragment,null,l.createElement(he.Arrow,{points:[0,0,v.UI.cellSize,0],stroke:a.theme.palette.grey[300],strokeWidth:pe/3,shadowBlur:2,pointerLength:v.UI.cellSize/10,pointerWidth:v.UI.cellSize/10,hitStrokeWidth:2*pe,rotation:e.value>0?e.angle:180+e.angle}),l.createElement(he.Text,{x:0===e.angle?e.value>0?v.UI.cellSize/3:-v.UI.cellSize:v.UI.cellSize/3,y:90===e.angle?e.value>0?v.UI.cellSize/3:-v.UI.cellSize/2:-v.UI.cellSize/1.5,text:e.value+" H"}))}},{key:"viewFixation",value:function(e){return l.createElement(he.Group,{x:0,y:0,rotation:e},l.createElement(he.Line,{points:[0,0,0,v.UI.cellSize,-v.UI.cellSize/2,v.UI.cellSize,v.UI.cellSize/2,v.UI.cellSize],stroke:a.theme.palette.grey[300],strokeWidth:pe/4,shadowBlur:2}),l.createElement(he.Circle,{radius:pe/2,fill:a.theme.palette.grey[500],x:0,y:v.UI.cellSize-pe/1.7}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClick,r=t.mode,o=t.selected,i=t.node,c=t.viewNewPos,u=c?i.newX/v.UI.koefOnGrid:i.x/v.UI.koefOnGrid,d=c?i.newY/v.UI.koefOnGrid:i.y/v.UI.koefOnGrid;return l.createElement(he.Group,{opacity:c?.3:1,x:u,y:d,_useStrictMode:!0,onClick:c?function(){}:function(e){return n(e,i)}},i.forceX&&this.viewForce(i.forceX),i.forceY&&this.viewForce(i.forceY),i.fixation===y.X&&this.viewFixation(90),i.fixation===y.Y&&this.viewFixation(0),i.fixation===y.XY&&this.viewFixation(90),i.fixation===y.YX&&this.viewFixation(0),l.createElement(he.Circle,{radius:pe,x:0,y:0,fill:a.getNodeColor(i),shadowBlur:o&&!c?8:2,stroke:a.getNodeStorkeColor(i,r),strokeWidth:a.getNodeStorkeWidth(i,r),hitStrokeWidth:c?0:2*pe}),l.createElement(he.Text,{x:-pe,y:-pe/2-1,align:"center",fontSize:18,fill:"#fff",shadowBlur:8,fontFamily:"Trebuchet MS",width:2*pe,verticalAlign:"middle",text:i.name}),l.createElement(he.Circle,{radius:pe,x:0,y:0,onDragEnd:function(e){e.target.to({x:0,y:0})},hitStrokeWidth:c?0:2*pe,draggable:r===s.move&&!i.isStatic&&!c,onMouseEnter:c?function(){}:function(e){return a.nodeMouseEnter(e,i,r)},onMouseLeave:c?function(){}:function(e){return a.nodeMouseLeave(e)},onDragMove:function(t){return e.props.drag(t,i)}}))}}]),t}(l.Component),ve=function(e){function t(){return Object(p.a)(this,t),Object(ae.a)(this,Object(re.a)(t).apply(this,arguments))}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.beam,a=t.mode,r=t.selected;return e.beam!==n||e.mode!==a||e.selected!==r}},{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.mode,r=e.selected,o=e.beam,i=e.viewNewPos,c=v.UI.beamSize,s=[o.x/v.UI.koefOnGrid,o.y/v.UI.koefOnGrid,o.endX/v.UI.koefOnGrid,o.endY/v.UI.koefOnGrid];return i&&(s=[o.newX/v.UI.koefOnGrid,o.newY/v.UI.koefOnGrid,o.newEndX/v.UI.koefOnGrid,o.newEndY/v.UI.koefOnGrid]),l.createElement(he.Line,{opacity:i?.3:1,points:s,stroke:a.getBeamColor(o),strokeWidth:c,shadowBlur:r&&!i?8:2,hitStrokeWidth:i?0:4*c,onClick:i?function(){}:function(e){return t(e,o)},onMouseEnter:i?function(){}:function(e){return a.beamMouseEnter(e,o,n)},onMouseLeave:i?function(){}:function(e){return a.beamMouseLeave(e)}})}}]),t}(l.Component),ge=n(453),ye=n(449),Ee=n(7),ke=function(e){var t=e.widthCell,n=e.heightCell,a=e.heightBox,r=e.widthBox,o=r/t,i=a/n;return l.createElement(l.Fragment,null,function(){for(var e=[],n=0;n<o;n++)e.push(l.createElement(he.Line,{points:[n*t,0,n*t,a],stroke:"#ddd",strokeWidth:1,key:n}));return e}(),function(){for(var e=[],t=0;t<i;t++)e.push(l.createElement(he.Line,{points:[0,t*n,r,t*n],stroke:"#ddd",strokeWidth:1,key:t}));return e}())},Oe=n(199),we=n.n(Oe),xe=Object(Ee.a)(function(e){return Object(ge.a)({root:{backgroundColor:"#ddd",display:"flex",alignItems:"center",justifyContent:"center"},stage:{backgroundColor:"#fff",boxShadow:e.shadows[2],borderRadius:8}})})(function(e){var t=e.classes,n=e.stage,a=e.stageHeight,r=e.stageWidth,o=e.onClick,i=e.onMouseMove,c=e.onDrag,s=e.beams,u=e.nodes,d=e.uiMode,m=e.selectedEntity,f=e.viewNewPos;return l.createElement(we.a,{autoHide:!0},l.createElement(ye.a,{style:{width:r+2*v.UI.sidebarWidth+20,height:a+v.UI.sidebarWidth},className:t.root},l.createElement(he.Stage,{height:a,width:r,style:{height:a,width:r},className:t.stage,onClick:o,onMouseMove:i,ref:n},l.createElement(he.Layer,{className:"layer"},l.createElement(ke,{heightCell:v.UI.cellSize,widthCell:v.UI.cellSize,heightBox:a,widthBox:r}),s.map(function(e){return l.createElement(ve,{key:e.id,beam:e,mode:d,onClick:o,selected:m===e})}),u.map(function(e){return l.createElement(be,{key:e.id,node:e,mode:d,drag:c,onClick:o,selected:m===e})}),f&&s.map(function(e){return l.createElement(ve,{key:e.id,beam:e,mode:d,onClick:o,selected:m===e,viewNewPos:!0})}),f&&u.map(function(e){return l.createElement(be,{key:e.id,node:e,mode:d,drag:c,onClick:o,selected:m===e,viewNewPos:!0})})))))}),Ie=n(428),je=n(451),Ne=n(109),Se=n(422),Ce=n(452),Me=n(423),De=n(424),Be=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(ae.a)(this,Object(re.a)(t).call(this,e))).state={open:!0,viewTooltip:!1},n.switchDrawer=n.switchDrawer.bind(Object(fe.a)(n)),n}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"componentWillMount",value:function(){if(this.props.title){var e=localStorage.getItem("Sidebar_state:"+this.props.title);e&&this.setState({open:"true"===e})}}},{key:"switchDrawer",value:function(){localStorage.setItem("Sidebar_state:"+this.props.title,this.state.open?"false":"true"),this.setState({open:!this.state.open,viewTooltip:!1})}},{key:"changeViewtooltip",value:function(e){this.setState({viewTooltip:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.children,r=t.title,o=t.btnIcon,i=t.anchor,c=this.state,s=c.open,u=c.viewTooltip;return l.createElement(l.Fragment,null,l.createElement(je.a,{className:n.drawer,variant:"persistent",open:s,anchor:i,classes:{paper:n.drawerPaper}},l.createElement("div",{className:n.toolbar}),l.createElement(Ne.a,{variant:"body2",align:"center",className:n.title},r),l.createElement(Se.a,null),a),l.createElement(Ce.a,{title:r,open:void 0!==r&&u&&!s,onOpen:function(){return e.changeViewtooltip(!0)},onClose:function(){return e.changeViewtooltip(!1)}},l.createElement(Me.a,{style:{left:"left"===i?s?v.UI.sidebarWidth+15:15:"auto",right:"right"===i?s?v.UI.sidebarWidth+15:15:"auto"},color:"secondary",size:"medium",className:n.toogleIcon,onClick:this.switchDrawer},s?l.createElement(De.a,null):o)))}}]),t}(l.PureComponent),Ue=Object(Ee.a)(function(e){return Object(ge.a)({drawer:{position:"relative"},drawerPaper:{width:v.UI.sidebarWidth},toogleIcon:{position:"absolute",top:e.spacing(10),zIndex:e.zIndex.drawer+1},title:{padding:e.spacing(1)},toolbar:e.mixins.toolbar})})(Be),Fe=n(4),Xe=n(425),Ye=n(426),ze=Object(Ee.a)(function(e){return Object(ge.a)({appBar:{zIndex:e.zIndex.drawer+1},logo:{marginRight:e.spacing(4),marginLeft:e.spacing(2),"& img":{width:50,height:"auto"}}})})(function(e){var t=e.classes,n=e.children,a=e.className,r=e.color,o=e.position,i=e.withLogo,c=void 0===i||i;return l.createElement(Xe.a,{position:o||"fixed",className:Object(Fe.a)(t.appBar,a),color:r||"primary"},l.createElement(Ye.a,null,function(){if(c)return l.createElement(te.b,{to:"/",className:t.logo},l.createElement("img",{alt:"Logo Icon",src:v.img.bridgeIcon_2}))}(),n))}),Le=n(99),Pe=n(205),Te=n(427),_e=n(21),Ge=Object(Ee.a)(function(e){return Object(ge.a)({btn:{marginLeft:e.spacing(2),marginRight:e.spacing(2),borderRadius:"50% !important",border:"1px solid ".concat(Object(_e.b)(e.palette.action.active,.2)," !important"),transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.light,"&$selected":{backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark}},"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main},"&$disabled":{backgroundColor:e.palette.secondary.main}}},selected:{}})})(function(e){var t=e.selected,n=e.classes,a=e.value,r=e.name,o=e.icon,i=Object(Pe.a)(e,["selected","classes","value","name","icon"]);return l.createElement(Te.a,Object.assign({key:r,value:a,className:Object(Fe.a)(n.btn,Object(Le.a)({},n.selected,t))},i),l.createElement(Ce.a,{title:r},o))}),We=Object(Ee.a)(function(e){return Object(ge.a)({root:{},btn:{marginLeft:e.spacing(2),marginRight:e.spacing(2)},grow:{flexGrow:1}})})(function(e){var t=e.classes,n=e.hundleSave,a=void 0===n?function(e){alert("\u0411\u0443\u0435\u0434\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c")}:n,r=e.hundleClear,o=void 0===r?function(e){alert("\u0411\u0443\u0435\u0434\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c")}:r,i=e.hundleCalculate,c=void 0===i?function(e){alert("\u0411\u0443\u0435\u0434\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c")}:i,s=e.disabled,u=void 0!==s&&s;return l.createElement(ze,{className:t.root},l.createElement("div",{className:t.grow}),l.createElement(Ie.a,{color:"secondary",variant:"contained",className:t.btn,onClick:c,disabled:u},"\u0420\u0430\u0441\u0447\u0435\u0442"),l.createElement(Ie.a,{color:"secondary",variant:"contained",className:t.btn,onClick:a,disabled:u},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),l.createElement(Ie.a,{color:"secondary",variant:"contained",className:t.btn,onClick:o,disabled:u},"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))}),Ve=n(429),He=n(430),Ae=n(431),Ke=n(432),Re=n(435),qe=n(436),Je=n(433),$e=n(434),Qe=n(437),Ze=n(438),et=n(439),tt=n(440),nt=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(ae.a)(this,Object(re.a)(t).call(this,e))).state={open:!1,tabs:new Map},n.openTab=n.openTab.bind(Object(fe.a)(n)),n.viewListItem=n.viewListItem.bind(Object(fe.a)(n)),n}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"componentWillMount",value:function(){var e=this.state.tabs;e.set("\u0423\u0437\u043b\u044b",!0),e.set("\u0421\u0442\u0435\u0440\u0436\u043d\u0438",!0),this.setState({tabs:new Map(e)})}},{key:"openTab",value:function(e){var t=this.state.tabs;t.set(e,!t.get(e)),this.setState({tabs:new Map(t)})}},{key:"viewListItem",value:function(e,t,n){var r=this,o=this.props,i=o.selectedEntity,c=o.classes,s=o.onSelect,u=this.state.tabs;return l.createElement(ye.a,null,l.createElement(Ve.a,{button:!0,onClick:function(){return r.openTab(t)}},n&&l.createElement(He.a,null,l.createElement(Ae.a,{badgeContent:e.length,color:"secondary"},n)),l.createElement(Ke.a,{primary:t}),u.get(t)?l.createElement(Je.a,null):l.createElement($e.a,null)),l.createElement(Re.a,{in:u.get(t),timeout:"auto",unmountOnExit:!0},l.createElement(qe.a,{component:"div",disablePadding:!0},e.map(function(e){return l.createElement(Ve.a,{button:!0,className:c.nested,key:e.id,selected:i===e,onClick:function(t){return s(e)}},R(e)&&l.createElement(He.a,null,l.createElement(Qe.a,{style:{color:a.getNodeColor(e)}})),l.createElement(Ke.a,{primary:e.name}))}))),l.createElement(Se.a,null))}},{key:"render",value:function(){var e=this.props,t=e.nodes,n=e.beams;return n.sort(function(e,t){return e.name>t.name?1:-1}),l.createElement(Ue,{anchor:"left",title:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430",btnIcon:l.createElement(Ze.a,null)},this.viewListItem(t,"\u0423\u0437\u043b\u044b",l.createElement(et.a,null)),this.viewListItem(n,"\u0421\u0442\u0435\u0440\u0436\u043d\u0438",l.createElement(tt.a,null)))}}]),t}(l.PureComponent),at=Object(Ee.a)(function(e){return Object(ge.a)({nested:{paddingLeft:e.spacing(6)}})})(nt),rt=n(441),ot=n(442),it=n(443),ct=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"init",value:function(){var e=Object(me.a)(de.a.mark(function e(t,n,a,r,o){var i,c,s,l,u,d,m,f,h,p,b,v,g,y,E,k,O,w,x=this,I=arguments;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=I.length>5&&void 0!==I[5]?I[5]:{},c=i.area||225,s=i.modUpr||72e3,l=[],u=[],d=[],m=[],f=[],h=[],p=[],b=[],v=[],g=[],y=[],r.forEach(function(e,a){l.push(x.Kmest_i(c,s,o[a]));var i=x.Lambda_i(t[r[a].x],t[r[a].y],o[a]);u.push(i),d.push([[i.x,i.y,0,0],[0,0,i.x,i.y]]),m.push(x.Kobs_i(c,s,o[a],u[a])),f.push(x.IndexV_i(n[r[a].x],n[r[a].y]))}),E=r.length,k=n.length,O=Math.max.apply(Math,Object(z.a)(n.map(function(e){var t=e.x,n=e.y;return Math.max(t,n)}))),h=this.K(O,f,m),0!==X.getDetMatrix(h)){e.next=21;break}throw Error("\u0414\u0430\u043d\u043d\u0430\u044f \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f (\u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u043c\u0430\u044f) \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u043c");case 21:for(p=this.SquareRoot(h,a),b=this.Vi(n,p),v=this.Vij(r,b),w=0;w<E;w++)g.push(this.V_i(d[w],v[w])),y.push(this.P_i(l[w],g[w]));return this.farmCalcDebug&&(console.log("NodeCoord, LinkNodes, NodeV",t,r,n),console.log("Kobs, Kmest",m,l),console.log("Lambda0, Lambda,",u,d),console.log("IndexV",f),console.log("N_Link, N_Nodes, N_DOF",E,k,O),console.log("K, Force",h,a),console.log("Va",p),console.log("Vi",b),console.log("Vij",v),console.log("V",g),console.log("P",y)),e.abrupt("return",{P:y,LinkNodes:r,Vi:b});case 27:case"end":return e.stop()}},e,this)}));return function(t,n,a,r,o){return e.apply(this,arguments)}}()},{key:"Kmest_i",value:function(e,t,n){var a=e*t/n,r=[];return r.push([a,-a]),r.push([-a,a]),r}},{key:"Lambda_i",value:function(e,t,n){return{x:(t.x-e.x)/n,y:(t.y-e.y)/-n}}},{key:"Kobs_i",value:function(e,t,n,a){for(var r=e*t/n,o=[{x:a.x*a.x,y:a.x*a.y},{x:a.x*a.y,y:a.y*a.y}],i=[{x:-a.x*a.x,y:-a.x*a.y},{x:-a.x*a.y,y:-a.y*a.y}],c=[],s=[],l=0;l<2;l++)c.push({x1:o[l].x,y1:o[l].y,x2:i[l].x,y2:i[l].y}),s.push({x1:i[l].x,y1:i[l].y,x2:o[l].x,y2:o[l].y});return Array.prototype.concat(c,s).map(function(e){var t=e.x1,n=e.y1,a=e.x2,o=e.y2;return[t*r,n*r,a*r,o*r]})}},{key:"IndexV_i",value:function(e,t){return[e.x,e.y,t.x,t.y]}},{key:"K",value:function(e,t,n){for(var a=[],r=0;r<e;r++){for(var o=[],i=0;i<e;i++)o.push(0);a.push(o)}for(var c=0;c<t.length;c++)for(var s=0;s<4;s++){var l=t[c][s];if(0!==l)for(var u=0;u<4;u++){var d=t[c][u];0!==d&&(a[d-1][l-1]=a[d-1][l-1]+n[c][s][u])}}return a}},{key:"SquareRoot",value:function(e,t){if(e.length!==t.length)throw Error("SquareRoot - \u041c\u0430\u0441\u0441\u0438\u0432\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e\u0439 \u0434\u043b\u0438\u043d\u044b");for(var n=t.length,a=[],r=[],o=[],i=[],c=[],s=[],l=0;l<n+1;l++){for(var u=[],d=0;d<n;d++)u.push(0);c.push(u),a.push(u),r.push(0),o.push(0),i.push(0),s.push(0)}for(var m=1;m<=n;m++){for(var f=0;f<=n;f++)a[m][f]=e[m-1][f-1];r[m]=t[m-1]}i[1]=X.signum(a[1][1]),c[1][1]=Math.sqrt(Math.abs(a[1][1]));for(var h=2;h<=n;h++)c[1][h]=a[1][h]/(c[1][1]*i[1]);for(var p=2;p<=n;p++){for(var b=0,v=1;v<=p-1;v++)b+=c[v][p]*c[v][p]*i[v];i[p]=X.signum(a[p][p]-b),c[p][p]=Math.sqrt(Math.abs(a[p][p]-b));for(var g=1/(c[p][p]*i[p]),y=p+1;y<=n;y++){for(var E=0,k=1;k<=p-1;k++)E+=c[k][p]*i[k]*c[k][y];c[p][y]=g*(a[p][y]-E)}}s[1]=r[1]/(c[1][1]*i[1]);for(var O=2;O<=n;O++){for(var w=0,x=1;x<=O-1;x++)w+=c[x][O]*i[x]*s[x];s[O]=(r[O]-w)/(c[O][O]*i[O])}o[n]=s[n]/c[n][n];for(var I=n-1;I>=1;I--){for(var j=0,N=I+1;N<=n;N++)j+=c[I][N]*o[N];o[I]=(s[I]-j)/c[I][I]}var S=[];return o.forEach(function(e,t){0!==t&&S.push(e)}),S}},{key:"Vi",value:function(e,t){for(var n=[],a=0;a<e.length;a++){var r=Object(L.a)({},e[a]);r.x=0===r.x?0:t[r.x-1],r.y=0===r.y?0:t[r.y-1],n.push(r)}return n}},{key:"Vij",value:function(e,t){for(var n=[],a=0;a<e.length;a++){var r=e[a].x,o=e[a].y;n.push([[t[r].x],[t[r].y],[t[o].x],[t[o].y]])}return n}},{key:"V_i",value:function(e,t){return X.multMatrxiV2(e,t)}},{key:"P_i",value:function(e,t){return X.multMatrxiV2(e,t)}}]),e}();ct.farmCalcDebug=!0;var st=ct,lt=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"addNode",value:function(e,t){if(e.length>12)return null;var n=t.x,a=t.y;if(e.find(function(e){return e.x===n&&e.y===a}))return null;var r=G()();if(!r)return null;var o=e.length+1+"";return K(Object(L.a)({},t,{x:n,y:a,name:t.name||o,id:r}))}},{key:"addBeam",value:function(e,t){if(e.length>36)return null;var n=t.x,a=t.y;t.x&&t.y&&(n=t.x,a=t.y);var r=G()();return r?H(Object(L.a)({},t,{x:n,y:a,id:r})):null}},{key:"moveEntity",value:function(e,t,n){e.x=t,e.y=n,A(e)&&(e.length=this.getBeamLength(e))}},{key:"moveBeamEnd",value:function(e,t,n){e.endX=t,e.endY=n,e.length=this.getBeamLength(e)}},{key:"findOldBeam",value:function(e,t,n){return n.startConnectedNodeID===t.startConnectedNodeID&&n.endConnectedNodeID===e.id||n.startConnectedNodeID===e.id&&n.endConnectedNodeID===t.startConnectedNodeID||n.id===t.id&&n.startConnectedNodeID===e.id}},{key:"getBeamLength",value:function(e){return Math.round(X.lengthBePoints(e.x,e.y,e.endX,e.endY)-.5)}},{key:"setNodesName",value:function(e){return e.map(function(e,t){return Object(L.a)({},e,{name:t+1+""})})}},{key:"setBeamsName",value:function(e,t){var n=new Map;t.forEach(function(e){n.set(e.id,e)});var a="";return e.map(function(e){if(!e.startConnectedNodeID||!e.endConnectedNodeID)return e;var t=n.get(e.startConnectedNodeID),r=n.get(e.endConnectedNodeID);return t&&r?(a=t.name<r.name?"".concat(t.name," - ").concat(r.name):"".concat(r.name," - ").concat(t.name),Object(L.a)({},e,{name:a})):e}).sort(function(e,t){var n=e.name.split(" - "),a=Number(n[0]+n[1]),r=t.name.split(" - ");return a>Number(r[0]+r[1])?1:-1})}},{key:"sortNodes",value:function(e){var t=Object(z.a)(e);return t=t.sort(function(e,t){return e.y<t.y?-1:e.y===t.y&&e.x<t.x?-1:1}),t=this.setNodesName(t)}},{key:"update",value:function(t,n){var a=Object(z.a)(t),r=Object(z.a)(n);return{nodes:a=e.setNodesName(a),beams:r=e.setBeamsName(r,a)}}},{key:"normalize",value:function(t,n){var a=Object(z.a)(t);Object(z.a)(n);return a=t.filter(function(e){return 0!==e.beamsID.length||e.isStatic}),{nodes:a=e.sortNodes(a),beams:e.setBeamsName(n,a)}}},{key:"calculate",value:function(){var t=Object(me.a)(de.a.mark(function t(n,a,r){var o,i,c,s,l,u,d,m;return de.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=[],i=[],c=[],s=[],l=[],u=new Map,!n.find(function(e){return 0===e.beamsID.length&&e.isStatic})){t.next=8;break}throw new Error("\u041d\u0435 \u0432\u0441\u0435 \u0443\u0437\u043b\u044b \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u044b");case 8:return d=0,n.forEach(function(e,t){switch(o.push({x:e.x,y:e.y}),u.set(e.id,e),e.fixation){case y.X:d++,i.push({x:0,y:d}),e.forceY&&s.push(-e.forceY.value);break;case y.Y:d++,i.push({x:d,y:0}),e.forceX?s.push(-e.forceX.value):s.push(0);break;case y.YX:case y.XY:i.push({x:0,y:0});break;case y.None:d++,i.push({x:d,y:d+1}),d++,e.forceX?s.push(-e.forceX.value):s.push(0),e.forceY?s.push(-e.forceY.value):s.push(0)}}),a.forEach(function(t,n){var a=t.name.split(" - ");c.push({x:Number(a[0])-1,y:Number(a[1])-1}),l.push(e.getBeamLength(t))}),t.next=13,st.init(o,i,s,c,l,r);case 13:return m=t.sent,t.abrupt("return",m);case 15:case"end":return t.stop()}},t)}));return function(e,n,a){return t.apply(this,arguments)}}()},{key:"correctAfterCalc",value:function(e,t,n){var a=n.Vi,r=n.P,o=new Map;return{nodes:e.map(function(e,t){var n=Object(L.a)({},e,{newX:Math.round(e.x+a[t].x*v.UI.koefOfNewPos),newY:Math.round(e.y-a[t].y*v.UI.koefOfNewPos),withNewPosition:!0});return o.set(n.id,n),n}),beams:t.map(function(e,t){var n=o.get(e.startConnectedNodeID),a=o.get(e.endConnectedNodeID);return Object(L.a)({},e,{newX:n.newX,newY:n.newY,newEndX:a.newX,newEndY:a.newY,startForce:Math.round(r[t][0][0]),endForce:Math.round(r[t][1][0]),withNewPosition:!0})})}}}]),e}(),ut=function(e){var t=e.text;e.className;return l.createElement(l.Fragment,null,l.createElement(Ne.a,{variant:"subtitle2"},t),l.createElement(Se.a,null))},dt=function(e){var t=e.text;e.className;return 0===t.length?l.createElement(l.Fragment,null):l.createElement(l.Fragment,null,t.map(function(e,t){return l.createElement(Ne.a,{variant:"subtitle2",key:t},e)}),l.createElement(Se.a,null))},mt=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(ae.a)(this,Object(re.a)(t).call(this,e))).state={},n}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"viewFixationInfo",value:function(e){switch(e.fixation){case y.X:return l.createElement(ut,{text:"\u0424\u0438\u043a\u0441\u0430\u0446\u0438\u044f \u043f\u043e \u043e\u0441\u0438 X"});case y.Y:return l.createElement(ut,{text:"\u0424\u0438\u043a\u0441\u0430\u0446\u0438\u044f \u043f\u043e \u043e\u0441\u0438 Y"});case y.XY:return l.createElement(ut,{text:"\u0424\u0438\u043a\u0441\u0430\u0446\u0438\u044f \u043f\u043e \u043e\u0441\u044f\u043c \u0425 \u0438 Y"});default:return}}},{key:"NodeInfo",value:function(e){var t=this.props,n=t.classes,a=t.onDelete;return l.createElement(ye.a,{className:n.root},l.createElement(Ne.a,{variant:"h6",className:n.title},"\u0423\u0437\u0435\u043b ",e.name),l.createElement(dt,{text:["X: ".concat(e.x," \u043c\u043c"),"Y: ".concat(e.y," \u043c\u043c")]}),e.withNewPosition&&l.createElement(dt,{text:["X': ".concat(e.newX," \u043c\u043c"),"Y': ".concat(e.newY," \u043c\u043c")]}),e.forceX&&l.createElement(dt,{text:["\u0421\u0438\u043b\u0430: ".concat(e.forceX.value," H"),"\u0423\u0433\u043e\u043b: ".concat(e.forceX.angle,"\xb0")]}),e.forceY&&l.createElement(dt,{text:["\u0421\u0438\u043b\u0430: ".concat(e.forceY.value," H"),"\u0423\u0433\u043e\u043b: ".concat(e.forceY.angle,"\xb0")]}),this.viewFixationInfo(e),l.createElement("div",{className:n.btnGroup},l.createElement(rt.a,{"aria-label":"Delete",onClick:function(){return a(e)}},l.createElement(ot.a,null))))}},{key:"BeamInfo",value:function(e){var t=this.props,n=t.classes,a=t.onDelete;return l.createElement(ye.a,{className:n.root},l.createElement(Ne.a,{variant:"h6",className:n.title},"\u0421\u0442\u0435\u0440\u0436\u0435\u043d\u044c ",e.name),l.createElement(ut,{text:"\u0414\u043b\u0438\u043d\u0430: ".concat(e.length||lt.getBeamLength(e)," \u043c\u043c")}),e.withNewPosition&&l.createElement(dt,{text:["\u0421\u0438\u043b\u0430 \u0432 \u043d\u0430\u0447\u0430\u043b\u0435: ".concat(e.startForce," H"),"\u0421\u0438\u043b\u0430 \u0432 \u043a\u043e\u043d\u0446\u0435: ".concat(e.endForce," H")]}),l.createElement("div",{className:n.btnGroup},l.createElement(rt.a,{"aria-label":"Delete",onClick:function(){return a(e)}},l.createElement(ot.a,null))))}},{key:"viewInfo",value:function(e){return R(e)?this.NodeInfo(e):A(e)?this.BeamInfo(e):void 0}},{key:"render",value:function(){var e=this.props.entity;return l.createElement(Ue,{anchor:"right",title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u0435",btnIcon:l.createElement(it.a,null)},this.viewInfo(e),l.createElement(Se.a,null))}}]),t}(l.PureComponent),ft=Object(Ee.a)(function(e){return Object(ge.a)({root:{padding:e.spacing(2)},title:{marginBottom:e.spacing(2)},btnGroup:{marginTop:e.spacing(2)}})})(mt),ht=n(398),pt=n(455),bt=n(444),vt=n(445),gt=n(446),yt=Object(Ee.a)(function(e){return Object(ge.a)({root:{position:"absolute",padding:e.spacing(1),bottom:e.spacing(2),left:"50%",transform:"translateX(-50%)",backgroundColor:Object(_e.b)(e.palette.primary.light,.4),transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:e.palette.primary.light}},modsBtnGroup:{borderRadius:0,backgroundColor:"transparent"}})})(function(e){var t=e.onSelect,n=e.selected,a=e.classes,r=[{name:"\u041f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435",mod:s.move,icon:l.createElement(bt.a,null)},{name:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0437\u0435\u043b",mod:s.addNode,icon:l.createElement(vt.a,null)},{name:"\u0421\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0443\u0437\u043b\u044b",mod:s.addBeam,icon:l.createElement(gt.a,null)},{name:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",mod:s.delete,icon:l.createElement(ot.a,null)}];return l.createElement(ht.a,{className:a.root},l.createElement(pt.a,{value:n,exclusive:!0,onChange:function(e,n){return t(n)},size:"medium",className:a.modsBtnGroup},r.map(function(e){return l.createElement(Ge,{key:e.mod,value:e.mod,selected:e.mod===n,icon:e.icon,name:e.name})})))}),Et=n(206),kt=n(207),Ot=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(ae.a)(this,Object(re.a)(t).call(this,e))).stage=void 0,n.state={stageHeight:v.canvas.height,stageWidth:v.canvas.width,uiMode:s.none,selectedEntityID:"",paintEntity:void 0},n.UIonClick=n.UIonClick.bind(Object(fe.a)(n)),n.UIonDrag=n.UIonDrag.bind(Object(fe.a)(n)),n.UIonMouseMove=n.UIonMouseMove.bind(Object(fe.a)(n)),n.onKeyHandle=n.onKeyHandle.bind(Object(fe.a)(n)),n.selectEntity=n.selectEntity.bind(Object(fe.a)(n)),n.clearFarm=n.clearFarm.bind(Object(fe.a)(n)),n.deleteEntity=n.deleteEntity.bind(Object(fe.a)(n)),n.saveFarm=n.saveFarm.bind(Object(fe.a)(n)),n.calculateFarm=n.calculateFarm.bind(Object(fe.a)(n)),n.stage=l.createRef(),n}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=this.stage.current;if(e){var t=e.attrs.container.parentElement.parentElement;t&&(t.scrollTop=(t.scrollHeight-t.offsetHeight)/2,t.scrollLeft=(t.scrollWidth-t.offsetWidth)/2)}}},{key:"UIonClick",value:function(e,t){var n=this.state,a=n.uiMode,r=n.paintEntity,o=this.props.calculation,i=e.target.getStage()===e.target;if(e.evt.preventDefault(),0===e.evt.button&&!o){switch(a){case s.none:i?this.setState({selectedEntityID:""}):this.selectEntity(t);break;case s.addNode:if(i){var c=e.evt,l=c.layerX,u=c.layerY,d=X.cellX(l),m=X.cellX(u);this.props.addNode(d,m)}break;case s.addBeam:if(!i&&R(t)){var f=this.props.addBeam({x:t.x,y:t.y});if(A(f)){var h=this.props.connectBeamToNode(t,f,"start");A(h)?this.setState({paintEntity:h,uiMode:s.addBeamStart}):this.props.deleteEntity(f.id)}}break;case s.addBeamStart:!i&&R(t)&&A(r)&&this.props.connectBeamToNode(t,r,"end")&&this.setState({uiMode:s.addBeam,paintEntity:void 0});break;case s.delete:!i&&t&&this.deleteEntity(t)}i&&this.setState({selectedEntityID:""})}}},{key:"UIonMouseMove",value:function(e){if(!this.props.calculation){var t=this.state,n=t.uiMode,a=t.paintEntity,r=e.evt,o=r.layerX,i=r.layerY;switch(n){case s.addBeamStart:e.target.getStage()&&(a&&A(a)?this.props.moveBeam(a,o,i):this.setState({uiMode:s.addBeam}));break;case s.delete:var c=e.target.getStage();c===e.target&&(c.container().style.cursor="default")}}}},{key:"UIonDrag",value:function(e,t){if(!this.props.calculation)switch(this.state.uiMode){case s.move:if(R(t)&&e.evt.defaultPrevented){var n=e.evt,a=n.layerX,r=n.layerY;this.props.moveNode(t,X.cellX(a),X.cellY(r))}}}},{key:"onKeyHandle",value:function(e){switch(e.key){case"Escape":this.deletePaintEntity(),this.setState({uiMode:0})}}},{key:"deletePaintEntity",value:function(){this.state.paintEntity&&this.props.deleteEntity(this.state.paintEntity.id),this.setState({paintEntity:void 0})}},{key:"deleteEntity",value:function(e){this.props.calculation||(this.state.selectedEntityID&&this.state.selectedEntityID===e.id&&this.setState({selectedEntityID:""}),this.props.deleteEntity(e.id))}},{key:"selectEntity",value:function(e){this.props.calculation||e&&this.setState({selectedEntityID:e.id})}},{key:"clearFarm",value:function(){window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0445\u043e\u043b\u0441\u0442?")&&this.props.defautlFarm()}},{key:"saveFarm",value:function(e){window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0445\u043e\u043b\u0441\u0442 \u0432 \u043a\u044d\u0448?")&&this.props.saveFarm()}},{key:"calculateFarm",value:function(e){this.props.calculateFarm()}},{key:"setSelectedMode",value:function(e){this.props.calculation||(this.state.paintEntity&&this.props.deleteEntity(this.state.paintEntity.id),this.setState({uiMode:e||0,paintEntity:void 0}))}},{key:"render",value:function(){var e=this.state,t=e.stageHeight,n=e.stageWidth,a=e.uiMode,r=e.selectedEntityID,o=this.props,i=o.classes,c=o.nodes,s=o.beams,u=o.calculation,d=o.calculated,m=[].concat(Object(z.a)(c),Object(z.a)(s)).find(function(e){return e.id===r});return l.createElement(ye.a,{className:i.root},l.createElement(kt.a,{isActive:!0}),l.createElement(Et.a,{keyEventName:"keyup",keyValue:"Escape",onKeyHandle:this.onKeyHandle}),l.createElement(We,{hundleClear:this.clearFarm,hundleSave:this.saveFarm,hundleCalculate:this.calculateFarm,disabled:u}),l.createElement("div",{className:i.toolbar}),l.createElement(ye.a,{className:i.stageBox},l.createElement("div",{className:i.toolbar}),l.createElement(at,{nodes:c,beams:s,selectedEntity:m,onSelect:this.selectEntity}),l.createElement(xe,{onClick:this.UIonClick,onDrag:this.UIonDrag,onMouseMove:this.UIonMouseMove,stageHeight:t,stageWidth:n,nodes:c,beams:s,stage:this.stage,selectedEntity:m,uiMode:a,viewNewPos:d}),l.createElement(ft,{entity:m,onDelete:this.deleteEntity})),l.createElement(yt,{selected:a,onSelect:this.setSelectedMode.bind(this)}))}}]),t}(l.Component),wt=Object(Ee.a)(function(e){return Object(ge.a)({root:{width:"100%",height:"100%",overflow:"hidden",background:e.palette.background.default,display:"flex",flexDirection:"column"},stageBox:{display:"flex",flexGrow:1,overflow:"hidden"},toolbar:e.mixins.toolbar})})(Ot),xt=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"firstPlacement",value:function(e,t){return{nodes:e.map(function(e){var t=e.x+Math.round(v.canvas.width/3/v.UI.cellSize)*v.UI.MMinCell,n=e.y+Math.round(v.canvas.height/3/v.UI.cellSize)*v.UI.MMinCell;return Object(L.a)({},e,{x:t,y:n})}),beams:t.map(function(e){var t=e.x+Math.round(v.canvas.width/3/v.UI.cellSize)*v.UI.MMinCell,n=e.y+Math.round(v.canvas.height/3/v.UI.cellSize)*v.UI.MMinCell;return Object(L.a)({},e,{x:t,y:n})})}}},{key:"parse",value:function(e,t){var n=JSON.parse(e),a=JSON.parse(t);return{nodes:n=n.map(function(e){return Object(L.a)({},e,{newX:e.x,newY:e.y,withNewPosition:!1})}),beams:a=a.map(function(e){return Object(L.a)({},e,{withNewPosition:!1})})}}},{key:"createNodes",value:function(e,t,n){var a=0;return[].concat(e.map(function(e){return a++,K(Object(L.a)({},e,{isStatic:!0,name:a+""}))}),t.map(function(e){a++;var t=K(Object(L.a)({},e,{isStatic:!0,name:a+""}));return 0===e.angle?t.forceX=V({nodeID:t.id,value:e.value,angle:e.angle}):t.forceY=V({nodeID:t.id,value:e.value,angle:e.angle}),t}),n.map(function(e){return a++,K(Object(L.a)({},e,{name:a+""}))}))}}]),e}(),It=xt,jt=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(ae.a)(this,Object(re.a)(t).call(this,e))).addNode=function(e,t,a){var r=lt.addNode(n.state.nodes,Object(L.a)({},a,{x:e*v.UI.koefOnGrid,y:t*v.UI.koefOnGrid}));return r?(n.setState({nodes:[].concat(Object(z.a)(n.state.nodes),[r])}),r):null},n.addBeam=function(e){var t=lt.addBeam(n.state.beams,Object(L.a)({},e));return t?(n.setState({beams:[].concat(Object(z.a)(n.state.beams),[t])}),t):null},n.connectBeamToNode=function(e,t,a){var r=Object(L.a)({},e),o=Object(L.a)({},t);switch(a){case"start":return o.startConnectedNodeID=r.id,o.name=r.name+" - ",r.beamsID.push(o.id),lt.moveEntity(o,r.x,r.y),n.setState(function(e){return{nodes:e.nodes.map(function(e){return e.id===r.id?r:e}),beams:e.beams.map(function(e){return e.id===o.id?o:e})}}),o;case"end":return!n.state.beams.filter(function(e){return r&&r.beamsID.includes(e.id)}).find(function(e){return lt.findOldBeam(r,o,e)})&&(r.beamsID.push(o.id),o.endConnectedNodeID=r.id,o.name=o.name+r.name,lt.moveBeamEnd(o,r.x,r.y),n.setState(function(e){return{nodes:e.nodes.map(function(e){return e.id===r.id?r:e}),beams:e.beams.map(function(e){return e.id===o.id?o:e})}}),!0);default:return!1}},n.addForceToNode=function(e,t){var a=V(Object(L.a)({},t,{nodeID:e.id}));return 0===a.angle?e.forceX=a:e.forceY=a,n.setState(function(t){return{nodes:t.nodes.map(function(t){return e&&t.id===e.id?e:t})}}),a},n.moveNode=function(e,t,a){var r=t*v.UI.koefOnGrid,o=a*v.UI.koefOnGrid;if(e.isStatic)return!1;if(!n.state.nodes.find(function(e){return e.x===r&&e.y===o})){var i=Object(L.a)({},e);return lt.moveEntity(i,r,o),n.state.beams.filter(function(e){return i&&i.beamsID.includes(e.id)}).forEach(function(e){if(i){var t=Object(L.a)({},e);t.startConnectedNodeID===i.id?lt.moveEntity(t,r,o):e.endConnectedNodeID===i.id&&lt.moveBeamEnd(t,r,o),n.setState(function(e){return{beams:e.beams.map(function(e){return e.id===t.id?t:e})}})}}),n.setState(function(e){return{nodes:e.nodes.map(function(e){return e.id===i.id?i:e})}}),!0}return!1},n.moveBeam=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"end",o=t*v.UI.koefOnGrid,i=a*v.UI.koefOnGrid;return e=Object(L.a)({},e),"start"===r?lt.moveEntity(e,o,i):lt.moveBeamEnd(e,o,i),n.setState(function(t){return{beams:t.beams.map(function(t){return e&&t.id===e.id?e:t})}}),!0},n.deleteEntity=function(e){var t=Object(z.a)(n.state.nodes),a=Object(z.a)(n.state.beams),r=n.state.beams.find(function(t){return t.id===e})||n.state.nodes.find(function(t){return t.id===e});if(R(r)){if(r.isStatic)return!1;a.filter(function(e){return R(r)&&r.beamsID.includes(e.id)}).forEach(function(e){var n;R(r)&&((n=e.startConnectedNodeID===r.id?t.find(function(t){return t.id===e.endConnectedNodeID}):t.find(function(t){return t.id===e.startConnectedNodeID}))&&((n=Object(L.a)({},n)).beamsID=n.beamsID.filter(function(t){return t!==e.id}),t=t.map(function(e){return n&&e.id===n.id?n:e})),a=a.filter(function(t){return t.id!==e.id}))}),t=t.filter(function(e){return R(r)&&e.id!==r.id});var o=lt.update(t,a),i=o.nodes,c=o.beams;return n.setState({nodes:i,beams:c}),!0}return!!A(r)&&([r.startConnectedNodeID,r.endConnectedNodeID].forEach(function(e){if(e&&e.length>0){var n=t.find(function(t){return t.id===e});n&&A(r)&&((n=Object(L.a)({},n)).beamsID=n.beamsID.filter(function(e){return!!r&&e!==r.id}),t=t.map(function(e){return n&&e.id===n.id?n:e}))}}),a=a.filter(function(e){return A(r)&&e.id!==r.id}),n.setState({nodes:t,beams:a}),!0)},n.state={nodes:[],beams:[],calculation:!1,calculated:!1},n.defautlFarm=n.defautlFarm.bind(Object(fe.a)(n)),n.saveFarm=n.saveFarm.bind(Object(fe.a)(n)),n.calculateFarm=n.calculateFarm.bind(Object(fe.a)(n)),n}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("nodes"),t=localStorage.getItem("beams");if(e&&t){var n=It.parse(e,t),a=n.nodes,r=n.beams;this.setState({nodes:a,beams:r})}else this.defautlFarm()}},{key:"componentWillUpdate",value:function(e,t){this.state.calculated&&t.calculated&&this.setState({calculated:!1})}},{key:"calculateFarm",value:function(){var e=Object(me.a)(de.a.mark(function e(){var t,n,a,r,o;return de.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=lt.normalize(this.state.nodes,this.state.beams),n=t.nodes,a=t.beams,this.setState({nodes:n,beams:a,calculation:!0}),e.prev=2,e.next=5,lt.calculate(n,a);case 5:r=e.sent,o=lt.correctAfterCalc(n,a,r),this.setState({nodes:o.nodes,beams:o.beams,calculation:!1,calculated:!0}),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),e.t0.message?alert(e.t0.message):alert(e.t0),console.error(e.t0),this.setState({calculation:!1});case 15:case"end":return e.stop()}},e,this,[[2,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"defautlFarm",value:function(){var e={nodes:xt.createNodes([{x:0,y:1e3,fixation:y.XY},{x:3e3,y:1e3,fixation:y.Y}],[{x:1e3,y:1e3,angle:90,value:9e3}],[]),beams:[]};localStorage.removeItem("nodes"),localStorage.removeItem("beams");var t=e=It.firstPlacement(e.nodes,e.beams),n=t.nodes,a=t.beams;this.setState({nodes:n,beams:a})}},{key:"saveFarm",value:function(){var e=this.state,t=e.nodes,n=e.beams;localStorage.setItem("nodes",JSON.stringify(t)),localStorage.setItem("beams",JSON.stringify(n))}},{key:"render",value:function(){return l.createElement(wt,Object.assign({},this.state,this))}}]),t}(l.Component),Nt="/",St="/farm",Ct=n(399),Mt=Object(Ct.a)(function(e){return Object(ge.a)({root:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},logo:{width:"20%",height:"20%"},title:{padding:40},descripton:{padding:40},btn:{}})})(function(e){var t=e.classes;return l.createElement("header",{className:t.root},l.createElement("img",{src:v.img.bridgeIcon_2,alt:"logo",className:t.logo}),l.createElement(Ne.a,{variant:"h3",className:t.title},v.str.title),l.createElement(Ne.a,{variant:"subtitle1",align:"center",className:t.descripton},v.str.description),l.createElement(Ie.a,{component:te.b,to:St,variant:"contained",size:"large",color:"secondary"},"\u041f\u043e\u0435\u0445\u0430\u043b\u0438"))}),Dt=function(e){function t(){return Object(p.a)(this,t),Object(ae.a)(this,Object(re.a)(t).apply(this,arguments))}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.classes;return l.createElement("div",{className:e.root},l.createElement(Mt,null))}}]),t}(l.Component),Bt=Object(Ee.a)(function(e){return Object(ge.a)({root:{width:"100%",minHeight:"100%",display:"block",background:e.palette.background.default,padding:e.spacing(4)}})})(Dt),Ut=Object(f.b)(function(e){return{title:e.home.title}},function(e){return Object(Y.b)(Object(L.a)({},i),e)})(Bt),Ft=function(e){function t(){return Object(p.a)(this,t),Object(ae.a)(this,Object(re.a)(t).apply(this,arguments))}return Object(oe.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return l.createElement(l.Fragment,null,l.createElement(ce.a,{htmlAttributes:{leng:"en"},titleTemplate:"Truss - %s",defaultTitle:v.str.title,link:[{rel:"shortcut icon",href:v.img.bridgeIcon_2},{rel:"image_src",href:v.img.airBridge},{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500"},{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}],meta:[{charSet:"utf-8"},{name:"viewport",content:"minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no"},{name:"theme-color",content:"#000000"},{name:"description",content:v.str.description},{property:"og:type",content:"website"},{property:"og:title",content:v.str.title},{property:"og:image",content:v.img.airBridge},{property:"vk:image",content:v.img.airBridge},{property:"twitter:image",content:v.img.airBridge},{property:"og:url",content:v.str.url}]}),l.createElement(se.a,null),l.createElement(le.a,{theme:E},l.createElement(ne.c,null,l.createElement(ne.a,{path:Nt,component:Ut,exact:!0}),l.createElement(ne.a,{path:St,component:jt}))))}}]),t}(l.Component);n(396);m.a.render(u.a.createElement(f.a,{store:ee},u.a.createElement(function(){return u.a.createElement(te.a,null,u.a.createElement(Ft,null))},null)),document.getElementById("root"))}},[[215,1,2]]]);
//# sourceMappingURL=main.699c037a.chunk.js.map