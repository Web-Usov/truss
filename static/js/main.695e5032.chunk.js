(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{128:function(e,t,n){e.exports=n(212)},211:function(e,t,n){},212:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"defaultState",function(){return y}),n.d(a,"reducer",function(){return E});var r={};n.r(r),n.d(r,"setTitle",function(){return tt});var i,o=n(0),c=n.n(o),s=n(17),l=n.n(s),d=n(78),u=n(33),m=(Object(u.a)(),n(22)),f=n(16),h=n(37),p=function(){function e(){Object(m.a)(this,e)}return Object(f.a)(e,null,[{key:"angleBePoints",value:function(e,t,n,a){return Math.atan2(-t+a,-e+n)/Math.PI}},{key:"lengthBePoints",value:function(e,t,n,a){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-a,2))}},{key:"cellX",value:function(e){return Math.round(e/h.UI_cellSize)*h.UI_cellSize}},{key:"cellY",value:function(e){return Math.round(e/h.UI_cellSize)*h.UI_cellSize}}]),e}(),b=n(48),g=n(38),v=n(13),y={nodes:[],beams:[],forces:[]},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NODE":var n=t.node;return Object(v.a)({},e,{nodes:[].concat(Object(g.a)(e.nodes),[n])});case"ADD_BEAM":var a=t.beam;return Object(v.a)({},e,{beams:[].concat(Object(g.a)(e.beams),[a])});case"ADD_FORCE":var r=t.force;return Object(v.a)({},e,{forces:[].concat(Object(g.a)(e.forces),[r])});case"EDIT_NODE":return Object(v.a)({},e,{nodes:e.nodes.map(function(e){return e.id===t.node.id?Object(v.a)({},e,t.node):e})});case"EDIT_BEAM":return Object(v.a)({},e,{beams:e.beams.map(function(e){return e.id===t.beam.id?Object(v.a)({},e,t.beam):e})});case"DELETE_ENTITY":return{beams:e.beams.filter(function(e){return e.id!==t.id}),nodes:e.nodes.filter(function(e){return e.id!==t.id}),forces:e.forces.filter(function(e){return e.id!==t.id})};default:return e}},k=n(44),O=n.n(k),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.x,n=e.y,a=e.name,r=e.angle,i=e.id,o=e.newX,c=e.newY,s=e.type;return{id:i||O()(),x:t||0,y:n||0,angle:r||0,name:a||"",newX:o||t||0,newY:c||n||0,type:s||"entity"}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.angle,n=e.nodeID,a=e.value,r=S(e);return Object(v.a)({},r,{type:"force",angle:t||0,nodeID:n||"",value:a||0})},w=function(e){return e&&"force"===e.type},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.length,n=e.startConnectedNodeID,a=e.endConnectedNodeID,r=e.endX,i=e.endY,o=S(e);return Object(v.a)({},o,{type:"beam",length:t||0,startConnectedNodeID:n,endConnectedNodeID:a,endX:r||o.x||0,endY:i||o.y||0})},C=function(e){return e&&"beam"===e.type},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.beamsID,n=e.forceX,a=e.forceY,r=e.isStatic,i=e.isFixed,o=S(e);return Object(v.a)({},o,{type:"node",beamsID:t||[],forceX:n,forceY:a,isStatic:r||!1,isFixed:i||!1})},D=function(e){return e&&"node"===e.type},M={title:"Hello, world!"},N=n(113),B=Object(b.c)({farm:a.reducer,home:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TITLE":return Object(v.a)({},e,{title:t.title});default:return e}}}),_=Object(b.d)(B,Object(b.a)(N.a)),z=n(53),F=n(50),T=n(25),L=n(24),U=n(26),W=n(12),X=n(114),Y=n(265),H=n(260),P=n(5),A=n(29),R=n(213),G=n(266),K=n(241),V=n(242),J=n(243),$=n(244),q=n(15),Q=n(262),Z=n(79),ee=n(235),te=n(263),ne=n(236),ae=n(237),re=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(T.a)(this,Object(L.a)(t).call(this,e))).state={open:!1,viewTooltip:!1},n.switchDrawer=n.switchDrawer.bind(Object(W.a)(n)),n}return Object(U.a)(t,e),Object(f.a)(t,[{key:"switchDrawer",value:function(){this.setState({open:!this.state.open,viewTooltip:!1})}},{key:"changeViewtooltip",value:function(e){this.setState({viewTooltip:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.children,r=t.title,i=t.btnIcon,c=t.anchor,s=this.state,l=s.open,d=s.viewTooltip;return o.createElement(o.Fragment,null,o.createElement(Q.a,{className:n.drawer,variant:"persistent",open:l,anchor:c,classes:{paper:n.drawerPaper}},o.createElement("div",{className:n.toolbar}),o.createElement(Z.a,{variant:"body2",align:"center",className:n.title},r),o.createElement(ee.a,null),a),o.createElement(te.a,{title:r,open:void 0!==r&&d&&!l,onOpen:function(){return e.changeViewtooltip(!0)},onClose:function(){return e.changeViewtooltip(!1)}},o.createElement(ne.a,{style:{left:"left"===c?l?255:15:"auto",right:"right"===c?l?255:15:"auto"},color:"secondary",size:"medium",className:n.toogleIcon,onClick:this.switchDrawer},l?o.createElement(ae.a,null):i)))}}]),t}(o.PureComponent),ie=Object(P.a)(function(e){return Object(Y.a)({drawer:{position:"relative"},drawerPaper:{width:240},toogleIcon:{position:"absolute",top:e.spacing(10),zIndex:e.zIndex.drawer+1},title:{padding:e.spacing(1)},toolbar:e.mixins.toolbar})})(re),oe=n(4),ce=n(238),se=n(239),le=Object(P.a)(function(e){return Object(Y.a)({appBar:{zIndex:e.zIndex.drawer+1},logo:{marginRight:e.spacing(4),marginLeft:e.spacing(2),"& img":{width:50,height:"auto"}}})})(function(e){var t=e.classes,n=e.children,a=e.className,r=e.color,i=e.position,c=e.withLogo,s=void 0===c||c;return o.createElement(ce.a,{position:i||"fixed",className:Object(oe.a)(t.appBar,a),color:r||"primary"},o.createElement(se.a,null,function(){if(s)return o.createElement(z.b,{to:"/",className:t.logo},o.createElement("img",{alt:"Logo Icon",src:h.bridgeIcon_2}))}(),n))}),de=n(70),ue=n(117),me=n(240),fe=Object(P.a)(function(e){return Object(Y.a)({btn:{marginLeft:e.spacing(2),marginRight:e.spacing(2),borderRadius:"50% !important",border:"1px solid ".concat(Object(q.b)(e.palette.action.active,.2)," !important"),transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.light,"&$selected":{backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark}},"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main},"&$disabled":{backgroundColor:e.palette.secondary.main}}},selected:{}})})(function(e){var t=e.selected,n=e.classes,a=e.value,r=e.name,i=e.icon,c=Object(ue.a)(e,["selected","classes","value","name","icon"]);return o.createElement(me.a,Object.assign({key:r,value:a,className:Object(oe.a)(n.btn,Object(de.a)({},n.selected,t))},c),o.createElement(te.a,{title:r},i))});!function(e){e[e.none=0]="none",e[e.move=1]="move",e[e.addNode=2]="addNode",e[e.addBeam=3]="addBeam",e[e.addBeamStart=4]="addBeamStart",e[e.delete=5]="delete"}(i||(i={}));var he=Object(P.a)(function(e){return Object(Y.a)({root:{position:"absolute",padding:e.spacing(1),bottom:e.spacing(2),left:"50%",transform:"translateX(-50%)",backgroundColor:Object(q.b)(e.palette.primary.light,.4),transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:e.palette.primary.light}},modsBtnGroup:{borderRadius:0,backgroundColor:"transparent"}})})(function(e){var t=e.onSelect,n=e.selected,a=e.classes,r=[{name:"\u041f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435",mod:i.move,icon:o.createElement(K.a,null)},{name:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0437\u0435\u043b",mod:i.addNode,icon:o.createElement(V.a,null)},{name:"\u0421\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0443\u0437\u043b\u044b",mod:i.addBeam,icon:o.createElement(J.a,null)},{name:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",mod:i.delete,icon:o.createElement($.a,null)}];return o.createElement(R.a,{className:a.root},o.createElement(G.a,{value:n,exclusive:!0,onChange:function(e,n){return t(n)},size:"medium",className:a.modsBtnGroup},r.map(function(e){return o.createElement(fe,{key:e.mod,value:e.mod,selected:e.mod===n,icon:e.icon,name:e.name})})))}),pe=n(121),be=Object(pe.a)({palette:{primary:{dark:"#0A4467",main:"#1e779e",light:"#51A8D6"},secondary:{dark:"#a83e19",main:"#f15a24",light:"#F39B7C"},background:{default:"linear-gradient(35deg, #6863bf 0%, #067d93 50%, #e68a68 100%)"}}}),ge=h.UI_nodeSize,ve=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(T.a)(this,Object(L.a)(t).call(this,e))).hundleMouseEnter=n.hundleMouseEnter.bind(Object(W.a)(n)),n.hundleMouseLeave=n.hundleMouseLeave.bind(Object(W.a)(n)),n.getStorkeColor=n.getStorkeColor.bind(Object(W.a)(n)),n.getStorkeWidth=n.getStorkeWidth.bind(Object(W.a)(n)),n.getFillColor=n.getFillColor.bind(Object(W.a)(n)),n.viewForce=n.viewForce.bind(Object(W.a)(n)),n}return Object(U.a)(t,e),Object(f.a)(t,[{key:"hundleMouseEnter",value:function(e,t){var n=e.target.getStage(),a=this.props.node;switch(t){case i.delete:if(a.isStatic){n.container().style.cursor="default";break}n.container().style.cursor="pointer";break;case i.none:n.container().style.cursor="pointer";break;case i.addBeam:case i.addBeamStart:n.container().style.cursor="crosshair";break;case i.move:if(a.isStatic){n.container().style.cursor="default";break}n.container().style.cursor="move"}}},{key:"hundleMouseLeave",value:function(e){var t=e.target.getStage();t&&(t.container().style.cursor="default")}},{key:"getStorkeColor",value:function(){var e=this.props,t=e.mode,n=e.node;switch(t){case i.move:return n.isStatic?be.palette.secondary.dark:be.palette.primary.light;case i.addBeam:case i.addBeamStart:return be.palette.primary.light;default:return be.palette.secondary.main}}},{key:"getStorkeWidth",value:function(){var e=this.props.mode,t=this.props.node;switch(e){case i.move:return t.isStatic?0:2;case i.addBeam:case i.addBeamStart:return 2;default:return 0}}},{key:"getFillColor",value:function(){var e=this.props.node;return e.isStatic?e.isFixed?be.palette.secondary.dark:be.palette.secondary.light:be.palette.secondary.main}},{key:"viewForce",value:function(e){return o.createElement(o.Fragment,null,o.createElement(A.Arrow,{points:[0,0,h.UI_cellSize,0],stroke:be.palette.grey[300],strokeWidth:ge/3,shadowBlur:2,pointerLength:h.UI_cellSize/10,pointerWidth:h.UI_cellSize/10,hitStrokeWidth:2*ge,rotation:e.value>0?e.angle:180+e.angle}),o.createElement(A.Text,{x:0===e.angle?e.value>0?h.UI_cellSize/3:-h.UI_cellSize:h.UI_cellSize/3,y:90===e.angle?e.value>0?h.UI_cellSize/3:-h.UI_cellSize/2:-h.UI_cellSize/1.5,text:e.value+"H"}))}},{key:"viewFixation",value:function(e){this.props.node;return o.createElement(A.Group,{x:0,y:0,rotation:e},o.createElement(A.Line,{points:[0,0,0,h.UI_cellSize,-h.UI_cellSize/2,h.UI_cellSize,h.UI_cellSize/2,h.UI_cellSize],stroke:be.palette.grey[300],strokeWidth:ge/4,shadowBlur:2}),o.createElement(A.Circle,{radius:ge/2,fill:be.palette.grey[500],x:0,y:h.UI_cellSize-ge/1.7}))}},{key:"shouldComponentUpdate",value:function(e){return e.node!==this.props.node||e.mode!==this.props.mode||e.selected!==this.props.selected}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClick,a=t.mode,r=t.selected,c=t.node;return o.createElement(A.Group,{x:c.x,y:c.y,_useStrictMode:!0,onClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return n(e,c)})},c.forceX&&this.viewForce(c.forceX),c.forceY&&this.viewForce(c.forceY),"x"===c.isFixed&&this.viewFixation(90),"y"===c.isFixed&&this.viewFixation(0),"xy"===c.isFixed&&this.viewFixation(90),"xy"===c.isFixed&&this.viewFixation(0),o.createElement(A.Circle,{radius:ge,x:0,y:0,fill:this.getFillColor(),shadowBlur:r?8:2,stroke:this.getStorkeColor(),strokeWidth:this.getStorkeWidth(),hitStrokeWidth:2*ge}),o.createElement(A.Circle,{radius:ge,x:c.x-c.x,y:c.y-c.y,onDragEnd:function(e){e.target.to({x:0,y:0})},hitStrokeWidth:2*ge,draggable:a===i.move&&!c.isStatic,onMouseEnter:function(t){return e.hundleMouseEnter(t,a)},onMouseLeave:function(t){return e.hundleMouseLeave(t)},onDragMove:function(t){return e.props.drag(t,c)}}))}}]),t}(o.Component),ye=n(84),Ee=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(T.a)(this,Object(L.a)(t).call(this,e))).hundleMouseEnter=n.hundleMouseEnter.bind(Object(W.a)(n)),n.hundleMouseLeave=n.hundleMouseLeave.bind(Object(W.a)(n)),n}return Object(U.a)(t,e),Object(f.a)(t,[{key:"hundleMouseEnter",value:function(e,t){var n=e.target.getStage();switch(t){case i.delete:case i.none:n.container().style.cursor="pointer"}}},{key:"hundleMouseLeave",value:function(e){var t=e.target.getStage();t&&(t.container().style.cursor="default")}},{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.beam,a=t.mode,r=t.selected;return e.beam!==n||e.mode!==a||e.selected!==r}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClick,a=t.mode,r=t.selected,i=t.beam,c=h.UI_beamSize;return o.createElement(ye.Line,{points:[i.x,i.y,i.endX,i.endY],stroke:be.palette.secondary.light,strokeWidth:c,shadowBlur:r?8:2,hitStrokeWidth:4*c,onClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return n(e,i)}),onMouseEnter:function(t){return e.hundleMouseEnter(t,a)},onMouseLeave:function(t){return e.hundleMouseLeave(t)}})}}]),t}(o.Component),ke=function(e){var t=e.widthCell,n=e.heightCell,a=e.heightBox,r=e.widthBox,i=r/t,c=a/n;return o.createElement(o.Fragment,null,function(){for(var e=[],n=0;n<i;n++)e.push(o.createElement(A.Line,{points:[n*t,0,n*t,a],stroke:"#ddd",strokeWidth:1,key:n}));return e}(),function(){for(var e=[],t=0;t<c;t++)e.push(o.createElement(A.Line,{points:[0,t*n,r,t*n],stroke:"#ddd",strokeWidth:1,key:t}));return e}())},Oe=n(118),Se=n.n(Oe),je=Object(P.a)(function(e){return Object(Y.a)({root:{flexGrow:1,backgroundColor:"#fff"},stage:{backgroundColor:"#fff"}})})(function(e){var t=e.classes,n=e.stage,a=e.stageHeight,r=e.stageWidth,i=e.onClick,c=e.onMouseMove,s=e.onDrag,l=(e.forces,e.beams),d=e.nodes,u=e.uiMode,m=e.selectedEntity;return o.createElement(Se.a,{className:t.root,autoHide:!0},o.createElement(A.Stage,{height:a,width:r,style:{height:a,width:r},className:t.stage,onClick:i,onMouseMove:c,ref:n},o.createElement(A.Layer,{className:"layer"},o.createElement(ke,{heightCell:h.UI_cellSize,widthCell:h.UI_cellSize,heightBox:a,widthBox:r}),l.map(function(e){return o.createElement(Ee,{key:e.id,beam:e,mode:u,onClick:i,selected:m===e})}),d.map(function(e){return o.createElement(ve,{key:e.id,node:e,mode:u,drag:s,onClick:i,selected:m===e})}))))}),we=n(245),Ie=Object(P.a)(function(e){return Object(Y.a)({root:{},btn:{marginLeft:e.spacing(2),marginRight:e.spacing(2)},grow:{flexGrow:1}})})(function(e){var t=e.classes,n=e.hundleSave,a=void 0===n?function(e){alert("\u0411\u0443\u0435\u0434\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c")}:n,r=e.hundleClear,i=void 0===r?function(e){alert("\u0411\u0443\u0435\u0434\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c")}:r;return o.createElement(le,{className:t.root},o.createElement("div",{className:t.grow}),o.createElement(we.a,{color:"secondary",variant:"contained",className:t.btn,onClick:a},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),o.createElement(we.a,{color:"secondary",variant:"contained",className:t.btn,onClick:i},"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))}),Ce=n(246),xe=n(247),De=n(248),Me=n(249),Ne=n(252),Be=n(253),_e=n(250),ze=n(251),Fe=n(254),Te=n(255),Le=n(256),Ue=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(T.a)(this,Object(L.a)(t).call(this,e))).state={open:!1,tabs:new Map},n.openTab=n.openTab.bind(Object(W.a)(n)),n.viewListItem=n.viewListItem.bind(Object(W.a)(n)),n}return Object(U.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){var e=this.state.tabs;e.set("\u0423\u0437\u043b\u044b",!1),e.set("\u0421\u0442\u0435\u0440\u0436\u043d\u0438",!1),this.setState({tabs:new Map(e)})}},{key:"openTab",value:function(e){var t=this.state.tabs;t.set(e,!t.get(e)),this.setState({tabs:new Map(t)})}},{key:"viewListItem",value:function(e,t,n){var a=this,r=this.props,i=r.selectedEntity,c=r.classes,s=r.onSelect,l=this.state.tabs;return o.createElement(o.Fragment,null,o.createElement(Ce.a,{button:!0,onClick:function(){return a.openTab(t)}},n&&o.createElement(xe.a,null,o.createElement(De.a,{badgeContent:e.length,color:"secondary"},n)),o.createElement(Me.a,{primary:t}),l.get(t)?o.createElement(_e.a,null):o.createElement(ze.a,null)),o.createElement(Ne.a,{in:l.get(t),timeout:"auto",unmountOnExit:!0},o.createElement(Be.a,{component:"div",disablePadding:!0},e.map(function(e){return o.createElement(Ce.a,{button:!0,className:c.nested,key:e.id,selected:i===e,onClick:function(t){return s(e)}},o.createElement(Me.a,{primary:e.id}))}))),o.createElement(ee.a,null))}},{key:"render",value:function(){var e=this.props,t=e.nodes,n=e.beams;return o.createElement(ie,{anchor:"left",title:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430",btnIcon:o.createElement(Fe.a,null)},this.viewListItem(t,"\u0423\u0437\u043b\u044b",o.createElement(Te.a,null)),this.viewListItem(n,"\u0421\u0442\u0435\u0440\u0436\u043d\u0438",o.createElement(Le.a,null)))}}]),t}(o.PureComponent),We=Object(P.a)(function(e){return Object(Y.a)({nested:{paddingLeft:e.spacing(6)}})})(Ue),Xe=n(257),Ye=n(258),He=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(T.a)(this,Object(L.a)(t).call(this,e))).state={},n}return Object(U.a)(t,e),Object(f.a)(t,[{key:"getTypeStr",value:function(e){return D(e)?"\u0423\u0437\u0435\u043b":C(e)?"\u0421\u0442\u0435\u0440\u0436\u0435\u043d\u044c":"\u042d\u043b\u0435\u043c\u0435\u043d\u0442"}},{key:"viewInfo",value:function(e){var t=this.props,n=t.classes,a=t.onDelete;if(e)return o.createElement(H.a,{className:n.root},o.createElement(Z.a,{className:n.subTitle,color:"textSecondary",gutterBottom:!0},this.getTypeStr(e)),o.createElement(Z.a,{variant:"h5",className:n.title},e.name),o.createElement(Xe.a,{"aria-label":"Delete",onClick:function(){return a(e)}},o.createElement($.a,null)))}},{key:"render",value:function(){var e=this.props.entity;return o.createElement(ie,{anchor:"right",title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u0435",btnIcon:o.createElement(Ye.a,null)},this.viewInfo(e),o.createElement(ee.a,null))}}]),t}(o.PureComponent),Pe=Object(P.a)(function(e){return Object(Y.a)({root:{padding:e.spacing(2)},subTitle:{fontSize:14},title:{marginBottom:e.spacing(2)}})})(He),Ae=n(119),Re=n.n(Ae),Ge=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(T.a)(this,Object(L.a)(t).call(this,e))).stage=void 0,n.state={stageHeight:3e3,stageWidth:3e3,uiMode:i.none,selectedEntity:void 0,paintEntity:void 0},n.onClick=n.onClick.bind(Object(W.a)(n)),n.onDrag=n.onDrag.bind(Object(W.a)(n)),n.onMouseMove=n.onMouseMove.bind(Object(W.a)(n)),n.onKeyHandle=n.onKeyHandle.bind(Object(W.a)(n)),n._setStageSize=n._setStageSize.bind(Object(W.a)(n)),n.selectEntity=n.selectEntity.bind(Object(W.a)(n)),n.clearFarm=n.clearFarm.bind(Object(W.a)(n)),n.deleteEntity=n.deleteEntity.bind(Object(W.a)(n)),n.stage=o.createRef(),n}return Object(U.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){this._setStageSize()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this._setStageSize);var e=this.stage.current;if(e){var t=e.attrs.container.parentElement;t&&(t.scrollTop=(t.scrollHeight-t.offsetHeight)/2,t.scrollLeft=(t.scrollWidth-t.offsetWidth)/2)}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._setStageSize)}},{key:"onClick",value:function(e,t){var n=this.state,a=n.uiMode,r=n.paintEntity,o=e.target.getStage()===e.target;if(e.evt.preventDefault(),0===e.evt.button)switch(a){case i.none:o?this.setState({selectedEntity:void 0}):this.selectEntity(t);break;case i.addNode:if(o){var c=e.evt,s=c.layerX,l=c.layerY,d=p.cellX(s),u=p.cellX(l);this.props.addNode(d,u)}break;case i.addBeam:if(!o&&D(t)){var m=this.props.addBeam({x:t.x,y:t.y});if(C(m)){var f=this.props.connectBeamToNode(t,m,"start");console.log("PAM",f),C(f)?this.setState({paintEntity:f,uiMode:i.addBeamStart}):this.props.deleteEntity(m.id)}}break;case i.addBeamStart:!o&&D(t)&&C(r)&&this.props.connectBeamToNode(t,r,"end")&&this.setState({uiMode:i.addBeam,paintEntity:void 0});break;case i.delete:!o&&t&&this.deleteEntity(t)}o&&this.setState({selectedEntity:void 0})}},{key:"onMouseMove",value:function(e){var t=this.state,n=t.uiMode,a=t.paintEntity,r=e.evt,o=r.layerX,c=r.layerY;switch(n){case i.addBeamStart:e.target.getStage()&&(a&&C(a)?this.props.moveBeam(a,o,c):this.setState({uiMode:i.addBeam}));break;case i.delete:var s=e.target.getStage();s===e.target&&(s.container().style.cursor="default")}}},{key:"onDrag",value:function(e,t){switch(this.state.uiMode){case i.move:if(D(t)&&e.evt.defaultPrevented){var n=e.evt,a=n.layerX,r=n.layerY;this.props.moveNode(t,p.cellX(a),p.cellY(r))}}}},{key:"onKeyHandle",value:function(e){switch(e.key){case"Escape":this.deletePaintEntity()}}},{key:"setSelectedMode",value:function(e){this.state.paintEntity&&this.props.deleteEntity(this.state.paintEntity.id),this.setState({uiMode:e||0,paintEntity:void 0})}},{key:"_setStageSize",value:function(e){this.setState({stageHeight:1.5*window.innerHeight,stageWidth:1.5*window.innerWidth})}},{key:"selectEntity",value:function(e){e&&this.setState({selectedEntity:e})}},{key:"clearFarm",value:function(){window.confirm("\u0412\u044b\u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0445\u043e\u043b\u0441\u0442?")&&this.props.defautlFarm()}},{key:"deletePaintEntity",value:function(){this.state.paintEntity&&this.props.deleteEntity(this.state.paintEntity.id),this.setState({paintEntity:void 0})}},{key:"deleteEntity",value:function(e){this.state.selectedEntity&&this.state.selectedEntity.id===e.id&&this.setState({selectedEntity:void 0}),this.props.deleteEntity(e.id)}},{key:"render",value:function(){var e=this.state,t=e.stageHeight,n=e.stageWidth,a=e.uiMode,r=e.selectedEntity,i=this.props,c=i.classes,s=i.nodes,l=i.beams,d=i.forces;return o.createElement(H.a,{className:c.root},o.createElement(Re.a.FPSStats,{isActive:!0}),o.createElement(X.a,{keyEventName:"keyup",keyValue:"Escape",onKeyHandle:this.onKeyHandle}),o.createElement(Ie,{hundleClear:this.clearFarm}),o.createElement("div",{className:c.toolbar}),o.createElement(H.a,{className:c.stageBox},o.createElement("div",{className:c.toolbar}),o.createElement(We,{nodes:s,beams:l,selectedEntity:r,onSelect:this.selectEntity}),o.createElement(je,{onClick:this.onClick,onDrag:this.onDrag,onMouseMove:this.onMouseMove,stageHeight:t,stageWidth:n,nodes:s,beams:l,forces:d,stage:this.stage,selectedEntity:r,uiMode:a}),o.createElement(Pe,{entity:r,onDelete:this.deleteEntity})),o.createElement(he,{selected:a,onSelect:this.setSelectedMode.bind(this)}))}}]),t}(o.Component),Ke=Object(P.a)(function(e){return Object(Y.a)({root:{width:"100%",height:"100%",overflow:"hidden",background:e.palette.background.default,display:"flex",flexDirection:"column"},stageBox:{display:"flex",flexGrow:1,overflow:"hidden"},toolbar:e.mixins.toolbar})})(Ge),Ve=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(T.a)(this,Object(L.a)(t).call(this,e))).addNode=function(e,t,a){if(n.state.nodes.find(function(n){return n.x===e&&n.y===t}))return!1;var r=O()();if(!r)return!1;var i=x(Object(v.a)({},a,{id:r,x:e,y:t}));return n.setState({nodes:[].concat(Object(g.a)(n.state.nodes),[i])}),i},n.addBeam=function(e){var t=O()();if(!t)return!1;var a=I(Object(v.a)({},e,{id:t}));return n.setState({beams:[].concat(Object(g.a)(n.state.beams),[a])}),a},n.addForce=function(e){var t=O()();if(!t)return!1;var a=j(Object(v.a)({},e,{id:t}));return n.setState({forces:[].concat(Object(g.a)(n.state.forces),[a])}),a},n.connectBeamToNode=function(e,t,a){var r=x(e),i=I(t);switch(a){case"start":var o;return i.startConnectedNodeID=r.id,r.beamsID.push(i.id),i.x=r.x,i.y=r.y,n.setState(function(e){return{nodes:e.nodes.map(function(e){return e.id===r.id?r:e}),beams:e.beams.map(function(e){return e.id===i.id?i:e})}}),(o=console).log.apply(o,Object(g.a)(n.state.beams)),i;case"end":return!n.state.beams.filter(function(e){return r&&r.beamsID.includes(e.id)}).find(function(e){return r&&i&&(e.startConnectedNodeID===i.startConnectedNodeID&&e.endConnectedNodeID===r.id||e.startConnectedNodeID===r.id&&e.endConnectedNodeID===i.startConnectedNodeID||e.id===i.id&&e.startConnectedNodeID===r.id)})&&(r.beamsID.push(i.id),i.endConnectedNodeID=r.id,i.endX=r.x,i.endY=r.y,n.setState(function(e){return{nodes:e.nodes.map(function(e){return e.id===r.id?r:e}),beams:e.beams.map(function(e){return e.id===i.id?i:e})}}),!0);default:return!1}},n.addForceToNode=function(e,t){var a=j(Object(v.a)({},t,{nodeID:e.id}));return 0===a.angle?e.forceX=a:e.forceY=a,n.setState(function(t){return{nodes:t.nodes.map(function(t){return e&&t.id===e.id?e:t}),forces:[].concat(Object(g.a)(t.forces),[a])}}),a},n.moveNode=function(e,t,a){if(e.isStatic)return!1;if(!n.state.nodes.find(function(e){return e.x===t&&e.y===a})){var r=x(Object(v.a)({},e,{x:t,y:a}));return n.state.beams.filter(function(e){return r&&r.beamsID.includes(e.id)}).forEach(function(e){if(r){var i=I(e);i.startConnectedNodeID===r.id?(i.x=t,i.y=a):e.endConnectedNodeID===r.id&&(i.endX=t,i.endY=a),n.setState(function(e){return{beams:e.beams.map(function(e){return e.id===i.id?i:e})}})}}),n.setState(function(e){return{nodes:e.nodes.map(function(e){return e.id===r.id?r:e})}}),!0}return!1},n.moveBeam=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"end";return e=I(e),"start"===r?(e.x=t,e.y=a):(e.endX=t,e.endY=a),n.setState(function(t){return{beams:t.beams.map(function(t){return e&&t.id===e.id?e:t})}}),!0},n.deleteEntity=function(e){var t=n.state.beams.find(function(t){return t.id===e})||n.state.nodes.find(function(t){return t.id===e})||n.state.forces.find(function(t){return t.id===e});return D(t)?!t.isStatic&&(n.state.beams.filter(function(e){return D(t)&&t.beamsID.includes(e.id)}).forEach(function(e){var a;t instanceof Node&&((a=e.startConnectedNodeID===t.id?n.state.nodes.find(function(t){return t.id===e.endConnectedNodeID}):n.state.nodes.find(function(t){return t.id===e.startConnectedNodeID}))&&((a=x(a)).beamsID=a.beamsID.filter(function(t){return t!==e.id}),n.setState(function(e){return{nodes:e.nodes.map(function(e){return a&&e.id===a.id?a:e})}})),n.setState(function(t){return{beams:t.beams.filter(function(t){return t.id!==e.id})}}))}),t.forceX&&n.setState(function(e){return{forces:e.forces.filter(function(e){return D(t)&&w(t.forceX)&&e.id!==t.forceX.id})}}),t.forceY&&n.setState(function(e){return{forces:e.forces.filter(function(e){return D(t)&&w(t.forceY)&&e.id!==t.forceY.id})}}),n.setState(function(e){return{nodes:e.nodes.filter(function(e){return D(t)&&e.id!==t.id})}}),!0):!(!t||!C(t))&&([t.startConnectedNodeID,t.endConnectedNodeID].forEach(function(e){if(e&&e.length>0){var a=n.state.nodes.find(function(t){return t.id===e});a&&C(t)&&((a=x(a)).beamsID=a.beamsID.filter(function(e){return!!t&&e!==t.id}),n.setState(function(e){return{nodes:e.nodes.map(function(e){return a&&e.id===a.id?a:e})}}))}}),n.setState(function(e){return{beams:e.beams.filter(function(e){return C(t)&&e.id!==t.id})}}),!0)},n.state={nodes:[],beams:[],forces:[]},n.defautlFarm=n.defautlFarm.bind(Object(W.a)(n)),n}return Object(U.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.defautlFarm()}},{key:"defautlFarm",value:function(){var e=function(){var e,t=[],n=[],a=x({x:1e3,y:560,isStatic:!0,isFixed:"xy"});return t.push(a),a=x({x:1200,y:640,isStatic:!0}),e=j({nodeID:a.id,value:100}),a.forceX=e,t.push(a),n.push(e),{n:t,b:[],f:n}}(),t=e.n,n=e.b,a=e.f;this.setState({nodes:t,beams:n,forces:a})}},{key:"render",value:function(){return o.createElement(Ke,Object.assign({},this.state,this))}}]),t}(o.Component),Je="/",$e="/farm",qe=n(214),Qe=Object(qe.a)(function(e){return Object(Y.a)({root:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},logo:{width:"20%",height:"20%"},title:{padding:40},descripton:{padding:40},btn:{}})})(function(e){var t=e.classes;return o.createElement("header",{className:t.root},o.createElement("img",{src:h.bridgeIcon_2,alt:"logo",className:t.logo}),o.createElement(Z.a,{variant:"h3",className:t.title},h.title),o.createElement(Z.a,{variant:"subtitle1",align:"center",className:t.descripton},h.description),o.createElement(we.a,{component:z.b,to:$e,variant:"contained",size:"large",color:"secondary"},"\u041f\u043e\u0435\u0445\u0430\u043b\u0438"))}),Ze=function(e){function t(){return Object(m.a)(this,t),Object(T.a)(this,Object(L.a)(t).apply(this,arguments))}return Object(U.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.classes;return o.createElement("div",{className:e.root},o.createElement(Qe,null))}}]),t}(o.Component),et=Object(P.a)(function(e){return Object(Y.a)({root:{width:"100%",minHeight:"100%",display:"block",background:e.palette.background.default,padding:e.spacing(4)}})})(Ze),tt=function(e){return{type:"SET_TITLE",title:e}},nt=Object(d.b)(function(e){return{title:e.home.title}},function(e){return Object(b.b)(Object(v.a)({},r),e)})(et),at=n(120),rt=n.n(at),it=n(264),ot=n(259),ct=function(e){function t(){return Object(m.a)(this,t),Object(T.a)(this,Object(L.a)(t).apply(this,arguments))}return Object(U.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return o.createElement(o.Fragment,null,o.createElement(rt.a,{htmlAttributes:{leng:"en"},titleTemplate:"Truss - %s",defaultTitle:h.title,link:[{rel:"shortcut icon",href:h.bridgeIcon_2},{rel:"image_src",href:h.airBridge},{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500"},{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}],meta:[{charSet:"utf-8"},{name:"viewport",content:"minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no"},{name:"theme-color",content:"#000000"},{name:"description",content:h.description},{property:"og:type",content:"website"},{property:"og:title",content:h.title},{property:"og:image",content:h.airBridge},{property:"vk:image",content:h.airBridge},{property:"twitter:image",content:h.airBridge},{property:"og:url",content:h.url}]}),o.createElement(it.a,null),o.createElement(ot.a,{theme:be},o.createElement(F.c,null,o.createElement(F.a,{path:Je,component:nt,exact:!0}),o.createElement(F.a,{path:$e,component:Ve}))))}}]),t}(o.Component);n(211);l.a.render(c.a.createElement(d.a,{store:_},c.a.createElement(function(){return c.a.createElement(z.a,null,c.a.createElement(ct,null))},null)),document.getElementById("root"))},37:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"url",function(){return m}),n.d(t,"title",function(){return f}),n.d(t,"description",function(){return h}),n.d(t,"favicon",function(){return p}),n.d(t,"UI_cellSize",function(){return b}),n.d(t,"UI_nodeSize",function(){return g}),n.d(t,"UI_beamSize",function(){return v});var a=n(92),r=n.n(a);n.d(t,"ogImage",function(){return r.a});var i=n(93),o=n.n(i);n.d(t,"bridgeIcon_1",function(){return o.a});var c=n(94),s=n.n(c);n.d(t,"bridgeIcon_2",function(){return s.a});var l=n(95),d=n.n(l);n.d(t,"airBridge",function(){return d.a});var u=n(112),m=".",f="Truss - \u0444\u0435\u0440\u043c\u0430 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e",h="\u0424\u0435\u0440\u043c\u0430 (farm \u0438\u043b\u0438 truss) \u2014 \u0441\u0442\u0435\u0440\u0436\u043d\u0435\u0432\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0432 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0435, \u043e\u0441\u0442\u0430\u044e\u0449\u0430\u044f\u0441\u044f \u0433\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435\u0438\u0437\u043c\u0435\u043d\u044f\u0435\u043c\u043e\u0439 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043c\u0435\u043d\u044b \u0435\u0451 \u0436\u0451\u0441\u0442\u043a\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 \u0448\u0430\u0440\u043d\u0438\u0440\u043d\u044b\u043c\u0438.",p=n.n(u).a.resolve(e,"favicon.ico"),b=40,g=15,v=6}.call(this,"/")},92:function(e,t,n){e.exports=n.p+"static/media/ogImage.0619e300.png"},93:function(e,t,n){e.exports=n.p+"static/media/icon.68e274b2.png"},94:function(e,t,n){e.exports=n.p+"static/media/bridge.e53bced3.png"},95:function(e,t,n){e.exports=n.p+"static/media/airBridge.7d581a65.png"}},[[128,1,2]]]);
//# sourceMappingURL=main.695e5032.chunk.js.map