(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,n){e.exports=n(205)},204:function(e,t,n){},205:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"update",function(){return Ye});var o={};n.r(o),n.d(o,"setTitle",function(){return Je});var r,i=n(0),c=n.n(i),s=n(16),l=n.n(s),d=n(56),u=n(31),m=(Object(u.a)(),n(14)),h=n(15),f=n(35),v=function(){function e(){Object(m.a)(this,e)}return Object(h.a)(e,null,[{key:"angleBePoints",value:function(e,t,n,a){return Math.atan2(-t+a,-e+n)/Math.PI}},{key:"lengthBePoints",value:function(e,t,n,a){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-a,2))}},{key:"cellX",value:function(e){return Math.round(e/f.UI_cellSize)*f.UI_cellSize}},{key:"cellY",value:function(e){return Math.round(e/f.UI_cellSize)*f.UI_cellSize}}]),e}(),g=n(41),b=n(25),p=n(23),y=n(24),E=function e(t){Object(m.a)(this,e),this.id=void 0,this.x=void 0,this.y=void 0,this.angle=void 0,this.name=void 0,this.newX=void 0,this.newY=void 0,this.id=Date.now()+Math.random(),this.x=t.x||0,this.y=t.y||0,this.angle=t.angle||0,this.name=t.name||this.id+"",this.newX=this.x,this.newY=this.y},k=function(e){function t(e){var n;Object(m.a)(this,t),(n=Object(b.a)(this,Object(p.a)(t).call(this,e))).value=void 0,n.angle=void 0,n.nodeID=void 0;var a=e.value,o=void 0===a?0:a,r=e.angle,i=void 0===r?0:r,c=e.nodeID,s=void 0===c?0:c;return n.value=o,n.angle=i,n.nodeID=s,n}return Object(y.a)(t,e),t}(E),w=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(b.a)(this,Object(p.a)(t).call(this,e))).beamsID=void 0,n.forceX=void 0,n.forceY=void 0,n.isStatic=void 0,n.beamsID=e.beamsID||[],n.forceX=e.forceX,n.forceY=e.forceY,n.isStatic=e.isStatic||!1,n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"connectBeam",value:function(e){return!this.beamsID.find(function(t){return t===e})&&(this.beamsID.push(e),!0)}},{key:"removeBeam",value:function(e){this.beamsID=this.beamsID.filter(function(t){return t!==e})}}]),t}(E),S=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(b.a)(this,Object(p.a)(t).call(this,e))).endX=void 0,n.endY=void 0,n.length=void 0,n.startConnectedNodeID=void 0,n.endConnectedNodeID=void 0,n.newAngle=void 0,n.length=e.length||0,n.startConnectedNodeID=e.startConnectedNodeID||0,n.endConnectedNodeID=e.endConnectedNodeID||0,n.newAngle=n.angle,n.endX=e.endX||e.x||0,n.endY=e.endY||e.y||0,n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"connectNode",value:function(e,t){switch(t){case"start":this.startConnectedNodeID=e;break;case"end":this.endConnectedNodeID=e}}},{key:"removeNode",value:function(e){"start"===e?this.startConnectedNodeID=0:this.endConnectedNodeID=0}},{key:"getEndX",value:function(){return this.endX}},{key:"getEndY",value:function(){return this.endY}},{key:"moveStartPoint",value:function(e,t){this.x=e,this.y=t}},{key:"moveEndPoint",value:function(e,t){this.endX=e,this.endY=t}}]),t}(E),O=function(){function e(t){Object(m.a)(this,e),this.fixedNodes=void 0,this.forces=void 0,this.nodes=void 0,this.beams=void 0,this.time=void 0,this.nodes=t?t.nodes:new Map,this.fixedNodes=t?t.fixedNodes:new Map,this.forces=t?t.forces:new Map,this.beams=t?t.beams:new Map,this.time=Date.now()}return Object(h.a)(e,[{key:"addNode",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.getNodes().find(function(n){return n.x===e&&n.y===t}))return!1;var r=new w({x:e,y:t,angle:n,name:a,isStatic:o});return this.nodes.set(r.id,r),r}},{key:"addBeam",value:function(e,t){var n=new S({x:e,y:t});return this.beams.set(n.id,n),n}},{key:"deleteNode",value:function(e){this.nodes.delete(e)}},{key:"deleteBeam",value:function(e){this.beams.delete(e)}},{key:"deleteForce",value:function(e){this.forces.delete(e)}},{key:"getNode",value:function(e){var t=this.nodes.get(e);if(!t)throw Error("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0443\u0437\u0435\u043b \u0441 ID ".concat(e));return t}},{key:"getBeam",value:function(e){var t=this.beams.get(e);if(!t)throw Error("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u043b\u0443\u0447 \u0441 ID ".concat(e));return t}},{key:"getForce",value:function(e){var t=this.forces.get(e);if(!t)throw Error("\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430 \u0441\u0438\u043b\u0430 \u0441 ID ".concat(e));return t}},{key:"getNodes",value:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var o,r=this.nodes.values()[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value;e.push(i)}}catch(c){n=!0,a=c}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}return e}},{key:"getBeams",value:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var o,r=this.beams.values()[Symbol.iterator]();!(t=(o=r.next()).done);t=!0){var i=o.value;e.push(i)}}catch(c){n=!0,a=c}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}return e}},{key:"getForcesOnNode",value:function(e){var t=this.getNode(e);return[t.forceX,t.forceY]}},{key:"getBeamsOnNode",value:function(e){var t=this;return this.getNode(e).beamsID.map(function(e){return t.getBeam(e)})}},{key:"getNodesOnBeam",value:function(e){var t=this.getBeam(e),n=t.startConnectedNodeID,a=t.endConnectedNodeID;return[this.getNode(n),this.getNode(a)]}},{key:"connectBeamToNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start",a=e instanceof S?e:this.getBeam(e),o=t instanceof w?t:this.getNode(t);switch(n){case"start":a.connectNode(o.id,"start"),o.connectBeam(a.id);break;case"end":if(this.getBeamsOnNode(a.startConnectedNodeID).find(function(e){return e.startConnectedNodeID===a.startConnectedNodeID&&e.endConnectedNodeID===o.id||e.startConnectedNodeID===o.id&&e.endConnectedNodeID===a.startConnectedNodeID||e.id===a.id&&e.endConnectedNodeID===a.id})||!o.connectBeam(a.id))return!1;a.moveEndPoint(o.x,o.y),a.connectNode(o.id,"end");break;default:return!1}return!0}},{key:"connectForceToNode",value:function(e,t,n){var a=new k({angle:t,value:n,nodeID:e.id});0===t?e.forceX=a:e.forceY=a,this.forces.set(a.id,a)}},{key:"deleteEntity",value:function(e){var t=this;if(e instanceof w){if(e.isStatic)return;e.beamsID.map(function(e){return t.getBeam(e)}).forEach(function(n){n.startConnectedNodeID===e.id?t.getNode(n.endConnectedNodeID).removeBeam(n.id):t.getNode(n.startConnectedNodeID).removeBeam(n.id),t.deleteBeam(n.id)}),e.forceX&&this.deleteForce(e.forceX.id),e.forceY&&this.deleteForce(e.forceY.id),this.deleteNode(e.id)}else if(e instanceof S)[e.startConnectedNodeID,e.endConnectedNodeID].forEach(function(n){n>0&&t.getNode(n).removeBeam(e.id)}),this.deleteBeam(e.id);else if(e instanceof E){var n=this.nodes.get(e.id)||this.beams.get(e.id);n&&this.deleteEntity(n)}else{var a=this.nodes.get(e)||this.beams.get(e);a&&this.deleteEntity(a)}}},{key:"moveNodeTo",value:function(e,t,n){var a=this,o=this.getNode(e);o.isStatic||(this.getNodes().find(function(e){return e.x===t&&e.y===n})||(o.x=t,o.y=n,o.beamsID.forEach(function(o){var r=a.getBeam(o);r.startConnectedNodeID===e?r.moveStartPoint(t,n):r.endConnectedNodeID===e&&r.moveEndPoint(t,n)})))}}]),e}(),N={workSpace:new O},j=n(54),I={title:"Hello, world!"},C=Object(g.b)({farm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FARM_UPDATE":return{workSpace:new O(t.workSpace)};default:return e}},home:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TITLE":return Object(j.a)({},e,{title:t.title});default:return e}}}),B=Object(g.c)(C),D=n(50),x=n(47),M=n(21),T=n(109),_=n(258),z=n(254),F=n(5),X=n(37),L=n(206),P=n(257),U=n(234),Y=n(235),W=n(236),H=n(237),A=n(13),R=n(255),G=n(77),K=n(228),V=n(256),J=n(229),$=n(230),q=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(b.a)(this,Object(p.a)(t).call(this,e))).state={open:!1,viewTooltip:!1},n.switchDrawer=n.switchDrawer.bind(Object(M.a)(n)),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"switchDrawer",value:function(){this.setState({open:!this.state.open,viewTooltip:!1})}},{key:"changeViewtooltip",value:function(e){this.setState({viewTooltip:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=t.children,o=t.title,r=t.btnIcon,c=t.anchor,s=this.state,l=s.open,d=s.viewTooltip;return i.createElement(i.Fragment,null,i.createElement(R.a,{className:n.drawer,variant:"persistent",open:l,anchor:c,classes:{paper:n.drawerPaper}},i.createElement("div",{className:n.toolbar}),i.createElement(G.a,{variant:"body2",align:"center",className:n.title},o),i.createElement(K.a,null),a),i.createElement(V.a,{title:o,open:void 0!==o&&d&&!l,onOpen:function(){return e.changeViewtooltip(!0)},onClose:function(){return e.changeViewtooltip(!1)}},i.createElement(J.a,{style:{left:"left"===c?l?255:15:"auto",right:"right"===c?l?255:15:"auto"},color:"secondary",size:"medium",className:n.toogleIcon,onClick:this.switchDrawer},l?i.createElement($.a,null):r)))}}]),t}(i.PureComponent),Q=Object(F.a)(function(e){return Object(_.a)({drawer:{position:"relative"},drawerPaper:{width:240},toogleIcon:{position:"absolute",top:e.spacing(10),zIndex:e.zIndex.drawer+1},title:{padding:e.spacing(1)},toolbar:e.mixins.toolbar})})(q),Z=n(4),ee=n(231),te=n(232),ne=Object(F.a)(function(e){return Object(_.a)({appBar:{zIndex:e.zIndex.drawer+1},logo:{marginRight:e.spacing(4),marginLeft:e.spacing(2),"& img":{width:50,height:"auto"}}})})(function(e){var t=e.classes,n=e.children,a=e.className,o=e.color,r=e.position,c=e.withLogo,s=void 0===c||c;return i.createElement(ee.a,{position:r||"fixed",className:Object(Z.a)(t.appBar,a),color:o||"primary"},i.createElement(te.a,null,function(){if(s)return i.createElement(D.b,{to:"/",className:t.logo},i.createElement("img",{alt:"Logo Icon",src:f.bridgeIcon_2}))}(),n))}),ae=n(69),oe=n(112),re=n(233),ie=Object(F.a)(function(e){return Object(_.a)({btn:{marginLeft:e.spacing(2),marginRight:e.spacing(2),borderRadius:"50% !important",border:"1px solid ".concat(Object(A.b)(e.palette.action.active,.2)," !important"),transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.light,"&$selected":{backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark}},"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main},"&$disabled":{backgroundColor:e.palette.secondary.main}}},selected:{}})})(function(e){var t=e.selected,n=e.classes,a=e.value,o=e.name,r=e.icon,c=Object(oe.a)(e,["selected","classes","value","name","icon"]);return i.createElement(re.a,Object.assign({key:o,value:a,className:Object(Z.a)(n.btn,Object(ae.a)({},n.selected,t))},c),i.createElement(V.a,{title:o},r))});!function(e){e[e.none=0]="none",e[e.move=1]="move",e[e.addNode=2]="addNode",e[e.addBeam=3]="addBeam",e[e.addBeamStart=4]="addBeamStart",e[e.delete=5]="delete"}(r||(r={}));var ce=Object(F.a)(function(e){return Object(_.a)({root:{position:"absolute",padding:e.spacing(1),bottom:e.spacing(2),left:"50%",transform:"translateX(-50%)",backgroundColor:Object(A.b)(e.palette.primary.light,.4),transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:e.palette.primary.light}},modsBtnGroup:{borderRadius:0,backgroundColor:"transparent"}})})(function(e){var t=e.onSelect,n=e.selected,a=e.classes,o=[{name:"\u041f\u0435\u0440\u0435\u043c\u0435\u0449\u0435\u043d\u0438\u0435",mod:r.move,icon:i.createElement(U.a,null)},{name:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0437\u0435\u043b",mod:r.addNode,icon:i.createElement(Y.a,null)},{name:"\u0421\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0443\u0437\u043b\u044b",mod:r.addBeam,icon:i.createElement(W.a,null)},{name:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",mod:r.delete,icon:i.createElement(H.a,null)}];return i.createElement(L.a,{className:a.root},i.createElement(P.a,{value:n,exclusive:!0,onChange:function(e,n){return t(n)},size:"medium",className:a.modsBtnGroup},o.map(function(e){return i.createElement(ie,{key:e.mod,value:e.mod,selected:e.mod===n,icon:e.icon,name:e.name})})))}),se=n(116),le=Object(se.a)({palette:{primary:{dark:"#0A4467",main:"#1e779e",light:"#51A8D6"},secondary:{dark:"#a83e19",main:"#f15a24",light:"#F39B7C"},background:{default:"linear-gradient(35deg, #6863bf 0%, #067d93 50%, #e68a68 100%)"}}}),de=function(e){var t=e.node,n=e.drag,a=e.mode,o=e.onClick,c=e.selected,s=f.UI_nodeSize,l=function(e){return i.createElement(i.Fragment,null,i.createElement(X.Arrow,{points:[0,0,f.UI_cellSize,0],stroke:le.palette.grey[300],strokeWidth:s/3,shadowBlur:2,pointerLength:f.UI_cellSize/10,pointerWidth:f.UI_cellSize/10,hitStrokeWidth:2*s,rotation:e.value>0?e.angle:180+e.angle}),i.createElement(X.Text,{x:0===e.angle?e.value>0?f.UI_cellSize/3:-f.UI_cellSize:f.UI_cellSize/3,y:90===e.angle?e.value>0?f.UI_cellSize/3:-f.UI_cellSize/2:-f.UI_cellSize/1.5,text:e.value+"H"}))};return i.createElement(i.Fragment,null,i.createElement(X.Group,{x:t.x,y:t.y},t.forceX&&l(t.forceX),t.forceY&&l(t.forceY),i.createElement(X.Circle,{className:"MyCircle",radius:s,x:0,y:0,fill:t.isStatic?le.palette.secondary.dark:le.palette.secondary.main,shadowBlur:c?8:2,stroke:function(){switch(a){case r.move:if(t.isStatic)return le.palette.secondary.dark;case r.addBeam:case r.addBeamStart:return le.palette.primary.light;default:return le.palette.secondary.main}}(),strokeWidth:function(){switch(a){case r.move:if(t.isStatic)return 0;case r.addBeam:case r.addBeamStart:return 2;default:return 0}}(),hitStrokeWidth:2*s,draggable:a===r.move&&!t.isStatic,_useStrictMode:!0,onDragMove:function(e){return n(e,t)},onClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return o(e,t)}),onMouseEnter:function(e){return function(e,n){var a=e.target.getStage();switch(n){case r.delete:if(t.isStatic){a.container().style.cursor="default";break}case r.none:a.container().style.cursor="pointer";break;case r.addBeam:case r.addBeamStart:a.container().style.cursor="crosshair";break;case r.move:if(t.isStatic){a.container().style.cursor="default";break}a.container().style.cursor="move"}}(e,a)},onMouseLeave:function(e){return function(e){var t=e.target.getStage();t&&(t.container().style.cursor="default")}(e)}})))},ue=function(e){var t=e.beam,n=e.mode,a=e.onClick,o=e.selected,c=f.UI_beamSize;return i.createElement(i.Fragment,null,i.createElement(X.Line,{points:[t.x,t.y,t.endX,t.endY],stroke:le.palette.secondary.light,strokeWidth:c,shadowBlur:o?8:2,hitStrokeWidth:4*c,onClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return a(e,t)}),onMouseEnter:function(e){return function(e,t){var n=e.target.getStage();switch(t){case r.delete:case r.none:n.container().style.cursor="pointer"}}(e,n)},onMouseLeave:function(e){return function(e){var t=e.target.getStage();t&&(t.container().style.cursor="default")}(e)}}))},me=n(88),he=function(e){var t=e.widthCell,n=e.heightCell,a=e.heightBox,o=e.widthBox,r=o/t,c=a/n;return i.createElement(i.Fragment,null,function(){for(var e=[],n=0;n<r;n++)e.push(i.createElement(me.Line,{points:[n*t,0,n*t,a],stroke:"#ddd",strokeWidth:1,key:n}));return e}(),function(){for(var e=[],t=0;t<c;t++)e.push(i.createElement(me.Line,{points:[0,t*n,o,t*n],stroke:"#ddd",strokeWidth:1,key:t}));return e}())},fe=n(113),ve=n.n(fe),ge=Object(F.a)(function(e){return Object(_.a)({root:{flexGrow:1,backgroundColor:"#fff"},stage:{backgroundColor:"#fff"}})})(function(e){var t=e.classes,n=e.stage,a=e.stageHeight,o=e.stageWidth,r=e.onClick,c=e.onMouseMove,s=e.onDrag,l=e.farm,d=e.uiMode,u=e.selectedEntity;return i.createElement(ve.a,{className:t.root,autoHide:!0},i.createElement(X.Stage,{height:a,width:o,className:t.stage,onClick:r,onMouseMove:c,ref:n},i.createElement(X.Layer,{className:"layer"},i.createElement(he,{heightCell:f.UI_cellSize,widthCell:f.UI_cellSize,heightBox:a,widthBox:o}),l.getBeams().map(function(e){return i.createElement(ue,{key:e.id,beam:e,mode:d,onClick:r,selected:u===e})}),l.getNodes().map(function(e){return i.createElement(de,{key:e.id,node:e,mode:d,drag:s,onClick:r,selected:u===e})}))))}),be=n(238),pe=Object(F.a)(function(e){return Object(_.a)({root:{},btn:{marginLeft:e.spacing(2),marginRight:e.spacing(2)},grow:{flexGrow:1}})})(function(e){var t=e.classes,n=e.hundleSave,a=void 0===n?function(e){alert("\u0411\u0443\u0435\u0434\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c")}:n,o=e.hundleClear,r=void 0===o?function(e){alert("\u0411\u0443\u0435\u0434\u0435\u0442 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c")}:o;return i.createElement(ne,{className:t.root},i.createElement("div",{className:t.grow}),i.createElement(be.a,{color:"secondary",variant:"contained",className:t.btn,onClick:a},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),i.createElement(be.a,{color:"secondary",variant:"contained",className:t.btn,onClick:r},"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"))}),ye=n(239),Ee=n(240),ke=n(241),we=n(242),Se=n(245),Oe=n(246),Ne=n(243),je=n(244),Ie=n(247),Ce=n(248),Be=n(249),De=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(b.a)(this,Object(p.a)(t).call(this,e))).state={open:!1,tabs:new Map},n.openTab=n.openTab.bind(Object(M.a)(n)),n.viewListItem=n.viewListItem.bind(Object(M.a)(n)),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){var e=this.state.tabs;e.set("\u0423\u0437\u043b\u044b",!1),e.set("\u0421\u0442\u0435\u0440\u0436\u043d\u0438",!1),this.setState({tabs:new Map(e)})}},{key:"openTab",value:function(e){var t=this.state.tabs;t.set(e,!t.get(e)),this.setState({tabs:new Map(t)})}},{key:"viewListItem",value:function(e,t,n){var a=this,o=this.props,r=o.selectedEntity,c=o.classes,s=o.onSelect,l=this.state.tabs;return i.createElement(i.Fragment,null,i.createElement(ye.a,{button:!0,onClick:function(){return a.openTab(t)}},n&&i.createElement(Ee.a,null,i.createElement(ke.a,{badgeContent:e.length,color:"secondary"},n)),i.createElement(we.a,{primary:t}),l.get(t)?i.createElement(Ne.a,null):i.createElement(je.a,null)),i.createElement(Se.a,{in:l.get(t),timeout:"auto",unmountOnExit:!0},i.createElement(Oe.a,{component:"div",disablePadding:!0},e.map(function(e){return i.createElement(ye.a,{button:!0,className:c.nested,key:e.id,selected:r===e,onClick:function(t){return s(e)}},i.createElement(we.a,{primary:e.id}))}))),i.createElement(K.a,null))}},{key:"render",value:function(){var e=this.props,t=e.nodes,n=e.beams;return i.createElement(Q,{anchor:"left",title:"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0430",btnIcon:i.createElement(Ie.a,null)},this.viewListItem(t,"\u0423\u0437\u043b\u044b",i.createElement(Ce.a,null)),this.viewListItem(n,"\u0421\u0442\u0435\u0440\u0436\u043d\u0438",i.createElement(Be.a,null)))}}]),t}(i.PureComponent),xe=Object(F.a)(function(e){return Object(_.a)({nested:{paddingLeft:e.spacing(6)}})})(De),Me=n(250),Te=n(251),_e=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(b.a)(this,Object(p.a)(t).call(this,e))).state={},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"getTypeStr",value:function(e){return e instanceof w?"\u0423\u0437\u0435\u043b":e instanceof S?"\u0421\u0442\u0435\u0440\u0436\u0435\u043d\u044c":"\u042d\u043b\u0435\u043c\u0435\u043d\u0442"}},{key:"viewInfo",value:function(e){var t=this.props,n=t.classes,a=t.onDelete;if(e)return i.createElement(z.a,{className:n.root},i.createElement(G.a,{className:n.subTitle,color:"textSecondary",gutterBottom:!0},this.getTypeStr(e)),i.createElement(G.a,{variant:"h5",className:n.title},e.name),i.createElement(Me.a,{"aria-label":"Delete",onClick:function(){return a(e)}},i.createElement(H.a,null)))}},{key:"render",value:function(){var e=this.props.entity;return i.createElement(Q,{anchor:"right",title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u0435",btnIcon:i.createElement(Te.a,null)},this.viewInfo(e),i.createElement(K.a,null))}}]),t}(i.PureComponent),ze=Object(F.a)(function(e){return Object(_.a)({root:{padding:e.spacing(2)},subTitle:{fontSize:14},title:{marginBottom:e.spacing(2)}})})(_e),Fe=function(){var e=new O,t=e.addNode(1e3,600,0,"",!0);return t&&(e.connectForceToNode(t,0,100),e.connectForceToNode(t,90,100)),(t=e.addNode(1200,760,0,"",!0))&&(e.connectForceToNode(t,0,-100),e.connectForceToNode(t,90,-100)),e},Xe=n(114),Le=n.n(Xe),Pe=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(b.a)(this,Object(p.a)(t).call(this,e))).stage=void 0,n.state={stageHeight:100,stageWidth:100,farm:Fe.call(Object(M.a)(n)),uiMode:r.none,selectedEntity:void 0,paintEntity:void 0},n.onClick=n.onClick.bind(Object(M.a)(n)),n.onDrag=n.onDrag.bind(Object(M.a)(n)),n.onMouseMove=n.onMouseMove.bind(Object(M.a)(n)),n.updateFarm=n.updateFarm.bind(Object(M.a)(n)),n.onKeyHandle=n.onKeyHandle.bind(Object(M.a)(n)),n._setStageSize=n._setStageSize.bind(Object(M.a)(n)),n.deleteEntity=n.deleteEntity.bind(Object(M.a)(n)),n.selectEntity=n.selectEntity.bind(Object(M.a)(n)),n.clearFarm=n.clearFarm.bind(Object(M.a)(n)),n.stage=i.createRef(),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){this._setStageSize()}},{key:"componentDidMount",value:function(){window.addEventListener("resize",this._setStageSize);var e=this.stage.current;if(e){var t=e.attrs.container.parentElement;t&&(t.scrollTop=(t.scrollHeight-t.offsetHeight)/2,t.scrollLeft=(t.scrollWidth-t.offsetWidth)/2)}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._setStageSize)}},{key:"componentWillReceiveProps",value:function(e){e.workSpace!==this.state.farm&&this.setState({farm:e.workSpace})}},{key:"updateFarm",value:function(e){this.setState({farm:e})}},{key:"onClick",value:function(e,t){var n=this.state,a=n.uiMode,o=n.farm,i=e.target.getStage()===e.target;if(e.evt.preventDefault(),0===e.evt.button)switch(a){case r.none:i?this.setState({selectedEntity:void 0}):this.selectEntity(t);break;case r.addNode:if(i){var c=e.evt,s=c.layerX,l=c.layerY;o.addNode(v.cellX(s),v.cellX(l),0),this.updateFarm(o)}break;case r.addBeam:if(!i&&t instanceof w){var d=o.addBeam(t.x,t.y);o.connectBeamToNode(d,t),this.setState({paintEntity:d,uiMode:r.addBeamStart}),this.updateFarm(o)}break;case r.addBeamStart:if(!i&&t instanceof w&&this.state.paintEntity instanceof S){var u=this.state.paintEntity;o.connectBeamToNode(u,t,"end")&&this.setState({uiMode:r.addBeam,paintEntity:void 0}),this.updateFarm(o)}break;case r.delete:!i&&t&&this.deleteEntity(t)}}},{key:"onMouseMove",value:function(e){var t=this.state,n=t.uiMode,a=t.farm,o=t.paintEntity,i=e.evt,c=i.layerX,s=i.layerY;switch(n){case r.addBeamStart:if(e.target.getStage()){if(o&&o instanceof S)o.moveEndPoint(c,s);else this.setState({uiMode:r.addBeam});this.updateFarm(a)}break;case r.delete:var l=e.target.getStage();l===e.target&&(l.container().style.cursor="default")}}},{key:"onDrag",value:function(e,t){var n=this.state,a=n.farm;switch(n.uiMode){case r.move:if(t instanceof w&&e.evt.defaultPrevented){var o=e.evt,i=o.layerX,c=o.layerY;a.moveNodeTo(t.id,v.cellX(i),v.cellY(c)),this.updateFarm(a)}}}},{key:"onKeyHandle",value:function(e){switch(e.key){case"Escape":this.deletePaintEntity()}}},{key:"setSelectedMode",value:function(e){this.deletePaintEntity(),this.setState({uiMode:e||0})}},{key:"deletePaintEntity",value:function(){var e=this.state,t=e.uiMode,n=e.paintEntity,a=e.farm;t===r.addBeamStart&&n&&(a.deleteEntity(n),this.setState({paintEntity:void 0}),this.updateFarm(a))}},{key:"_setStageSize",value:function(e){this.setState({stageHeight:1.5*window.innerHeight,stageWidth:1.5*window.innerWidth})}},{key:"selectEntity",value:function(e){e&&this.setState({selectedEntity:e})}},{key:"deleteEntity",value:function(e){this.setState({selectedEntity:void 0}),this.state.farm.deleteEntity(e),this.updateFarm(this.state.farm)}},{key:"clearFarm",value:function(){window.confirm("\u0412\u044b\u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0445\u043e\u043b\u0441\u0442?")&&this.setState({farm:Fe()})}},{key:"render",value:function(){var e=this.state,t=e.stageHeight,n=e.stageWidth,a=e.farm,o=e.uiMode,r=e.selectedEntity,c=this.props.classes;return i.createElement(z.a,{className:c.root},i.createElement(Le.a.FPSStats,{isActive:!0}),i.createElement(T.a,{keyEventName:"keyup",keyValue:"Escape",onKeyHandle:this.onKeyHandle}),i.createElement(pe,{hundleClear:this.clearFarm}),i.createElement("div",{className:c.toolbar}),i.createElement(z.a,{className:c.stageBox},i.createElement("div",{className:c.toolbar}),i.createElement(xe,{nodes:a.getNodes(),beams:a.getBeams(),selectedEntity:r,onSelect:this.selectEntity}),i.createElement(ge,{onClick:this.onClick,onDrag:this.onDrag,onMouseMove:this.onMouseMove,stageHeight:t,stageWidth:n,farm:a,stage:this.stage,selectedEntity:r,uiMode:o}),i.createElement(ze,{entity:r,onDelete:this.deleteEntity})),i.createElement(ce,{selected:o,onSelect:this.setSelectedMode.bind(this)}))}}]),t}(i.Component),Ue=Object(F.a)(function(e){return Object(_.a)({root:{width:"100%",height:"100%",overflow:"hidden",background:e.palette.background.default,display:"flex",flexDirection:"column"},stageBox:{display:"flex",flexGrow:1,overflow:"hidden"},toolbar:e.mixins.toolbar})})(Pe),Ye=function(e){return{type:"FARM_UPDATE",workSpace:e}},We=Object(d.b)(function(e){return{workSpace:e.farm.workSpace}},function(e){return Object(g.a)(Object(j.a)({},a),e)})(Ue),He="/",Ae="/farm",Re=n(207),Ge=Object(Re.a)(function(e){return Object(_.a)({root:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},logo:{width:"20%",height:"20%"},title:{padding:40},descripton:{padding:40},btn:{}})})(function(e){var t=e.classes;return i.createElement("header",{className:t.root},i.createElement("img",{src:f.bridgeIcon_2,alt:"logo",className:t.logo}),i.createElement(G.a,{variant:"h3",className:t.title},f.title),i.createElement(G.a,{variant:"subtitle1",align:"center",className:t.descripton},f.description),i.createElement(be.a,{component:D.b,to:Ae,variant:"contained",size:"large",color:"secondary"},"\u041f\u043e\u0435\u0445\u0430\u043b\u0438"))}),Ke=function(e){function t(){return Object(m.a)(this,t),Object(b.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props.classes;return i.createElement("div",{className:e.root},i.createElement(Ge,null))}}]),t}(i.Component),Ve=Object(F.a)(function(e){return Object(_.a)({root:{width:"100%",minHeight:"100%",display:"block",background:e.palette.background.default,padding:e.spacing(4)}})})(Ke),Je=function(e){return{type:"SET_TITLE",title:e}},$e=Object(d.b)(function(e){return{title:e.home.title}},function(e){return Object(g.a)(Object(j.a)({},o),e)})(Ve),qe=n(115),Qe=n.n(qe),Ze=n(259),et=n(252),tt=function(e){function t(){return Object(m.a)(this,t),Object(b.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return i.createElement(i.Fragment,null,i.createElement(Qe.a,{htmlAttributes:{leng:"en"},titleTemplate:"Truss - %s",defaultTitle:f.title,link:[{rel:"shortcut icon",href:f.bridgeIcon_2},{rel:"image_src",href:f.airBridge},{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500"},{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}],meta:[{charSet:"utf-8"},{name:"viewport",content:"minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no"},{name:"theme-color",content:"#000000"},{name:"description",content:f.description},{property:"og:type",content:"website"},{property:"og:title",content:f.title},{property:"og:image",content:f.airBridge},{property:"vk:image",content:f.airBridge},{property:"twitter:image",content:f.airBridge},{property:"og:url",content:f.url}]}),i.createElement(Ze.a,null),i.createElement(et.a,{theme:le},i.createElement(x.c,null,i.createElement(x.a,{path:He,component:$e,exact:!0}),i.createElement(x.a,{path:Ae,component:We}))))}}]),t}(i.Component);n(204);l.a.render(c.a.createElement(d.a,{store:B},c.a.createElement(function(){return c.a.createElement(D.a,null,c.a.createElement(tt,null))},null)),document.getElementById("root"))},35:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"url",function(){return m}),n.d(t,"title",function(){return h}),n.d(t,"description",function(){return f}),n.d(t,"favicon",function(){return v}),n.d(t,"UI_cellSize",function(){return g}),n.d(t,"UI_nodeSize",function(){return b}),n.d(t,"UI_beamSize",function(){return p});var a=n(90),o=n.n(a);n.d(t,"ogImage",function(){return o.a});var r=n(91),i=n.n(r);n.d(t,"bridgeIcon_1",function(){return i.a});var c=n(92),s=n.n(c);n.d(t,"bridgeIcon_2",function(){return s.a});var l=n(93),d=n.n(l);n.d(t,"airBridge",function(){return d.a});var u=n(108),m="https://web-usov.github.io/truss",h="Truss - \u0444\u0435\u0440\u043c\u0430 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e",f="\u0424\u0435\u0440\u043c\u0430 (farm \u0438\u043b\u0438 truss) \u2014 \u0441\u0442\u0435\u0440\u0436\u043d\u0435\u0432\u0430\u044f \u0441\u0438\u0441\u0442\u0435\u043c\u0430 \u0432 \u0441\u0442\u0440\u043e\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0435, \u043e\u0441\u0442\u0430\u044e\u0449\u0430\u044f\u0441\u044f \u0433\u0435\u043e\u043c\u0435\u0442\u0440\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435\u0438\u0437\u043c\u0435\u043d\u044f\u0435\u043c\u043e\u0439 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043c\u0435\u043d\u044b \u0435\u0451 \u0436\u0451\u0441\u0442\u043a\u0438\u0445 \u0443\u0437\u043b\u043e\u0432 \u0448\u0430\u0440\u043d\u0438\u0440\u043d\u044b\u043c\u0438.",v=n.n(u).a.resolve(e,"favicon.ico"),g=40,b=15,p=6}.call(this,"/")},90:function(e,t,n){e.exports=n.p+"static/media/ogImage.0619e300.png"},91:function(e,t,n){e.exports=n.p+"static/media/icon.68e274b2.png"},92:function(e,t,n){e.exports=n.p+"static/media/bridge.e53bced3.png"},93:function(e,t,n){e.exports=n.p+"static/media/airBridge.7d581a65.png"}},[[123,1,2]]]);
//# sourceMappingURL=main.a1afb16c.chunk.js.map